/*
 Platform.js
 Copyright 2014-2020 Benjamin Tan
 Copyright 2011-2013 John-David Dalton
 Available under MIT license
*/
(function(){var a="undefined"!==typeof window&&"undefined"!==typeof window.document?window.document:{},c="undefined"!==typeof module&&module.exports,b=function(){for(var m,h=["requestFullscreen exitFullscreen fullscreenElement fullscreenEnabled fullscreenchange fullscreenerror".split(" "),"webkitRequestFullscreen webkitExitFullscreen webkitFullscreenElement webkitFullscreenEnabled webkitfullscreenchange webkitfullscreenerror".split(" "),"webkitRequestFullScreen webkitCancelFullScreen webkitCurrentFullScreenElement webkitCancelFullScreen webkitfullscreenchange webkitfullscreenerror".split(" "),
"mozRequestFullScreen mozCancelFullScreen mozFullScreenElement mozFullScreenEnabled mozfullscreenchange mozfullscreenerror".split(" "),"msRequestFullscreen msExitFullscreen msFullscreenElement msFullscreenEnabled MSFullscreenChange MSFullscreenError".split(" ")],l=0,g=h.length,p={};l<g;l++)if((m=h[l])&&m[1]in a){for(l=0;l<m.length;l++)p[h[0][l]]=m[l];return p}return!1}(),e={change:b.fullscreenchange,error:b.fullscreenerror},d={request:function(m){return new Promise(function(h,l){var g=function(){this.off("change",
g);h()}.bind(this);this.on("change",g);m=m||a.documentElement;Promise.resolve(m[b.requestFullscreen]())["catch"](l)}.bind(this))},exit:function(){return new Promise(function(m,h){if(this.isFullscreen){var l=function(){this.off("change",l);m()}.bind(this);this.on("change",l);Promise.resolve(a[b.exitFullscreen]())["catch"](h)}else m()}.bind(this))},toggle:function(m){return this.isFullscreen?this.exit():this.request(m)},onchange:function(m){this.on("change",m)},onerror:function(m){this.on("error",m)},
on:function(m,h){var l=e[m];l&&a.addEventListener(l,h,!1)},off:function(m,h){var l=e[m];l&&a.removeEventListener(l,h,!1)},raw:b};b?(Object.defineProperties(d,{isFullscreen:{get:function(){return!!a[b.fullscreenElement]}},element:{enumerable:!0,get:function(){return a[b.fullscreenElement]}},isEnabled:{enumerable:!0,get:function(){return!!a[b.fullscreenEnabled]}}}),c?module.exports=d:window.screenfull=d):c?module.exports={isEnabled:!1}:window.screenfull={isEnabled:!1}})();
(function(){function a(q){q=String(q);return q.charAt(0).toUpperCase()+q.slice(1)}function c(q,H){var J=-1,D=q?q.length:0;if("number"==typeof D&&-1<D&&D<=u)for(;++J<D;)H(q[J],J,q);else e(q,H)}function b(q){q=g(q);return/^(?:webOS|i(?:OS|P))/.test(q)?q:a(q)}function e(q,H){for(var J in q)E.call(q,J)&&H(q[J],J,q)}function d(q){return null==q?a(q):B.call(q).slice(8,-1)}function m(q,H){var J=null!=q?typeof q[H]:"number";return!/^(?:boolean|number|string|undefined)$/.test(J)&&("object"==J?!!q[H]:!0)}function h(q){return String(q).replace(/([ -])(?!$)/g,
"$1?")}function l(q,H){var J=null;c(q,function(D,F){J=H(J,D,F,q)});return J}function g(q){return String(q).replace(/^ +| +$/g,"")}function p(q){function H(S){return l(S,function(M,N){var aa=N.pattern||h(N);!M&&(M=RegExp("\\b"+aa+" *\\d+[.\\w_]*","i").exec(q)||RegExp("\\b"+aa+" *\\w+-[\\w]*","i").exec(q)||RegExp("\\b"+aa+"(?:; *(?:[a-z]+[_-])?[a-z]+\\d+|[^ ();-]*)","i").exec(q))&&((M=String(N.label&&!RegExp(aa,"i").test(N.label)?N.label:M).split("/"))[1]&&!/[\d.]+/.test(M[0])&&(M[0]+=" "+M[1]),N=N.label||
N,M=b(M[0].replace(RegExp(aa,"i"),N).replace(RegExp("; *(?:"+N+"[_-])?","i")," ").replace(RegExp("("+N+")[-_.]?(\\w)","i"),"$1 $2")));return M})}function J(S){return l(S,function(M,N){return M||(RegExp(N+"(?:-[\\d.]+/|(?: for [\\w-]+)?[ /-])([\\d.]+[^ ();/_-]*)","i").exec(q)||0)[1]||null})}var D=f,F=q&&"object"==typeof q&&"String"!=d(q);F&&(D=q,q=null);var w=D.navigator||{},A=w.userAgent||"";q||(q=A);var L=F?!!w.likeChrome:/\bChrome\b/.test(q)&&!/internal|\n/i.test(B.toString()),ba=F?"Object":"ScriptBridgingProxyObject",
Y=F?"Object":"Environment",U=F&&D.java?"JavaPackage":d(D.java),W=F?"Object":"RuntimeObject";Y=(U=/\bJava/.test(U)&&D.java)&&d(D.environment)==Y;var Q=U?"a":"\u03b1",R=U?"b":"\u03b2",V=D.document||{},P=D.operamini||D.opera,T=z.test(T=F&&P?P["[[Class]]"]:d(P))?T:P=null,k,G=q;F=[];var X=null,O=q==A;A=O&&P&&"function"==typeof P.version&&P.version();var I=function(S){return l(S,function(M,N){return M||RegExp("\\b"+(N.pattern||h(N))+"\\b","i").exec(q)&&(N.label||N)})}([{label:"EdgeHTML",pattern:"Edge"},
"Trident",{label:"WebKit",pattern:"AppleWebKit"},"iCab","Presto","NetFront","Tasman","KHTML","Gecko"]),t=function(S){return l(S,function(M,N){return M||RegExp("\\b"+(N.pattern||h(N))+"\\b","i").exec(q)&&(N.label||N)})}(["Adobe AIR","Arora","Avant Browser","Breach","Camino","Electron","Epiphany","Fennec","Flock","Galeon","GreenBrowser","iCab","Iceweasel","K-Meleon","Konqueror","Lunascape","Maxthon",{label:"Microsoft Edge",pattern:"(?:Edge|Edg|EdgA|EdgiOS)"},"Midori","Nook Browser","PaleMoon","PhantomJS",
"Raven","Rekonq","RockMelt",{label:"Samsung Internet",pattern:"SamsungBrowser"},"SeaMonkey",{label:"Silk",pattern:"(?:Cloud9|Silk-Accelerated)"},"Sleipnir","SlimBrowser",{label:"SRWare Iron",pattern:"Iron"},"Sunrise","Swiftfox","Vivaldi","Waterfox","WebPositive",{label:"Yandex Browser",pattern:"YaBrowser"},{label:"UC Browser",pattern:"UCBrowser"},"Opera Mini",{label:"Opera Mini",pattern:"OPiOS"},"Opera",{label:"Opera",pattern:"OPR"},"Chromium","Chrome",{label:"Chrome",pattern:"(?:HeadlessChrome)"},
{label:"Chrome Mobile",pattern:"(?:CriOS|CrMo)"},{label:"Firefox",pattern:"(?:Firefox|Minefield)"},{label:"Firefox for iOS",pattern:"FxiOS"},{label:"IE",pattern:"IEMobile"},{label:"IE",pattern:"MSIE"},"Safari"]),x=H([{label:"BlackBerry",pattern:"BB10"},"BlackBerry",{label:"Galaxy S",pattern:"GT-I9000"},{label:"Galaxy S2",pattern:"GT-I9100"},{label:"Galaxy S3",pattern:"GT-I9300"},{label:"Galaxy S4",pattern:"GT-I9500"},{label:"Galaxy S5",pattern:"SM-G900"},{label:"Galaxy S6",pattern:"SM-G920"},{label:"Galaxy S6 Edge",
pattern:"SM-G925"},{label:"Galaxy S7",pattern:"SM-G930"},{label:"Galaxy S7 Edge",pattern:"SM-G935"},"Google TV","Lumia","iPad","iPod","iPhone","Kindle",{label:"Kindle Fire",pattern:"(?:Cloud9|Silk-Accelerated)"},"Nexus","Nook","PlayBook","PlayStation Vita","PlayStation","TouchPad","Transformer",{label:"Wii U",pattern:"WiiU"},"Wii","Xbox One",{label:"Xbox 360",pattern:"Xbox"},"Xoom"]),C=function(S){return l(S,function(M,N,aa){return M||(N[x]||N[/^[a-z]+(?: +[a-z]+\b)*/i.exec(x)]||RegExp("\\b"+h(aa)+
"(?:\\b|\\w*\\d)","i").exec(q))&&aa})}({Apple:{iPad:1,iPhone:1,iPod:1},Alcatel:{},Archos:{},Amazon:{Kindle:1,"Kindle Fire":1},Asus:{Transformer:1},"Barnes & Noble":{Nook:1},BlackBerry:{PlayBook:1},Google:{"Google TV":1,Nexus:1},HP:{TouchPad:1},HTC:{},Huawei:{},Lenovo:{},LG:{},Microsoft:{Xbox:1,"Xbox One":1},Motorola:{Xoom:1},Nintendo:{"Wii U":1,Wii:1},Nokia:{Lumia:1},Oppo:{},Samsung:{"Galaxy S":1,"Galaxy S2":1,"Galaxy S3":1,"Galaxy S4":1},Sony:{PlayStation:1,"PlayStation Vita":1},Xiaomi:{Mi:1,Redmi:1}}),
y=function(S){return l(S,function(M,N){var aa=N.pattern||h(N);if(!M&&(M=RegExp("\\b"+aa+"(?:/[\\d.]+|[ \\w.]*)","i").exec(q))){var ca=M,da=N.label||N,ea={"10.0":"10","6.4":"10 Technical Preview","6.3":"8.1","6.2":"8","6.1":"Server 2008 R2 / 7","6.0":"Server 2008 / Vista","5.2":"Server 2003 / XP 64-bit","5.1":"XP","5.01":"2000 SP1","5.0":"2000","4.0":"NT","4.90":"ME"};aa&&da&&/^Win/i.test(ca)&&!/^Windows Phone /i.test(ca)&&(ea=ea[/[\d.]+$/.exec(ca)])&&(ca="Windows "+ea);ca=String(ca);aa&&da&&(ca=ca.replace(RegExp(aa,
"i"),da));M=ca=b(ca.replace(/ ce$/i," CE").replace(/\bhpw/i,"web").replace(/\bMacintosh\b/,"Mac OS").replace(/_PowerPC\b/i," OS").replace(/\b(OS X) [^ \d]+/i,"$1").replace(/\bMac (OS X)\b/,"$1").replace(/\/(\d)/," $1").replace(/_/g,".").replace(/(?: BePC|[ .]*fc[ \d.]+)$/i,"").replace(/\bx86\.64\b/gi,"x86_64").replace(/\b(Windows Phone) OS\b/,"$1").replace(/\b(Chrome OS \w+) [\d.]+\b/,"$1").split(" on ")[0])}return M})}(["Windows Phone","KaiOS","Android","CentOS",{label:"Chrome OS",pattern:"CrOS"},
"Debian",{label:"DragonFly BSD",pattern:"DragonFly"},"Fedora","FreeBSD","Gentoo","Haiku","Kubuntu","Linux Mint","OpenBSD","Red Hat","SuSE","Ubuntu","Xubuntu","Cygwin","Symbian OS","hpwOS","webOS ","webOS","Tablet OS","Tizen","Linux","Mac OS X","Macintosh","Mac","Windows 98;","Windows "]);I&&(I=[I]);/\bAndroid\b/.test(y)&&!x&&(k=/\bAndroid[^;]*;(.*?)(?:Build|\) AppleWebKit)\b/i.exec(q))&&(x=g(k[1]).replace(/^[a-z]{2}-[a-z]{2};\s*/i,"")||null);C&&!x?x=H([C]):C&&x&&(x=x.replace(RegExp("^("+h(C)+")[-_.\\s]",
"i"),C+" ").replace(RegExp("^("+h(C)+")[-_.]?(\\w)","i"),C+" $2"));if(k=/\bGoogle TV\b/.exec(x))x=k[0];/\bSimulator\b/i.test(q)&&(x=(x?x+" ":"")+"Simulator");"Opera Mini"==t&&/\bOPiOS\b/.test(q)&&F.push("running in Turbo/Uncompressed mode");"IE"==t&&/\blike iPhone OS\b/.test(q)?(k=p(q.replace(/like iPhone OS/,"")),C=k.manufacturer,x=k.product):/^iP/.test(x)?(t||(t="Safari"),y="iOS"+((k=/ OS ([\d_]+)/i.exec(q))?" "+k[1].replace(/_/g,"."):"")):"Konqueror"==t&&/^Linux\b/i.test(y)?y="Kubuntu":C&&"Google"!=
C&&(/Chrome/.test(t)&&!/\bMobile Safari\b/i.test(q)||/\bVita\b/.test(x))||/\bAndroid\b/.test(y)&&/^Chrome/.test(t)&&/\bVersion\//i.test(q)?(t="Android Browser",y=/\bAndroid\b/.test(y)?y:"Android"):"Silk"==t?(/\bMobi/i.test(q)||(y="Android",F.unshift("desktop mode")),/Accelerated *= *true/i.test(q)&&F.unshift("accelerated")):"UC Browser"==t&&/\bUCWEB\b/.test(q)?F.push("speed mode"):"PaleMoon"==t&&(k=/\bFirefox\/([\d.]+)\b/.exec(q))?F.push("identifying as Firefox "+k[1]):"Firefox"==t&&(k=/\b(Mobile|Tablet|TV)\b/i.exec(q))?
(y||(y="Firefox OS"),x||(x=k[1])):!t||(k=!/\bMinefield\b/i.test(q)&&/\b(?:Firefox|Safari)\b/.exec(t))?(t&&!x&&/[\/,]|^[^(]+?\)/.test(q.slice(q.indexOf(k+"/")+8))&&(t=null),(k=x||C||y)&&(x||C||/\b(?:Android|Symbian OS|Tablet OS|webOS)\b/.test(y))&&(t=/[a-z]+(?: Hat)?/i.exec(/\bAndroid\b/.test(y)?y:k)+" Browser")):"Electron"==t&&(k=(/\bChrome\/([\d.]+)\b/.exec(q)||0)[1])&&F.push("Chromium "+k);A||(A=J(["(?:Cloud9|CriOS|CrMo|Edge|Edg|EdgA|EdgiOS|FxiOS|HeadlessChrome|IEMobile|Iron|Opera ?Mini|OPiOS|OPR|Raven|SamsungBrowser|Silk(?!/[\\d.]+$)|UCBrowser|YaBrowser)",
"Version",h(t),"(?:Firefox|Minefield|NetFront)"]));if(k="iCab"==I&&3<parseFloat(A)&&"WebKit"||/\bOpera\b/.test(t)&&(/\bOPR\b/.test(q)?"Blink":"Presto")||/\b(?:Midori|Nook|Safari)\b/i.test(q)&&!/^(?:Trident|EdgeHTML)$/.test(I)&&"WebKit"||!I&&/\bMSIE\b/i.test(q)&&("Mac OS"==y?"Tasman":"Trident")||"WebKit"==I&&/\bPlayStation\b(?! Vita\b)/i.test(t)&&"NetFront")I=[k];"IE"==t&&(k=(/; *(?:XBLWP|ZuneWP)(\d+)/i.exec(q)||0)[1])?(t+=" Mobile",y="Windows Phone "+(/\+$/.test(k)?k:k+".x"),F.unshift("desktop mode")):
/\bWPDesktop\b/i.test(q)?(t="IE Mobile",y="Windows Phone 8.x",F.unshift("desktop mode"),A||(A=(/\brv:([\d.]+)/.exec(q)||0)[1])):"IE"!=t&&"Trident"==I&&(k=/\brv:([\d.]+)/.exec(q))&&(t&&F.push("identifying as "+t+(A?" "+A:"")),t="IE",A=k[1]);if(O){if(m(D,"global"))if(U&&(k=U.lang.System,G=k.getProperty("os.arch"),y=y||k.getProperty("os.name")+" "+k.getProperty("os.version")),Y){try{A=D.require("ringo/engine").version.join("."),t="RingoJS"}catch(S){(k=D.system)&&k.global.system==D.system&&(t="Narwhal",
y||(y=k[0].os||null))}t||(t="Rhino")}else"object"==typeof D.process&&!D.process.browser&&(k=D.process)&&("object"==typeof k.versions&&("string"==typeof k.versions.electron?(F.push("Node "+k.versions.node),t="Electron",A=k.versions.electron):"string"==typeof k.versions.nw&&(F.push("Chromium "+A,"Node "+k.versions.node),t="NW.js",A=k.versions.nw)),t||(t="Node.js",G=k.arch,y=k.platform,A=(A=/[\d.]+/.exec(k.version))?A[0]:null));else d(k=D.runtime)==ba?(t="Adobe AIR",y=k.flash.system.Capabilities.os):
d(k=D.phantom)==W?(t="PhantomJS",A=(k=k.version||null)&&k.major+"."+k.minor+"."+k.patch):"number"==typeof V.documentMode&&(k=/\bTrident\/(\d+)/i.exec(q))?(A=[A,V.documentMode],(k=+k[1]+4)!=A[1]&&(F.push("IE "+A[1]+" mode"),I&&(I[1]=""),A[1]=k),A="IE"==t?String(A[1].toFixed(1)):A[0]):"number"==typeof V.documentMode&&/^(?:Chrome|Firefox)\b/.test(t)&&(F.push("masking as "+t+" "+A),t="IE",A="11.0",I=["Trident"],y="Windows");y=y&&b(y)}A&&(k=/(?:[ab]|dp|pre|[ab]\d+pre)(?:\d+\+?)?$/i.exec(A)||/(?:alpha|beta)(?: ?\d)?/i.exec(q+
";"+(O&&w.appMinorVersion))||/\bMinefield\b/i.test(q)&&"a")&&(X=/b/i.test(k)?"beta":"alpha",A=A.replace(RegExp(k+"\\+?$"),"")+("beta"==X?R:Q)+(/\d+\+?/.exec(k)||""));if("Fennec"==t||"Firefox"==t&&/\b(?:Android|Firefox OS|KaiOS)\b/.test(y))t="Firefox Mobile";else if("Maxthon"==t&&A)A=A.replace(/\.[\d.]+/,".x");else if(/\bXbox\b/i.test(x))"Xbox 360"==x&&(y=null),"Xbox 360"==x&&/\bIEMobile\b/.test(q)&&F.unshift("mobile mode");else if(!/^(?:Chrome|IE|Opera)$/.test(t)&&(!t||x||/Browser|Mobi/.test(t))||
"Windows CE"!=y&&!/Mobi/i.test(q))if("IE"==t&&O)try{null===D.external&&F.unshift("platform preview")}catch(S){F.unshift("embedded")}else(/\bBlackBerry\b/.test(x)||/\bBB10\b/.test(q))&&(k=(RegExp(x.replace(/ +/g," *")+"/([.\\d]+)","i").exec(q)||0)[1]||A)?(k=[k,/BB10/.test(q)],y=(k[1]?(x=null,C="BlackBerry"):"Device Software")+" "+k[0],A=null):this!=e&&"Wii"!=x&&(O&&P||/Opera/.test(t)&&/\b(?:MSIE|Firefox)\b/i.test(q)||"Firefox"==t&&/\bOS X (?:\d+\.){2,}/.test(y)||"IE"==t&&(y&&!/^Win/.test(y)&&5.5<A||
/\bWindows XP\b/.test(y)&&8<A||8==A&&!/\bTrident\b/.test(q)))&&!z.test(k=p.call(e,q.replace(z,"")+";"))&&k.name&&(k="ing as "+k.name+((k=k.version)?" "+k:""),z.test(t)?(/\bIE\b/.test(k)&&"Mac OS"==y&&(y=null),k="identify"+k):(k="mask"+k,t=T?b(T.replace(/([a-z])([A-Z])/g,"$1 $2")):"Opera",/\bIE\b/.test(k)&&(y=null),O||(A=null)),I=["Presto"],F.push(k));else t+=" Mobile";if(k=(/\bAppleWebKit\/([\d.]+\+?)/i.exec(q)||0)[1]){k=[parseFloat(k.replace(/\.(\d)$/,".0$1")),k];if("Safari"==t&&"+"==k[1].slice(-1))t=
"WebKit Nightly",X="alpha",A=k[1].slice(0,-1);else if(A==k[1]||A==(k[2]=(/\bSafari\/([\d.]+\+?)/i.exec(q)||0)[1]))A=null;k[1]=(/\b(?:Headless)?Chrome\/([\d.]+)/i.exec(q)||0)[1];537.36==k[0]&&537.36==k[2]&&28<=parseFloat(k[1])&&"WebKit"==I&&(I=["Blink"]);O&&(L||k[1])?(I&&(I[1]="like Chrome"),k=k[1]||(k=k[0],530>k?1:532>k?2:532.05>k?3:533>k?4:534.03>k?5:534.07>k?6:534.1>k?7:534.13>k?8:534.16>k?9:534.24>k?10:534.3>k?11:535.01>k?12:535.02>k?"13+":535.07>k?15:535.11>k?16:535.19>k?17:536.05>k?18:536.1>
k?19:537.01>k?20:537.11>k?"21+":537.13>k?23:537.18>k?24:537.24>k?25:537.36>k?26:"Blink"!=I?"27":"28")):(I&&(I[1]="like Safari"),k=(k=k[0],400>k?1:500>k?2:526>k?3:533>k?4:534>k?"4+":535>k?5:537>k?6:538>k?7:601>k?8:602>k?9:604>k?10:606>k?11:608>k?12:"12"));I&&(I[1]+=" "+(k+="number"==typeof k?".x":/[.+]/.test(k)?"":"+"));"Safari"==t&&(!A||45<parseInt(A))?A=k:"Chrome"==t&&/\bHeadlessChrome/i.test(q)&&F.unshift("headless")}"Opera"==t&&(k=/\bzbov|zvav$/.exec(y))?(t+=" ",F.unshift("desktop mode"),"zvav"==
k?(t+="Mini",A=null):t+="Mobile",y=y.replace(RegExp(" *"+k+"$"),"")):"Safari"==t&&/\bChrome\b/.exec(I&&I[1])?(F.unshift("desktop mode"),t="Chrome Mobile",A=null,/\bOS X\b/.test(y)?(C="Apple",y="iOS 4.3+"):y=null):/\bSRWare Iron\b/.test(t)&&!A&&(A=J("Chrome"));A&&0==A.indexOf(k=/[\d.]+$/.exec(y))&&-1<q.indexOf("/"+k+"-")&&(y=g(y.replace(k,"")));y&&-1!=y.indexOf(t)&&!RegExp(t+" OS").test(y)&&(y=y.replace(RegExp(" *"+h(t)+" *"),""));I&&!/\b(?:Avant|Nook)\b/.test(t)&&(/Browser|Lunascape|Maxthon/.test(t)||
"Safari"!=t&&/^iOS/.test(y)&&/\bSafari\b/.test(I[1])||/^(?:Adobe|Arora|Breach|Midori|Opera|Phantom|Rekonq|Rock|Samsung Internet|Sleipnir|SRWare Iron|Vivaldi|Web)/.test(t)&&I[1])&&(k=I[I.length-1])&&F.push(k);F.length&&(F=["("+F.join("; ")+")"]);C&&x&&0>x.indexOf(C)&&F.push("on "+C);x&&F.push((/^on /.test(F[F.length-1])?"":"on ")+x);if(y){var Z=(k=/ ([\d.+]+)$/.exec(y))&&"/"==y.charAt(y.length-k[0].length-1);y={architecture:32,family:k&&!Z?y.replace(k[0],""):y,version:k?k[1]:null,toString:function(){var S=
this.version;return this.family+(S&&!Z?" "+S:"")+(64==this.architecture?" 64-bit":"")}}}(k=/\b(?:AMD|IA|Win|WOW|x86_|x)64\b/i.exec(G))&&!/\bi686\b/i.test(G)?(y&&(y.architecture=64,y.family=y.family.replace(RegExp(" *"+k),"")),t&&(/\bWOW64\b/i.test(q)||O&&/\w(?:86|32)$/.test(w.cpuClass||w.platform)&&!/\bWin64; x64\b/i.test(q))&&F.unshift("32-bit")):y&&/^OS X/.test(y.family)&&"Chrome"==t&&39<=parseFloat(A)&&(y.architecture=64);q||(q=null);D={};D.description=q;D.layout=I&&I[0];D.manufacturer=C;D.name=
t;D.prerelease=X;D.product=x;D.ua=q;D.version=t&&A;D.os=y||{architecture:null,family:null,version:null,toString:function(){return"null"}};D.parse=p;D.toString=function(){return this.description||""};D.version&&F.unshift(A);D.name&&F.unshift(t);y&&t&&(y!=String(y).split(" ")[0]||y!=t.split(" ")[0]&&!x)&&F.push(x?"("+y+")":"on "+y);F.length&&(D.description=F.join(" "));return D}var r={"function":!0,object:!0},f=r[typeof window]&&window||this,n=r[typeof exports]&&exports;r=r[typeof module]&&module&&
!module.nodeType&&module;var v=n&&r&&"object"==typeof global&&global;!v||v.global!==v&&v.window!==v&&v.self!==v||(f=v);var u=Math.pow(2,53)-1,z=/\bOpera/;v=Object.prototype;var E=v.hasOwnProperty,B=v.toString,K=p();"function"==typeof define&&"object"==typeof define.amd&&define.amd?(f.platform=K,define(function(){return K})):n&&r?e(K,function(q,H){n[H]=q}):f.platform=K}).call(this);
function buildIOSMeta(){for(var a=[{name:"viewport",content:"width=device-width, height=device-height, initial-scale=1, minimum-scale=1, maximum-scale=1, user-scalable=no"},{name:"apple-mobile-web-app-capable",content:"yes"},{name:"apple-mobile-web-app-status-bar-style",content:"black"}],c=0;c<a.length;c++){var b=document.createElement("meta");b.name=a[c].name;b.content=a[c].content;var e=window.document.head.querySelector('meta[name="'+b.name+'"]');e&&e.parentNode.removeChild(e);window.document.head.appendChild(b)}}
function hideIOSFullscreenPanel(){jQuery(".xxx-ios-fullscreen-message").css("display","none");jQuery(".xxx-ios-fullscreen-scroll").css("display","none");jQuery(".xxx-game-iframe-full").removeClass("xxx-game-iframe-iphone-se")}function buildIOSFullscreenPanel(){jQuery("body").append('<div class="xxx-ios-fullscreen-message"><div class="xxx-ios-fullscreen-swipe"></div></div><div class="xxx-ios-fullscreen-scroll"></div>')}
function showIOSFullscreenPanel(){jQuery(".xxx-ios-fullscreen-message").css("display","block");jQuery(".xxx-ios-fullscreen-scroll").css("display","block")}
function __iosResize(){window.scrollTo(0,0);console.log(window.devicePixelRatio);console.log(window.innerWidth);console.log(window.innerHeight);if("iPhone"===platform.product)switch(window.devicePixelRatio){case 2:switch(window.innerWidth){case 568:320!==window.innerHeight&&jQuery(".xxx-game-iframe-full").addClass("xxx-game-iframe-iphone-se");break;case 667:375===window.innerHeight?hideIOSFullscreenPanel():showIOSFullscreenPanel();break;case 808:414===window.innerHeight?hideIOSFullscreenPanel():showIOSFullscreenPanel();
break;default:hideIOSFullscreenPanel()}break;case 3:switch(window.innerWidth){case 736:414===window.innerHeight?hideIOSFullscreenPanel():showIOSFullscreenPanel();break;case 724:375===window.innerHeight?hideIOSFullscreenPanel():showIOSFullscreenPanel();break;case 808:414===window.innerHeight?hideIOSFullscreenPanel():showIOSFullscreenPanel();break;default:hideIOSFullscreenPanel()}break;default:hideIOSFullscreenPanel()}}function iosResize(){__iosResize();setTimeout(function(){__iosResize()},500)}
function iosInIframe(){try{return window.self!==window.top}catch(a){return!0}}$(document).ready(function(){platform&&"iPhone"===platform.product&&"safari"!==platform.name.toLowerCase()&&!iosInIframe()&&(buildIOSFullscreenPanel(),buildIOSMeta())});jQuery(window).resize(function(){platform&&"iPhone"===platform.product&&"safari"!==platform.name.toLowerCase()&&!iosInIframe()&&iosResize()});
function CVector2(a,c){var b,e;this._init=function(d,m){b=d;e=m};this.add=function(d,m){b+=d;e+=m};this.addV=function(d){b+=d.getX();e+=d.getY()};this.scalarDivision=function(d){b/=d;e/=d};this.subV=function(d){b-=d.getX();e-=d.getY()};this.scalarProduct=function(d){b*=d;e*=d};this.invert=function(){b*=-1;e*=-1};this.dotProduct=function(d){return b*d.getX()+e*d.getY()};this.set=function(d,m){b=d;e=m};this.setV=function(d){b=d.getX();e=d.getY()};this.length=function(){return Math.sqrt(b*b+e*e)};this.length2=
function(){return b*b+e*e};this.normalize=function(){var d=this.length();0<d&&(b/=d,e/=d)};this.getNormalize=function(d){this.length();d.set(b,e);d.normalize()};this.rot90CCW=function(){var d=b;b=-e;e=d};this.rot90CW=function(){var d=b;b=e;e=-d};this.getRotCCW=function(d){d.set(b,e);d.rot90CCW()};this.getRotCW=function(d){d.set(b,e);d.rot90CW()};this.ceil=function(){b=Math.ceil(b);e=Math.ceil(e)};this.round=function(){b=Math.round(b);e=Math.round(e)};this.toString=function(){return"Vector2: "+b+", "+
e};this.print=function(){trace("Vector2: "+b+", "+e)};this.getX=function(){return b};this.getY=function(){return e};this._init(a,c)}
function CCollisionRectangle(a,c,b,e,d,m){var h;this.init=function(){h=new CRectangle;var l=[];l.push(new createjs.Point(c,b));l.push(new createjs.Point(-e+2,-d+3));l.push(new createjs.Point(a.width-e-2,-d+3));l.push(new createjs.Point(a.width-e-2,a.height-d-3));l.push(new createjs.Point(-e+2,a.height-d-3));h.prepareBox(l);h.addAngle(m)};this.move=function(l,g){h.move(l,g)};this.applySteering=function(l){h.addAngle(l)};this.getBox=function(){return h};this.refresh=function(l,g){var p=h.getNorm(),
r=l.getNorm(),f=this.prepareVector(h),n=this.getMinMax(f,p[1]),v=this.getMinMax(g,p[1]),u=this.getMinMax(f,p[0]),z=this.getMinMax(g,p[0]);p=this.getMinMax(f,r[1]);var E=this.getMinMax(g,r[1]);f=this.getMinMax(f,r[0]);r=this.getMinMax(g,r[0]);u=u.max_proj<z.min_proj||z.max_proj<u.min_proj;p=p.max_proj<E.min_proj||E.max_proj<p.min_proj;E=f.max_proj<r.min_proj||r.max_proj<f.min_proj;return n.max_proj<v.min_proj||v.max_proj<n.min_proj||u||p||E};this.prepareVector=function(l){for(var g=[],p=0;5>p;p++){var r=
l.getDot(p);g.push(new CVector2(r.x,r.y))}return g};this.getMinMax=function(l,g){for(var p=l[1].dotProduct(g),r=l[1].dotProduct(g),f=2;f<l.length;f++){var n=l[f].dotProduct(g);p>n&&(p=n);n>r&&(r=n)}return{min_proj:p,max_proj:r}};this.init()}
function CRectangle(){var a;this.init=function(){a=[]};this.prepareBox=function(c){a.push(new createjs.Shape);a[0].graphics.beginFill("#ff0000").drawCircle(0,0,10);a[0].x=c[0].x;a[0].y=c[0].y;for(var b=1;b<c.length;b++)a.push(new createjs.Shape),a[b].graphics.beginFill("#ff0000").drawCircle(0,0,5),a[b].x=c[0].x+c[b].x,a[b].y=c[0].y+c[b].y};this.addAngle=function(c){var b=Math.cos(c*Math.PI/180);c=Math.sin(c*Math.PI/180);for(var e=1;e<a.length;e++){var d=a[e].x-a[0].x,m=a[e].y-a[0].y;a[e].x=d*b-m*
c;a[e].y=d*c+m*b;a[e].x+=a[0].x;a[e].y+=a[0].y}this.drawBox()};this.move=function(c,b){for(var e=0;e<a.length;e++)a[e].x+=c,a[e].y+=b};this.getDot=function(c){return{x:a[c].x,y:a[c].y}};this.drawBox=function(){for(var c=0;c<a.length;c++)a[c].alpha=.5,a[c].fillColor=0};this.getNorm=function(){for(var c=[],b=1;b<a.length-1;b++){var e=new CVector2(a[b+1].x-a[b].x,a[b+1].y-a[b].y);c.push(e)}b=new CVector2(a[1].x-a[a.length-1].x,a[1].y-a[a.length-1].y);c.push(b);return c};this.init()}
function toRadian(a){return Math.PI/180*a}function toDegree(a){return 180/Math.PI*a}function randRange(a,c){return Math.floor(Math.random()*(c-a+1))+a}function angleBetweenVectors(a,c){var b=Math.acos(dotProductV2(a,c)/(a.length()*c.length()));return!0===isNaN(b)?0:b}function rotateVector2D(a,c){var b=c.getX()*Math.cos(a)+c.getY()*Math.sin(a),e=c.getX()*-Math.sin(a)+c.getY()*Math.cos(a);c.set(b,e)}
function reflectVectorV2(a,c){var b=new CVector2,e=dotProductV2(a,c);b.set(a.getX()-2*e*c.getX(),a.getY()-2*e*c.getY());return b}function dotProductV2(a,c){return a.getX()*c.getX()+a.getY()*c.getY()}function pointInRect(a,c){return a.getX()>c.x&&a.getX()<c.x+c.width&&a.getY()>c.y&&a.getY()<c.y+c.height}function distance2(a,c){return(c.getX()-a.getX())*(c.getX()-a.getX())+(c.getY()-a.getY())*(c.getY()-a.getY())}var s_bIsIphone=!1,s_iOffsetX=0,s_iOffsetY=0,s_bFocus=!0;
(function(a){(jQuery.browser=jQuery.browser||{}).mobile=/android|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(ad|hone|od)|iris|kindle|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|symbian|tablet|treo|up\.(browser|link)|vodafone|wap|webos|windows (ce|phone)|xda|xiino/i.test(a)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|e\-|e\/|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(di|rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|xda(\-|2|g)|yas\-|your|zeto|zte\-/i.test(a.substr(0,
4))})(navigator.userAgent||navigator.vendor||window.opera);function trace(a){console.log(a)}$(window).resize(function(){sizeHandler()});function isChrome(){return/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)}function isIpad(){var a=-1!==navigator.userAgent.toLowerCase().indexOf("ipad");return!a&&navigator.userAgent.match(/Mac/)&&navigator.maxTouchPoints&&2<navigator.maxTouchPoints?!0:a}function isMobile(){return isIpad()?!0:jQuery.browser.mobile}
function isIOS(){for(var a="iPad Simulator;iPhone Simulator;iPod Simulator;iPad;iPhone;iPod".split(";");a.length;)if(navigator.platform===a.pop())return s_bIsIphone=!0;return s_bIsIphone=!1}function playSound(a,c,b){return!1===DISABLE_SOUND_MOBILE||!1===s_bMobile?(s_aSounds[a].play(),s_aSounds[a].volume(c),s_aSounds[a].loop(b),s_aSounds[a]):null}function stopSound(a){!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||s_aSounds[a].stop()}
function setVolume(a,c){!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||s_aSounds[a].volume(c)}function setMute(a,c){!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||s_aSounds[a].mute(c)}function isTablet(){var a=navigator.userAgent.toLowerCase();return-1!==a.indexOf("ipad")?!0:-1<a.indexOf("android")&&-1===a.indexOf("mobile")?!0:!1}
function getSize(a){var c=a.toLowerCase(),b=window.document,e=b.documentElement;if(void 0===window["inner"+a])a=e["client"+a];else if(window["inner"+a]!=e["client"+a]){var d=b.createElement("body");d.id="vpw-test-b";d.style.cssText="overflow:scroll";var m=b.createElement("div");m.id="vpw-test-d";m.style.cssText="position:absolute;top:-1000px";m.innerHTML="<style>@media("+c+":"+e["client"+a]+"px){body#vpw-test-b div#vpw-test-d{"+c+":7px!important}}</style>";d.appendChild(m);e.insertBefore(d,b.head);
a=7==m["offset"+a]?e["client"+a]:window["inner"+a];e.removeChild(d)}else a=window["inner"+a];return a}window.addEventListener("orientationchange",onOrientationChange);function onOrientationChange(){sizeHandler()}function getIOSWindowHeight(){return document.documentElement.clientWidth/window.innerWidth*window.innerHeight}function getHeightOfIOSToolbars(){var a=(0===window.orientation?screen.height:screen.width)-getIOSWindowHeight();return 1<a?a:0}
function sizeHandler(){window.scrollTo(0,1);if($("#canvas")){var a=null!==platform.name&&"safari"===platform.name.toLowerCase()?getIOSWindowHeight():getSize("Height");var c=getSize("Width");s_bFocus&&_checkOrientation(c,a);var b=Math.min(a/CANVAS_HEIGHT,c/CANVAS_WIDTH),e=Math.round(CANVAS_WIDTH*b);b=Math.round(CANVAS_HEIGHT*b);if(b<a){var d=a-b;b+=d;e+=CANVAS_WIDTH/CANVAS_HEIGHT*d}else e<c&&(d=c-e,e+=d,b+=CANVAS_HEIGHT/CANVAS_WIDTH*d);d=a/2-b/2;var m=c/2-e/2,h=CANVAS_WIDTH/e;if(m*h<-EDGEBOARD_X||
d*h<-EDGEBOARD_Y)b=Math.min(a/(CANVAS_HEIGHT-2*EDGEBOARD_Y),c/(CANVAS_WIDTH-2*EDGEBOARD_X)),e=Math.round(CANVAS_WIDTH*b),b=Math.round(CANVAS_HEIGHT*b),d=(a-b)/2,m=(c-e)/2,h=CANVAS_WIDTH/e;s_iOffsetX=-1*m*h;s_iOffsetY=-1*d*h;0<=d&&(s_iOffsetY=0);0<=m&&(s_iOffsetX=0);null!==s_oInterface&&s_oInterface.refreshButtonPos(s_iOffsetX,s_iOffsetY);null!==s_oMenu&&s_oMenu.refreshButtonPos(s_iOffsetX,s_iOffsetY);null!==s_oLevelMenu&&s_oLevelMenu.refreshButtonPos(s_iOffsetX,s_iOffsetY);s_bIsIphone?(canvas=document.getElementById("canvas"),
s_oStage.canvas.width=2*e,s_oStage.canvas.height=2*b,canvas.style.width=e+"px",canvas.style.height=b+"px",s_oStage.scaleX=s_oStage.scaleY=2*Math.min(e/CANVAS_WIDTH,b/CANVAS_HEIGHT)):s_bMobile||isChrome()?($("#canvas").css("width",e+"px"),$("#canvas").css("height",b+"px")):(s_oStage.canvas.width=e,s_oStage.canvas.height=b,s_iScaleFactor=Math.min(e/CANVAS_WIDTH,b/CANVAS_HEIGHT),s_oStage.scaleX=s_oStage.scaleY=s_iScaleFactor);0>d||(d=(a-b)/2);$("#canvas").css("top",d+"px");$("#canvas").css("left",m+
"px");fullscreenHandler()}}
function _checkOrientation(a,c){s_bMobile&&ENABLE_CHECK_ORIENTATION&&(a>c?"landscape"===$(".orientation-msg-container").attr("data-orientation")?($(".orientation-msg-container").css("display","none"),s_oMain.startUpdate()):($(".orientation-msg-container").css("display","block"),s_oMain.stopUpdate()):"portrait"===$(".orientation-msg-container").attr("data-orientation")?($(".orientation-msg-container").css("display","none"),s_oMain.startUpdate()):($(".orientation-msg-container").css("display","block"),
s_oMain.stopUpdate()))}function createBitmap(a,c,b){var e=new createjs.Bitmap(a),d=new createjs.Shape;c&&b?d.graphics.beginFill("#fff").drawRect(0,0,c,b):d.graphics.beginFill("#ff0").drawRect(0,0,a.width,a.height);e.hitArea=d;return e}function createSprite(a,c,b,e,d,m){a=null!==c?new createjs.Sprite(a,c):new createjs.Sprite(a);c=new createjs.Shape;c.graphics.beginFill("#000000").drawRect(-b,-e,d,m);a.hitArea=c;return a}
function randomFloatBetween(a,c,b){"undefined"===typeof b&&(b=2);return parseFloat(Math.min(a+Math.random()*(c-a),c).toFixed(b))}function rotateVector2D(a,c){var b=c.getX()*Math.cos(a)+c.getY()*Math.sin(a),e=c.getX()*-Math.sin(a)+c.getY()*Math.cos(a);c.set(b,e)}function tweenVectorsOnX(a,c,b){return a+b*(c-a)}function shuffle(a){for(var c=a.length,b,e;0!==c;)e=Math.floor(Math.random()*c),--c,b=a[c],a[c]=a[e],a[e]=b;return a}
function bubbleSort(a){do{var c=!1;for(var b=0;b<a.length-1;b++)a[b]>a[b+1]&&(c=a[b],a[b]=a[b+1],a[b+1]=c,c=!0)}while(c)}function compare(a,c){return a.index>c.index?-1:a.index<c.index?1:0}function easeLinear(a,c,b,e){return b*a/e+c}function easeInQuad(a,c,b,e){return b*(a/=e)*a+c}function easeInSine(a,c,b,e){return-b*Math.cos(a/e*(Math.PI/2))+b+c}function easeInCubic(a,c,b,e){return b*(a/=e)*a*a+c}function easeOutCubic(a,c,b,e,d){return b*((a=a/e-1)*a*a+1)+c}
function getTrajectoryPoint(a,c){var b=new createjs.Point,e=(1-a)*(1-a),d=a*a;b.x=e*c.start.x+2*(1-a)*a*c.traj.x+d*c.end.x;b.y=e*c.start.y+2*(1-a)*a*c.traj.y+d*c.end.y;return b}function formatTime(a){a/=1E3;var c=Math.floor(a/60);a=Math.floor(a-60*c);var b="";b=10>c?b+("0"+c+":"):b+(c+":");return 10>a?b+("0"+a):b+a}function degreesToRadians(a){return a*Math.PI/180}function checkRectCollision(a,c){var b=getBounds(a,.9);var e=getBounds(c,.98);return calculateIntersection(b,e)}
function calculateIntersection(a,c){var b,e,d,m;var h=a.x+(b=a.width/2);var l=a.y+(e=a.height/2);var g=c.x+(d=c.width/2);var p=c.y+(m=c.height/2);h=Math.abs(h-g)-(b+d);l=Math.abs(l-p)-(e+m);return 0>h&&0>l?(h=Math.min(Math.min(a.width,c.width),-h),l=Math.min(Math.min(a.height,c.height),-l),{x:Math.max(a.x,c.x),y:Math.max(a.y,c.y),width:h,height:l,rect1:a,rect2:c}):null}
function getBounds(a,c){var b={x:Infinity,y:Infinity,width:0,height:0};if(a instanceof createjs.Container){b.x2=-Infinity;b.y2=-Infinity;var e=a.children,d=e.length,m;for(m=0;m<d;m++){var h=getBounds(e[m],1);h.x<b.x&&(b.x=h.x);h.y<b.y&&(b.y=h.y);h.x+h.width>b.x2&&(b.x2=h.x+h.width);h.y+h.height>b.y2&&(b.y2=h.y+h.height)}Infinity==b.x&&(b.x=0);Infinity==b.y&&(b.y=0);Infinity==b.x2&&(b.x2=0);Infinity==b.y2&&(b.y2=0);b.width=b.x2-b.x;b.height=b.y2-b.y;delete b.x2;delete b.y2}else{if(a instanceof createjs.Bitmap){d=
a.sourceRect||a.image;m=d.width*c;var l=d.height*c}else if(a instanceof createjs.Sprite)if(a.spriteSheet._frames&&a.spriteSheet._frames[a.currentFrame]&&a.spriteSheet._frames[a.currentFrame].image){d=a.spriteSheet.getFrame(a.currentFrame);m=d.rect.width;l=d.rect.height;e=d.regX;var g=d.regY}else b.x=a.x||0,b.y=a.y||0;else b.x=a.x||0,b.y=a.y||0;e=e||0;m=m||0;g=g||0;l=l||0;b.regX=e;b.regY=g;d=a.localToGlobal(0-e,0-g);h=a.localToGlobal(m-e,l-g);m=a.localToGlobal(m-e,0-g);e=a.localToGlobal(0-e,l-g);b.x=
Math.min(Math.min(Math.min(d.x,h.x),m.x),e.x);b.y=Math.min(Math.min(Math.min(d.y,h.y),m.y),e.y);b.width=Math.max(Math.max(Math.max(d.x,h.x),m.x),e.x)-b.x;b.height=Math.max(Math.max(Math.max(d.y,h.y),m.y),e.y)-b.y}return b}function NoClickDelay(a){this.element=a;window.Touch&&this.element.addEventListener("touchstart",this,!1)}function shuffle(a){for(var c=a.length,b,e;0<c;)e=Math.floor(Math.random()*c),c--,b=a[c],a[c]=a[e],a[e]=b;return a}
NoClickDelay.prototype={handleEvent:function(a){switch(a.type){case "touchstart":this.onTouchStart(a);break;case "touchmove":this.onTouchMove(a);break;case "touchend":this.onTouchEnd(a)}},onTouchStart:function(a){a.preventDefault();this.moved=!1;this.element.addEventListener("touchmove",this,!1);this.element.addEventListener("touchend",this,!1)},onTouchMove:function(a){this.moved=!0},onTouchEnd:function(a){this.element.removeEventListener("touchmove",this,!1);this.element.removeEventListener("touchend",
this,!1);if(!this.moved){a=document.elementFromPoint(a.changedTouches[0].clientX,a.changedTouches[0].clientY);3==a.nodeType&&(a=a.parentNode);var c=document.createEvent("MouseEvents");c.initEvent("click",!0,!0);a.dispatchEvent(c)}}};
(function(){function a(b){var e={focus:"visible",focusin:"visible",pageshow:"visible",blur:"hidden",focusout:"hidden",pagehide:"hidden"};b=b||window.event;b.type in e?document.body.className=e[b.type]:(document.body.className=this[c]?"hidden":"visible","hidden"===document.body.className?(s_oMain.stopUpdate(),s_bFocus=!1):(s_oMain.startUpdate(),s_bFocus=!0))}var c="hidden";c in document?document.addEventListener("visibilitychange",a):(c="mozHidden")in document?document.addEventListener("mozvisibilitychange",
a):(c="webkitHidden")in document?document.addEventListener("webkitvisibilitychange",a):(c="msHidden")in document?document.addEventListener("msvisibilitychange",a):"onfocusin"in document?document.onfocusin=document.onfocusout=a:window.onpageshow=window.onpagehide=window.onfocus=window.onblur=a})();function ctlArcadeResume(){null!==s_oMain&&s_oMain.startUpdate()}function ctlArcadePause(){null!==s_oMain&&s_oMain.stopUpdate()}
function getParamValue(a){for(var c=window.location.search.substring(1).split("&"),b=0;b<c.length;b++){var e=c[b].split("=");if(e[0]==a)return e[1]}}function saveItem(a,c){s_bStorageAvailable&&localStorage.setItem(a,c)}function getItem(a){return s_bStorageAvailable?localStorage.getItem(a):null}function clearAllItem(){s_bStorageAvailable&&localStorage.clear()}
function fullscreenHandler(){ENABLE_FULLSCREEN&&!1!==screenfull.isEnabled&&(s_bFullscreen=screenfull.isFullscreen,null!==s_oInterface&&s_oInterface.resetFullscreenBut(),null!==s_oMenu&&s_oMenu.resetFullscreenBut())}if(screenfull.isEnabled)screenfull.on("change",function(){s_bFullscreen=screenfull.isFullscreen;null!==s_oInterface&&s_oInterface.resetFullscreenBut();null!==s_oMenu&&s_oMenu.resetFullscreenBut()});
function CSpriteLibrary(){var a={},c,b,e,d,m,h;this.init=function(l,g,p){c={};e=b=0;d=l;m=g;h=p};this.addSprite=function(l,g){if(!a.hasOwnProperty(l)){var p=new Image;a[l]=c[l]={szPath:g,oSprite:p,bLoaded:!1};b++}};this.getSprite=function(l){return a.hasOwnProperty(l)?a[l].oSprite:null};this._onSpritesLoaded=function(){b=0;m.call(h)};this._onSpriteLoaded=function(){d.call(h);++e===b&&this._onSpritesLoaded()};this.loadSprites=function(){for(var l in c)c[l].oSprite.oSpriteLibrary=this,c[l].oSprite.szKey=
l,c[l].oSprite.onload=function(){this.oSpriteLibrary.setLoaded(this.szKey);this.oSpriteLibrary._onSpriteLoaded(this.szKey)},c[l].oSprite.onerror=function(g){var p=g.currentTarget;setTimeout(function(){c[p.szKey].oSprite.src=c[p.szKey].szPath},500)},c[l].oSprite.src=c[l].szPath};this.setLoaded=function(l){a[l].bLoaded=!0};this.isLoaded=function(l){return a[l].bLoaded};this.getNumSprites=function(){return b}}
var CANVAS_WIDTH=1360,CANVAS_HEIGHT=540,EDGEBOARD_X=330,EDGEBOARD_Y=0,FONT="gotham_boldregular",NUM_LEVELS=10,NUM_CARS=18,NUM_CONTAINERS=8,FPS_TIME=1E3/24,DISABLE_SOUND_MOBILE=!1,LEVEL_TIME,MIN_SPEED_OFFSET,SOUNDTRACK_VOLUME_IN_GAME=.5,STATE_LOADING=0,STATE_MENU=1,STATE_HELP=1,STATE_GAME=3,LEFT_DIR=37,UP_DIR=38,RIGHT_DIR=39,DOWN_DIR=40,SPACEBAR=32,ON_MOUSE_DOWN=0,ON_MOUSE_UP=1,ON_MOUSE_OVER=2,ON_MOUSE_OUT=3,ON_DRAG_START=4,ON_DRAG_END=5,ON_BUT_NO_DOWN=6,ON_BUT_YES_DOWN=7,ENABLE_FULLSCREEN,ENABLE_CHECK_ORIENTATION,
TEXT_ALL_LEVELS_COMPLETED="CONGRATULATIONS! ALL LEVELS HAVE BEEN COMPLETED!",TEXT_SCORE="LEVEL SCORE: ",TEXT_NEXT_LEVEL="CONGRATULATIONS!",TEXT_LEVEL="SELECT LEVEL",TEXT_GAME_OVER="YOU CRASHED YOUR CAR!",TEXT_TOTAL_SCORE="TOTAL SCORE: ",TEXT_CREDITS_DEVELOPED="Developed by",TEXT_PRELOADER_CONTINUE="START",TEXT_MOVE_DESKTOP="USE ARROW KEYS TO STEER AND DRIVE YOUR CAR",TEXT_MOVE_MOBILE="STEER",TEXT_MOVE_MOBILE1="BREAK/\nREVERSE",TEXT_MOVE_MOBILE2="ACCELERATOR",TEXT_RESET="ARE YOU SURE? ALL YOUR SAVED PROGRESS WILL BE DELETED!",
TEXT_ERR_LS="YOUR WEB BROWSER DOES NOT SUPPORT STORING SETTING LOCALLY. IN SAFARI, THE MOST COMMON CAUSE OF THIS IS USING 'PRIVATE BROWSING MODE'. SOME INFO MAY NOT SAVE OR SOME FEATURE MAY NOT WORK PROPERLY.",TEXT_SHARE_IMAGE="200x200.jpg",TEXT_SHARE_TITLE="Congratulations!",TEXT_SHARE_MSG1="You collected <strong>",TEXT_SHARE_MSG2=" points</strong>!<br><br>Share your score with your friends!",TEXT_SHARE_SHARE1="My score is ",TEXT_SHARE_SHARE2=" points! Can you do better?";
function CPreloader(){var a,c,b,e,d,m,h,l,g,p;this._init=function(){s_oSpriteLibrary.init(this._onImagesLoaded,this._onAllImagesLoaded,this);s_oSpriteLibrary.addSprite("progress_bar","./sprites/progress_bar.png");s_oSpriteLibrary.addSprite("200x200","./sprites/200x200.jpg");s_oSpriteLibrary.addSprite("but_start","./sprites/but_start.png");s_oSpriteLibrary.loadSprites();p=new createjs.Container;s_oStage.addChild(p)};this.unload=function(){p.removeAllChildren()};this._onImagesLoaded=function(){};this._onAllImagesLoaded=
function(){this.attachSprites();s_oMain.preloaderReady()};this.attachSprites=function(){var r=new createjs.Shape;r.graphics.beginFill("black").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);p.addChild(r);r=s_oSpriteLibrary.getSprite("200x200");h=createBitmap(r);h.regX=.5*r.width;h.regY=.5*r.height;h.x=CANVAS_WIDTH/2;h.y=CANVAS_HEIGHT/2-80;p.addChild(h);l=new createjs.Shape;l.graphics.beginFill("rgba(0,0,0,0.01)").drawRoundRect(h.x-100,h.y-100,200,200,10);p.addChild(l);h.mask=l;r=s_oSpriteLibrary.getSprite("progress_bar");
e=createBitmap(r);e.x=CANVAS_WIDTH/2-r.width/2;e.y=CANVAS_HEIGHT/2+70;p.addChild(e);a=r.width;c=r.height;d=new createjs.Shape;d.graphics.beginFill("rgba(0,0,0,0.01)").drawRect(e.x,e.y,1,c);p.addChild(d);e.mask=d;b=new createjs.Text("","30px "+FONT,"#fff");b.x=CANVAS_WIDTH/2;b.y=CANVAS_HEIGHT/2+120;b.textBaseline="alphabetic";b.textAlign="center";p.addChild(b);r=s_oSpriteLibrary.getSprite("but_start");g=new CTextButton(CANVAS_WIDTH/2,CANVAS_HEIGHT/2+100,r,TEXT_PRELOADER_CONTINUE,"Arial","#000",36,
p);g.addEventListener(ON_MOUSE_UP,this._onButStartRelease,this);g.setVisible(!1);m=new createjs.Shape;m.graphics.beginFill("black").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);p.addChild(m);createjs.Tween.get(m).to({alpha:0},500).call(function(){createjs.Tween.removeTweens(m);p.removeChild(m)})};this._onButStartRelease=function(){s_oMain._onRemovePreloader()};this.refreshLoader=function(r){b.text=r+"%";100===r&&(s_oMain._onRemovePreloader(),b.visible=!1,e.visible=!1);d.graphics.clear();r=Math.floor(r*
a/100);d.graphics.beginFill("rgba(0,0,0,0.01)").drawRect(e.x,e.y,r,c)};this._init()}
function CMain(a){var c,b=0,e=0,d=STATE_LOADING,m,h;this.initContainer=function(){s_oCanvas=document.getElementById("canvas");s_oStage=new createjs.Stage(s_oCanvas);s_oStage.preventSelection=!1;createjs.Touch.enable(s_oStage);s_bMobile=isMobile();s_bTablet=isTablet();!1===s_bMobile&&(s_oStage.enableMouseOver(20),$("body").on("contextmenu","#canvas",function(g){return!1}));s_iPrevTime=(new Date).getTime();createjs.Ticker.addEventListener("tick",this._update);createjs.Ticker.framerate=30;navigator.userAgent.match(/Windows Phone/i)&&
(DISABLE_SOUND_MOBILE=!0);s_oSpriteLibrary=new CSpriteLibrary;m=new CPreloader};this.preloaderReady=function(){this._loadImages();!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||this._initSounds();c=!0};this.soundLoaded=function(){b++;m.refreshLoader(Math.floor(b/e*100))};this._initSounds=function(){Howler.mute(!s_bAudioActive);s_aSoundsInfo=[];s_aSoundsInfo.push({path:"./sounds/",filename:"car_parked",loop:!1,volume:1,ingamename:"car_parked"});s_aSoundsInfo.push({path:"./sounds/",filename:"but_press",
loop:!1,volume:1,ingamename:"but_press"});s_aSoundsInfo.push({path:"./sounds/",filename:"crash",loop:!1,volume:1,ingamename:"crash"});s_aSoundsInfo.push({path:"./sounds/",filename:"select_car",loop:!1,volume:1,ingamename:"select_car"});s_aSoundsInfo.push({path:"./sounds/",filename:"arrival_lose",loop:!1,volume:1,ingamename:"arrival_lose"});s_aSoundsInfo.push({path:"./sounds/",filename:"arrival_win",loop:!1,volume:1,ingamename:"arrival_win"});s_aSoundsInfo.push({path:"./sounds/",filename:"soundtrack",
loop:!0,volume:1,ingamename:"soundtrack"});e+=s_aSoundsInfo.length;s_aSounds=[];for(var g=0;g<s_aSoundsInfo.length;g++)this.tryToLoadSound(s_aSoundsInfo[g],!1)};this.tryToLoadSound=function(g,p){setTimeout(function(){s_aSounds[g.ingamename]=new Howl({src:[g.path+g.filename+".mp3"],autoplay:!1,preload:!0,loop:g.loop,volume:g.volume,onload:s_oMain.soundLoaded,onloaderror:function(r,f){for(var n=0;n<s_aSoundsInfo.length;n++)if(r===s_aSounds[s_aSoundsInfo[n].ingamename]._sounds[0]._id){s_oMain.tryToLoadSound(s_aSoundsInfo[n],
!0);break}},onplayerror:function(r){for(var f=0;f<s_aSoundsInfo.length;f++)if(r===s_aSounds[s_aSoundsInfo[f].ingamename]._sounds[0]._id){s_aSounds[s_aSoundsInfo[f].ingamename].once("unlock",function(){s_aSounds[s_aSoundsInfo[f].ingamename].play();"soundtrack"===s_aSoundsInfo[f].ingamename&&null!==s_oGame&&setVolume("soundtrack",SOUNDTRACK_VOLUME_IN_GAME)});break}}})},p?200:0)};this._loadImages=function(){s_oSpriteLibrary.init(this._onImagesLoaded,this._onAllImagesLoaded,this);s_oSpriteLibrary.addSprite("asphalt",
"./sprites/asphalt.jpg");s_oSpriteLibrary.addSprite("but_play","./sprites/but_play.png");s_oSpriteLibrary.addSprite("but_restart","./sprites/but_restart.png");s_oSpriteLibrary.addSprite("msg_box","./sprites/msg_box.png");s_oSpriteLibrary.addSprite("bg_menu","./sprites/bg_menu.png");s_oSpriteLibrary.addSprite("logo","./sprites/logo.png");s_oSpriteLibrary.addSprite("baloon_mc","./sprites/baloon_mc.png");s_oSpriteLibrary.addSprite("bg_menu","./sprites/bg_preloader.jpg");s_oSpriteLibrary.addSprite("progress_bar",
"./sprites/progress_bar.png");s_oSpriteLibrary.addSprite("steering_wheel","./sprites/steering_wheel.png");s_oSpriteLibrary.addSprite("wheel_bar","./sprites/wheel_bar.png");s_oSpriteLibrary.addSprite("accelerator","./sprites/accelerator.png");s_oSpriteLibrary.addSprite("breacker","./sprites/breacker.png");s_oSpriteLibrary.addSprite("wheel","./sprites/wheel.png");s_oSpriteLibrary.addSprite("but_fullscreen","./sprites/but_fullscreen.png");s_oSpriteLibrary.addSprite("but_credits","./sprites/but_credits.png");
s_oSpriteLibrary.addSprite("logo_ctl","./sprites/logo_ctl.png");s_oSpriteLibrary.addSprite("but_no","./sprites/but_no.png");s_oSpriteLibrary.addSprite("but_yes","./sprites/but_yes.png");for(var g=0;g<NUM_LEVELS;g++)s_oSpriteLibrary.addSprite("bg_game"+g,"./sprites/levels/level"+g+"/bg_game.jpg"),s_oSpriteLibrary.addSprite("fg_game"+g,"./sprites/levels/level"+g+"/fg_game.png"),s_oSpriteLibrary.addSprite("lights"+g,"./sprites/levels/level"+g+"/lights.png");for(g=1;g<=NUM_CARS;g++)s_oSpriteLibrary.addSprite("car_"+
g,"./sprites/cars/car"+g+"_mc.png");for(g=1;g<=NUM_CONTAINERS;g++)s_oSpriteLibrary.addSprite("container"+g,"./sprites/container/container"+g+".png");for(g=1;4>=g;g++)s_oSpriteLibrary.addSprite("bar"+g,"./sprites/bar/bar"+g+".png");for(g=1;3>=g;g++)s_oSpriteLibrary.addSprite("divider"+g,"./sprites/divider/divider"+g+".png");for(g=1;3>g;g++)s_oSpriteLibrary.addSprite("flowers"+g,"./sprites/flowers/flowers"+g+".png");for(g=1;3>=g;g++)s_oSpriteLibrary.addSprite("garbage_bin"+g,"./sprites/garbage_bin/garbage_bin"+
g+".png");for(g=1;5>=g;g++)s_oSpriteLibrary.addSprite("house"+g,"./sprites/house/house"+g+".png");for(g=1;3>g;g++)s_oSpriteLibrary.addSprite("box"+g,"./sprites/box/box"+g+".png");for(g=1;4>=g;g++)s_oSpriteLibrary.addSprite("select_car_"+g,"./sprites/select_car/select_car_"+g+".png");for(g=1;6>=g;g++)s_oSpriteLibrary.addSprite("sidewalk_"+g,"./sprites/sidewalk/sidewalk_"+g+".png");for(g=1;2>=g;g++)s_oSpriteLibrary.addSprite("trash"+g,"./sprites/trash/trash"+g+".png");for(g=1;4>=g;g++)s_oSpriteLibrary.addSprite("drop_area_"+
g,"./sprites/drop_area/drop_area_"+g+".png");s_oSpriteLibrary.addSprite("rear_light","./sprites/rear_light.png");s_oSpriteLibrary.addSprite("healt","./sprites/healt.png");s_oSpriteLibrary.addSprite("energy_bar","./sprites/energy_bar.png");s_oSpriteLibrary.addSprite("arrow_keys","./sprites/arrow_keys.png");s_oSpriteLibrary.addSprite("help_touch","./sprites/help_touch.png");s_oSpriteLibrary.addSprite("but_exit","./sprites/but_exit.png");s_oSpriteLibrary.addSprite("audio_icon","./sprites/audio_icon.png");
s_oSpriteLibrary.addSprite("time","./sprites/time.png");s_oSpriteLibrary.addSprite("level_sprite","./sprites/level_sprite.png");s_oSpriteLibrary.addSprite("but_continue","./sprites/but_continue.png");e+=s_oSpriteLibrary.getNumSprites();s_oSpriteLibrary.loadSprites()};this._onImagesLoaded=function(){b++;m.refreshLoader(Math.floor(b/e*100))};this._onAllImagesLoaded=function(){};this._onRemovePreloader=function(){m.unload();try{saveItem("ls_available","ok")}catch(g){s_bStorageAvailable=!1}s_oSoundtrack=
playSound("soundtrack",1,!0);this.gotoMenu()};this.gotoMenu=function(){new CMenu;d=STATE_MENU};this.gotoLevelMenu=function(){new CLevelMenu;d=STATE_MENU};this.gotoGame=function(g){h=new CGame(l,g);d=STATE_GAME;$(s_oMain).trigger("game_start")};this.gotoHelp=function(){new CHelp;d=STATE_HELP};this.resetArrayScores=function(){s_aScores=[];for(var g=0;g<NUM_LEVELS;g++)s_aScores[g]=0};this.stopUpdate=function(){c=!1;createjs.Ticker.paused=!0;$("#block_game").css("display","block");!1!==DISABLE_SOUND_MOBILE&&
!1!==s_bMobile||Howler.mute(!0)};this.startUpdate=function(){s_iPrevTime=(new Date).getTime();c=!0;createjs.Ticker.paused=!1;$("#block_game").css("display","none");(!1===DISABLE_SOUND_MOBILE||!1===s_bMobile)&&s_bAudioActive&&Howler.mute(!1)};this._update=function(g){if(!1!==c){var p=(new Date).getTime();s_iTimeElaps=p-s_iPrevTime;s_iCntTime+=s_iTimeElaps;s_iCntFps++;s_iPrevTime=p;1E3<=s_iCntTime&&(s_iCurFps=s_iCntFps,s_iCntTime-=1E3,s_iCntFps=0);d===STATE_GAME&&h.update();s_oStage.update(g)}};s_oMain=
this;var l=a;ENABLE_FULLSCREEN=a.fullscreen;ENABLE_CHECK_ORIENTATION=a.check_orientation;s_bAudioActive=a.audio_enable_on_startup;this.initContainer()}var s_bMobile,s_bTablet,s_bAudioActive=!1,s_iCntTime=0,s_iTimeElaps=0,s_iPrevTime=0,s_iCntFps=0,s_iCurFps=0,s_oDrawLayer,s_oStage,s_oMain,s_oSpriteLibrary,s_oSoundtrack=null,s_oCanvas,s_bFullscreen=s_bIsIphone=!1,s_iLastLevel=1,s_aScores=[],s_bStorageAvailable=!0,s_aSounds,s_aSoundsInfo;
function CTextButton(a,c,b,e,d,m,h,l){var g,p,r,f,n,v,u;this._init=function(z,E,B,K,q,H,J){g=[];p=[];var D=createBitmap(B),F=Math.ceil(J/20);u=new createjs.Text(K,J+"px "+q,"#fff");u.textAlign="center";u.textBaseline="alphabetic";var w=u.getBounds();u.x=B.width/2+F;u.y=Math.floor(B.height/2)+w.height/3+F;v=new createjs.Text(K,J+"px "+q,H);v.textAlign="center";v.textBaseline="alphabetic";w=v.getBounds();v.x=B.width/2;v.y=Math.floor(B.height/2)+w.height/3;n=new createjs.Container;n.x=z;n.y=E;n.regX=
B.width/2;n.regY=B.height/2;s_bMobile||(n.cursor="pointer");n.addChild(D,u,v);l.addChild(n);this._initListener()};this.unload=function(){n.off("mousedown",r);n.off("pressup",f);l.removeChild(n)};this.setVisible=function(z){n.visible=z};this._initListener=function(){r=n.on("mousedown",this.buttonDown);f=n.on("pressup",this.buttonRelease)};this.addEventListener=function(z,E,B){g[z]=E;p[z]=B};this.buttonRelease=function(){n.scaleX=1;n.scaleY=1;playSound("but_press",1,!1);g[ON_MOUSE_UP]&&g[ON_MOUSE_UP].call(p[ON_MOUSE_UP])};
this.buttonDown=function(){n.scaleX=.9;n.scaleY=.9;g[ON_MOUSE_DOWN]&&g[ON_MOUSE_DOWN].call(p[ON_MOUSE_DOWN])};this.setTextPosition=function(z){v.y=z;u.y=z+2};this.setPosition=function(z,E){n.x=z;n.y=E};this.setX=function(z){n.x=z};this.setY=function(z){n.y=z};this.getButtonImage=function(){return n};this.getX=function(){return n.x};this.getY=function(){return n.y};this._init(a,c,b,e,d,m,h);return this}
function CToggle(a,c,b,e,d){var m=!0,h,l,g,p=[],r,f,n,v=1;this._init=function(u,z,E,B){l=[];g=[];var K=new createjs.SpriteSheet({images:[E],frames:{width:E.width/2,height:E.height,regX:E.width/2/2,regY:E.height/2},animations:{state_true:[0],state_false:[1]}});h=B;n=createSprite(K,"state_"+h,E.width/2/2,E.height/2,E.width/2,E.height);n.x=u;n.y=z;n.stop();s_bMobile||(n.cursor="pointer");d.addChild(n);this._initListener()};this.unload=function(){n.off("mousedown",r);n.off("pressup",f);d.removeChild(n)};
this._initListener=function(){r=n.on("mousedown",this.buttonDown);f=n.on("pressup",this.buttonRelease)};this.addEventListener=function(u,z,E){l[u]=z;g[u]=E};this.addEventListenerWithParams=function(u,z,E,B){l[u]=z;g[u]=E;p=B};this.setActive=function(u){h=u;n.gotoAndStop("state_"+h)};this.setClickable=function(u){m=u};this.setScale=function(u){v=u;n.scaleX=v;n.scaleY=v};this.buttonRelease=function(){m&&(n.scaleX=v,n.scaleY=v,playSound("but_press",1,!1),h=!h,n.gotoAndStop("state_"+h),l[ON_MOUSE_UP]&&
l[ON_MOUSE_UP].call(g[ON_MOUSE_UP],p))};this.buttonDown=function(){m&&(n.scaleX=v-.1,n.scaleY=v-.1,l[ON_MOUSE_DOWN]&&l[ON_MOUSE_DOWN].call(g[ON_MOUSE_DOWN],p))};this.setPosition=function(u,z){n.x=u;n.y=z};this.setVisible=function(u){n.visible=u};this._init(a,c,b,e)}
function CGfxButton(a,c,b,e){var d,m,h,l,g=[],p,r,f;this._init=function(u,z,E){m=d=1;h=[];l=[];f=createBitmap(E);f.x=u;f.y=z;f.regX=E.width/2;f.regY=E.height/2;s_bMobile||(f.cursor="pointer");v.addChild(f);this._initListener()};this.unload=function(){f.off("mousedown",p);f.off("pressup",r);v.removeChild(f)};this.setVisible=function(u){f.visible=u};this._initListener=function(){p=f.on("mousedown",this.buttonDown);r=f.on("pressup",this.buttonRelease)};this.addEventListener=function(u,z,E){h[u]=z;l[u]=
E};this.addEventListenerWithParams=function(u,z,E,B){h[u]=z;l[u]=E;g=B};this.pulseAnimation=function(){createjs.Tween.get(f).to({scaleX:.9*d,scaleY:.9*m},850,createjs.Ease.quadOut).to({scaleX:d,scaleY:m},650,createjs.Ease.quadIn).call(function(){n.pulseAnimation()})};this.buttonRelease=function(){f.scaleX=0<d?1:-1;f.scaleY=1;playSound("but_press",1,!1);h[ON_MOUSE_UP]&&h[ON_MOUSE_UP].call(l[ON_MOUSE_UP],g)};this.buttonDown=function(){f.scaleX=0<d?.9:-.9;f.scaleY=.9;h[ON_MOUSE_DOWN]&&h[ON_MOUSE_DOWN].call(l[ON_MOUSE_DOWN],
g)};this.setScale=function(u){f.scaleX=u;f.scaleY=u};this.setPosition=function(u,z){f.x=u;f.y=z};this.setX=function(u){f.x=u};this.setY=function(u){f.y=u};this.getButtonImage=function(){return f};this.getX=function(){return f.x};this.getY=function(){return f.y};var n=this;var v=e;this._init(a,c,b);return this}
function CMenu(){var a,c,b,e,d,m,h,l,g,p,r,f,n,v,u=null,z=null,E=null;this._init=function(){h=createBitmap(s_oSpriteLibrary.getSprite("bg_menu"));s_oStage.addChild(h);l=createBitmap(s_oSpriteLibrary.getSprite("logo"));l.x=CANVAS_WIDTH/2-350;l.y=40;s_oStage.addChild(l);var B=s_oSpriteLibrary.getSprite("but_play");g=new CGfxButton(CANVAS_WIDTH/2+220,CANVAS_HEIGHT/2+80,B,s_oStage);g.addEventListener(ON_MOUSE_UP,this._onButPlayRelease,this);null!==getItem("park_your_car_level_reached")?(s_iLastLevel=
getItem("park_your_car_level_reached"),s_aScores=JSON.parse(getItem("Scores")),g.setPosition(CANVAS_WIDTH/2-200,CANVAS_HEIGHT-80),B=s_oSpriteLibrary.getSprite("but_continue"),p=new CGfxButton(CANVAS_WIDTH/2+200,CANVAS_HEIGHT-80,B,s_oStage),p.addEventListener(ON_MOUSE_UP,this._onButContinueRelease,this),p.pulseAnimation()):(g.setPosition(CANVAS_WIDTH/2,CANVAS_HEIGHT-80),g.pulseAnimation(),s_oMain.resetArrayScores());if(!1===DISABLE_SOUND_MOBILE||!1===s_bMobile)B=s_oSpriteLibrary.getSprite("audio_icon"),
d=CANVAS_WIDTH-B.height/2-10,m=B.height/2+10,f=new CToggle(d,m,B,s_bAudioActive,s_oStage),f.addEventListener(ON_MOUSE_UP,this._onAudioToggle,this);B=s_oSpriteLibrary.getSprite("but_credits");b=B.height/2+10;e=B.height/2+10;n=new CGfxButton(b,e,B,s_oStage);n.addEventListener(ON_MOUSE_UP,this._onButInfoRelease,this);B=window.document;var K=B.documentElement;u=K.requestFullscreen||K.mozRequestFullScreen||K.webkitRequestFullScreen||K.msRequestFullscreen;z=B.exitFullscreen||B.mozCancelFullScreen||B.webkitExitFullscreen||
B.msExitFullscreen;!1===ENABLE_FULLSCREEN&&(u=!1);u&&screenfull.isEnabled&&(B=s_oSpriteLibrary.getSprite("but_fullscreen"),a=b+B.width/2-10,c=B.height/2+10,v=new CToggle(a,c,B,s_bFullscreen,s_oStage),v.addEventListener(ON_MOUSE_UP,this._onFullscreenRelease,this));r=new createjs.Shape;r.graphics.beginFill("black").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);s_oStage.addChild(r);createjs.Tween.get(r).to({alpha:0},1E3).call(function(){r.visible=!1});s_bStorageAvailable||new CMsgBox(TEXT_ERR_LS,s_oStage);
this.refreshButtonPos(s_iOffsetX,s_iOffsetY)};this.unload=function(){g.unload();g=null;r.visible=!1;if(!1===DISABLE_SOUND_MOBILE||!1===s_bMobile)f.unload(),f=null;u&&screenfull.isEnabled&&v.unload();n.unload();s_oStage.removeAllChildren();s_oMenu=null};this.refreshButtonPos=function(B,K){!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||f.setPosition(d-B,K+m);u&&screenfull.isEnabled&&v.setPosition(a+B,c+K);n.setPosition(b+B,e+K)};this._onAudioToggle=function(){Howler.mute(s_bAudioActive);s_bAudioActive=
!s_bAudioActive};this._onButPlayRelease=function(){null===getItem("park_your_car_level_reached")?(this.unload(),s_oMain.resetArrayScores(),s_oMain.gotoLevelMenu(),$(s_oMain).trigger("start_session")):null===E&&(E=new CConfirmPanel(TEXT_RESET,0),E.addEventListener(ON_BUT_NO_DOWN,this._onButNo,this),E.addEventListener(ON_BUT_YES_DOWN,this._onButYes,this))};this._onButContinueRelease=function(){this.unload();s_oMain.gotoLevelMenu()};this._onButInfoRelease=function(){new CCreditsPanel};this.resetFullscreenBut=
function(){u&&screenfull.isEnabled&&v.setActive(s_bFullscreen)};this._onFullscreenRelease=function(){s_bFullscreen?z.call(window.document):u.call(window.document.documentElement);sizeHandler()};this._onButNo=function(){E.unload();E=null};this._onButYes=function(){clearAllItem();this.unload();s_iLastLevel=1;s_oMain.resetArrayScores();s_oMain.gotoLevelMenu()};s_oMenu=this;this._init()}var s_oMenu=null;
function CGame(a,c){function b(w){w||(w=window.event);if(!0===n){if(w.keyCode===LEFT_DIR)return p.moveLeft(!0),w.preventDefault(),!1;if(w.keyCode===UP_DIR)return p.moveUp(!0),w.preventDefault(),!1;if(w.keyCode===RIGHT_DIR)return p.moveRight(!0),w.preventDefault(),!1;if(w.keyCode===DOWN_DIR)return p.moveDown(!0),w.preventDefault(),!1;if(w.keyCode===SPACEBAR)return w.preventDefault(),!1}}function e(w){w||(w=window.event);if(!0===n){if(w.keyCode===LEFT_DIR)return p.moveLeft(!1),w.preventDefault(),!1;
if(w.keyCode===UP_DIR)return p.moveUp(!1),w.preventDefault(),!1;if(w.keyCode===RIGHT_DIR)return p.moveRight(!1),w.preventDefault(),!1;if(w.keyCode===DOWN_DIR)return p.moveDown(!1),w.preventDefault(),!1;if(w.keyCode===SPACEBAR)return w.preventDefault(),!1}}var d=c,m=0,h=0,l=0,g,p,r,f,n=!1,v=!1,u,z=[],E=[],B=[],K=[],q,H,J,D=null,F=null;this._init=function(){g=LEVEL_TIME;for(var w=0;w<d;w++)h+=s_aScores[w];F=new createjs.Shape;s_oStage.addChild(F);F.x=0;F.y=0;F.graphics.beginBitmapFill(s_oSpriteLibrary.getSprite("asphalt"),
"repeat").drawRect(0,0,canvas.width,canvas.height);$(s_oMain).trigger("start_level",d);w=createBitmap(s_oSpriteLibrary.getSprite("bg_game"+d));w.x=330;w.y=40;s_oStage.addChild(w);q=new CLevelSettings;u=q.getLevelObjects(d);this._placeDropArea();for(w=0;w<u.length;w++){z.push();var A=s_oSpriteLibrary.getSprite(u[w].mc),L=createBitmap(A);L.x=u[w].x+A.width/2;L.y=u[w].y+A.height/2;L.regX=A.width/2;L.regY=A.height/2;u[w].visible&&s_oStage.addChild(L);A=new CCollisionRectangle(A,L.x,L.y,A.width/2,A.height/
2,0);B.push(A.getBox());K.push(A.prepareVector(B[B.length-1]))}this._placeCars();w=createBitmap(s_oSpriteLibrary.getSprite("fg_game"+d));w.x=275;w.y=-20;s_oStage.addChild(w);w=createBitmap(s_oSpriteLibrary.getSprite("lights"+d));w.x=300;w.y=15;s_oStage.addChild(w);J=new CInterface;J.refreshScore(h);s_bMobile?J.spawnGraphicControl():(document.onkeydown=b,document.onkeyup=e);v=n=!0;w=s_oSpriteLibrary.getSprite("baloon_mc");H=createBitmap(w);H.regX=w.width/2;H.regY=w.height/2;H.visible=!1;s_oStage.addChild(H)};
this._placeDropArea=function(){f=q.getDropArea(d);var w=s_oSpriteLibrary.getSprite("drop_area_"+f.mc);w.x=f.x;w.y=f.y;w=new createjs.SpriteSheet({images:[w],framerate:30,frames:{width:f.width,height:f.height,regX:0,regY:0},animations:{idle:[0,39,"idle"]}});r=createSprite(w,"idle",0,0,f.width,f.height);r.x=f.x;r.y=f.y;s_oStage.addChild(r)};this._placeCars=function(){E=[];var w=q.getCarInfos(d);if(null!==w)for(var A=0;A<w.length;A++){var L=new CCar(w[A].type,!1);var ba=q.getCarX(d,A);var Y=q.getCarY(d,
A);L.initInfo(ba,Y,w[A].rot,!1);E.push(L.getBitmap());B.push(L.getRectangle());K.push(L.getVector(B[B.length-1]))}w=q.getMyCarInfos(d);L=new CCar(w.type,!0);ba=q.getMyCarX(d);Y=q.getMyCarY(d);L.initInfo(ba,Y,w.rot);this.carSelected(L);L.getBitmap()};this.carSelected=function(w){playSound("select_car",1,!1);p=w;p.select()};this.checkDropArea=function(){p.check(r)};this.carParked=function(){playSound("car_parked",1,!1);0<g&&(l+=Math.floor(g/1E3));var w=Math.ceil(l+m/10);s_aScores[c]=w;c++;s_iLastLevel=
c+1;h+=w;v=!1;saveItem("park_your_car_level_reached",s_iLastLevel);saveItem("Scores",JSON.stringify(s_aScores));d<q.getNumLevels()-1?(D=CEndPanel(s_oSpriteLibrary.getSprite("msg_box")),D.show(l,h,p,r,f.mc)):(D=CEndPanel(s_oSpriteLibrary.getSprite("msg_box")),D.endGame(l,h,p,r,f.mc))};this.gameOver=function(){v=!1;D=CEndPanel(s_oSpriteLibrary.getSprite("msg_box"));D.gameOver(h,p)};this.onLeftSteeringWheelDown=function(){p.moveLeft(!0)};this.onLeftSteeringWheelUp=function(){p.moveLeft(!1)};this.onRightSteeringWheelDown=
function(){p.moveRight(!0)};this.onRightSteeringWheelUp=function(){p.moveRight(!1)};this.onAcceleratorPress=function(){p.isCrashing()||p.moveUp(!0)};this.onAcceleratorRelease=function(){p.moveUp(!1)};this.onReversePress=function(){p.isCrashing()||p.moveDown(!0)};this.onReverseRelease=function(){p.moveDown(!1)};this.unload=function(){B=[];E=[];u=[];K=[];J.unload();createjs.Tween.removeAllTweens();s_oStage.removeAllChildren()};this.onExit=function(){this.unload();setVolume("soundtrack",1);s_oMain.gotoMenu();
var w=q.getNumLevels();d<w&&$(s_oMain).trigger("end_level",d);$(s_oMain).trigger("show_interlevel_ad");$(s_oMain).trigger("end_session")};this.onRestart=function(){this.unload();$(s_oMain).trigger("restart_level",d);$(s_oMain).trigger("show_interlevel_ad");$(s_oMain).trigger("end_level",d);s_oMain.gotoGame(d)};this.onNextLevel=function(){this.unload();$(s_oMain).trigger("end_level",d);s_oMain.gotoGame(d+1);$(s_oMain).trigger("show_interlevel_ad")};this.setCanMoveTrue=function(){n=!0};this.update=
function(){if(v&&(p.update(),g-=s_iTimeElaps,0<g&&J.refreshTime(formatTime(g)),0<B.length&&!H.visible))for(var w=0;w<B.length;w++)if(!p.checkCollision(B[w],K[w])){n=!1;p.moveLeft(!1);p.moveUp(!1);p.moveRight(!1);p.moveDown(!1);H.visible=!0;H.x=p.getX();H.y=p.getY();playSound("crash",1,!1);createjs.Tween.get(H).to({x:H.x+Math.round(10*Math.random()),y:H.y+Math.round(30*Math.random())},50).call(function(){createjs.Tween.get(H).to({x:H.x+Math.round(8*Math.random()),y:H.y+-Math.round(24*Math.random())},
50).call(function(){createjs.Tween.get(H).to({x:H.x+Math.round(6*Math.random()),y:H.y+Math.round(18*Math.random())},50).call(function(){createjs.Tween.get(H).to({x:H.x+Math.round(4*Math.random()),y:H.y+-Math.round(12*Math.random())},50).call(function(){createjs.Tween.get(H).to({y:H.y,x:H.x},150).call(function(){H.visible=!1})})})})});var A=p.getEnergyPercLost();J.refreshMask(A);m=p.getEnergy();0>=m&&this.gameOver()}};s_oGame=this;LEVEL_TIME=a.level_time;MIN_SPEED_OFFSET=a.min_speed_offset;_oParent=
this;this._init()}var s_oGame;
function CInterface(){var a,c,b,e,d,m,h,l,g,p,r,f,n=100,v,u,z,E=null,B,K,q,H,J,D,F,w=CANVAS_HEIGHT-146,A=CANVAS_HEIGHT-70,L,ba,Y,U,W=CANVAS_WIDTH/2-265,Q,R,V=CANVAS_WIDTH/2-205,P,T,k=CANVAS_WIDTH/2,G=CANVAS_HEIGHT-10,X,O=null,I=null;this._init=function(){var t,x=s_oSpriteLibrary.getSprite("but_exit");r=CANVAS_WIDTH-x.height/2-10;f=x.height/2+10;u=new CGfxButton(r,f,x,s_oStage);u.addEventListener(ON_MOUSE_UP,this._onExit,this);g=t=CANVAS_WIDTH-x.width/2-70;p=x.height/2+10;!1===DISABLE_SOUND_MOBILE||
!1===s_bMobile?(x=s_oSpriteLibrary.getSprite("audio_icon"),v=new CToggle(g,p,x,s_bAudioActive,s_oStage),v.addEventListener(ON_MOUSE_UP,this._onAudioToggle,this),d=g-x.width/2+10,m=p):(d=t,m=x.height/2+10);t=window.document;var C=t.documentElement;O=C.requestFullscreen||C.mozRequestFullScreen||C.webkitRequestFullScreen||C.msRequestFullscreen;I=t.exitFullscreen||t.mozCancelFullScreen||t.webkitExitFullscreen||t.msExitFullscreen;!1===ENABLE_FULLSCREEN&&(O=!1);O&&screenfull.isEnabled&&(x=s_oSpriteLibrary.getSprite("but_fullscreen"),
X=new CToggle(d,m,x,s_bFullscreen,s_oStage),X.addEventListener(ON_MOUSE_UP,this._onFullscreenRelease,this));h=40;l=x.height/2+10;x=s_oSpriteLibrary.getSprite("but_restart");z=new CGfxButton(h,l,x,s_oStage);z.addEventListener(ON_MOUSE_UP,this._onRestart,this);T=new createjs.Text("SCORE: 0","40px "+FONT,"#600101");T.x=k;T.y=G;T.textAlign="center";T.textBaseline="alphabetic";T.outline=4;s_oStage.addChild(T);P=new createjs.Text("SCORE: 0","40px "+FONT,"#ffffff");P.x=k;P.y=G;P.textAlign="center";P.textBaseline=
"alphabetic";s_oStage.addChild(P);R=new createjs.Text("00:00","40px "+FONT,"#600101");R.x=V;R.y=50;R.textAlign="left";R.textBaseline="alphabetic";R.outline=4;s_oStage.addChild(R);Q=new createjs.Text("00:00","40px "+FONT,"#ffffff");Q.x=V;Q.y=50;Q.textAlign="left";Q.textBaseline="alphabetic";s_oStage.addChild(Q);U=createBitmap(s_oSpriteLibrary.getSprite("time"));U.x=W;U.y=5;s_oStage.addChild(U);x=s_oSpriteLibrary.getSprite("energy_bar");F=createBitmap(x);F.x=260;F.y=A;F.regY=x.height;s_oStage.addChild(F);
x=s_oSpriteLibrary.getSprite("healt");D=createBitmap(x);ba=x.width-6;Y=x.height;D.x=264;D.y=w;D.regY=x.height;D.alpha=.9;s_oStage.addChild(D);L=new createjs.Shape;L.graphics.beginFill("rgba(255,255,255,0.01)").drawRect(D.x+3,D.y,ba,-Y+3);L.regY=D.regY-Y;s_oStage.addChild(L);D.mask=L;this.refreshButtonPos(s_iOffsetX,s_iOffsetY)};this.refreshTime=function(t){R.text=t;Q.text=t};this.refreshScore=function(t){T.text="SCORE: "+t;P.text="SCORE: "+t};this.spawnGraphicControl=function(){q={x:125,y:450};K=
new CSteeringWheel(q,s_oStage);b=CANVAS_WIDTH-50;e=450;var t=s_oSpriteLibrary.getSprite("accelerator");H=new CToggle(b,e,t,!0,s_oStage);H.addEventListener(ON_MOUSE_DOWN,this._onAcceleratorPress,this);H.addEventListener(ON_MOUSE_UP,this._onAcceleratorRelease,this);a=CANVAS_WIDTH-175;c=450;t=s_oSpriteLibrary.getSprite("breacker");J=new CToggle(a,c,t,!0,s_oStage);J.addEventListener(ON_MOUSE_DOWN,this._onReversePress,this);J.addEventListener(ON_MOUSE_UP,this._onReverseRelease,this);B=!0;s_bTablet&&(K.setScale(.9),
b=CANVAS_WIDTH-55,e=470,H.setPosition(b,e),H.setScale(.7),a=CANVAS_WIDTH-115,c=470,J.setPosition(a,c),J.setScale(.7));this.refreshButtonPos(s_iOffsetX,s_iOffsetY)};this._onReversePress=function(){s_oGame.onReversePress();J.setActive(!1)};this._onReverseRelease=function(){s_oGame.onReverseRelease();J.setActive(!0)};this._onAcceleratorPress=function(){s_oGame.onAcceleratorPress();H.setActive(!1)};this._onAcceleratorRelease=function(){s_oGame.onAcceleratorRelease();H.setActive(!0)};this.unload=function(){if(!1===
DISABLE_SOUND_MOBILE||!1===s_bMobile)v.unload(),v=null;O&&screenfull.isEnabled&&X.unload();u.unload();z.unload();null!==E&&E.unload();s_oInterface=null};this.refreshMask=function(t){n=t;L.graphics.clear();t=Math.floor(n*Y/100);L.graphics.beginFill("rgba(255,255,255,0.01)").drawRect(D.x+3,D.y,ba,-t+3)};this.refreshButtonPos=function(t,x){u.setPosition(r-t,x+f);!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||v.setPosition(g-t,x+p);O&&screenfull.isEnabled&&X.setPosition(d-t,m+x);z.setPosition(h+t,x+l);336>
264+t?(D.x=264+t,F.x=260+t):(D.x=336,F.x=332);this.refreshMask(n);B&&(K.setPosition(q.x+t,q.y),H.setPosition(b-t,e),J.setPosition(a-t,c))};this._onButHelpRelease=function(){E=new CHelpPanel};this.onExitFromHelp=function(){E.unload()};this._onAudioToggle=function(){Howler.mute(s_bAudioActive);s_bAudioActive=!s_bAudioActive};this._onExit=function(){s_oGame.onExit()};this._onRestart=function(){s_oGame.onRestart()};this.resetFullscreenBut=function(){O&&screenfull.isEnabled&&X.setActive(s_bFullscreen)};
this._onFullscreenRelease=function(){s_bFullscreen?I.call(window.document):O.call(window.document.documentElement);sizeHandler()};s_oInterface=this;this._init();return this}var s_oInterface=null;
function CEndPanel(a){var c,b,e,d,m,h,l;this._init=function(g){b=new createjs.Container;b.alpha=0;b.visible=!1;s_oStage.addChild(b);c=createBitmap(g);b.addChild(c);m=new CTLText(b,CANVAS_WIDTH/2-270,CANVAS_HEIGHT/2+30,540,60,50,"center","#600101",FONT,1,0,0," ",!0,!0,!1,!1);m.setOutline(4);d=new CTLText(b,CANVAS_WIDTH/2-270,CANVAS_HEIGHT/2+30,540,60,50,"center","#fff",FONT,1,0,0," ",!0,!0,!1,!1);l=new CTLText(b,CANVAS_WIDTH/2-270,CANVAS_HEIGHT/2+100,540,60,50,"center","#600101",FONT,1,0,0," ",!0,
!0,!1,!1);l.setOutline(4);h=new CTLText(b,CANVAS_WIDTH/2-270,CANVAS_HEIGHT/2+100,540,60,50,"center","#fff",FONT,1,0,0," ",!0,!0,!1,!1)};this._initListener=function(){b.on("mousedown",this._onExit)};this._initListenerEnd=function(){b.on("mousedown",this._onEndGame)};this.show=function(g,p,r,f,n){playSound("arrival_win",1,!1);setVolume("soundtrack",SOUNDTRACK_VOLUME_IN_GAME);e=new CTLText(b,CANVAS_WIDTH/2-270,CANVAS_HEIGHT/2-160,540,60,50,"center","#600101",FONT,1,0,0,TEXT_NEXT_LEVEL,!0,!0,!1,!1);e.setOutline(4);
new CTLText(b,CANVAS_WIDTH/2-270,CANVAS_HEIGHT/2-160,540,60,50,"center","#fff",FONT,1,0,0,TEXT_NEXT_LEVEL,!0,!0,!1,!1);var v=Math.abs(f.x-r.getX()),u=Math.abs(f.y-r.getY()),z=0,E=0,B=CANVAS_WIDTH/2,K=CANVAS_HEIGHT/2-60;b.addChild(f);switch(n){case 1:f.x=B-v;f.y=K-u+10;break;case 2:f.x=B-v;f.y=K-u+10;break;case 3:z=-20;E=30;f.x=B-v+z;f.y=K-u+E;break;case 4:f.x=B-v,f.y=K-u}r.seeOnStage(B+z,K+E,b);m.refreshText(TEXT_SCORE+g);d.refreshText(TEXT_SCORE+g);l.refreshText(TEXT_TOTAL_SCORE+p);h.refreshText(TEXT_TOTAL_SCORE+
p);b.visible=!0;var q=this;createjs.Tween.get(b).to({alpha:1},500).call(function(){q._initListener()});$(s_oMain).trigger("share_event",p);$(s_oMain).trigger("save_score",p)};this.endGame=function(g,p,r,f,n){playSound("arrival_win",1,!1);setVolume("soundtrack",SOUNDTRACK_VOLUME_IN_GAME);var v=Math.abs(f.x-r.getX()),u=Math.abs(f.y-r.getY());e=new CTLText(b,CANVAS_WIDTH/2-270,CANVAS_HEIGHT/2-160,540,120,50,"center","#600101",FONT,1,0,0,TEXT_ALL_LEVELS_COMPLETED,!0,!0,!0,!1);e.setOutline(4);new CTLText(b,
CANVAS_WIDTH/2-270,CANVAS_HEIGHT/2-160,540,120,50,"center","#fff",FONT,1,0,0,TEXT_ALL_LEVELS_COMPLETED,!0,!0,!0,!1);v=Math.abs(f.x-r.getX());u=Math.abs(f.y-r.getY());var z=CANVAS_WIDTH/2-30,E=CANVAS_HEIGHT/2;b.addChild(f);switch(n){case 1:f.x=z-v;f.y=E-u+10;break;case 2:f.x=z-v;f.y=E-u+10;break;case 3:f.x=z-v;f.y=E-u;break;case 4:f.x=z-v,f.y=E-u}r.seeOnStage(z,E,b);m.refreshText(TEXT_SCORE+g);d.refreshText(TEXT_SCORE+g);l.refreshText(TEXT_TOTAL_SCORE+p);h.refreshText(TEXT_TOTAL_SCORE+p);b.visible=
!0;var B=this;createjs.Tween.get(b).to({alpha:1},500).call(function(){B._initListenerEnd()});$(s_oMain).trigger("share_event",p);$(s_oMain).trigger("save_score",p)};this.gameOver=function(g,p){playSound("arrival_lose",1,!1);setVolume("soundtrack",SOUNDTRACK_VOLUME_IN_GAME);e=new CTLText(b,CANVAS_WIDTH/2-270,CANVAS_HEIGHT/2-160,540,100,50,"center","#600101",FONT,1,0,0,TEXT_GAME_OVER,!0,!0,!0,!1);e.setOutline(4);new CTLText(b,CANVAS_WIDTH/2-270,CANVAS_HEIGHT/2-160,540,100,50,"center","#fff",FONT,1,
0,0,TEXT_GAME_OVER,!0,!0,!0,!1);var r=CANVAS_WIDTH/2-30,f=CANVAS_HEIGHT/2+20;p.seeOnStageGameOver(r,f,b);var n=s_oSpriteLibrary.getSprite("baloon_mc"),v=createBitmap(s_oSpriteLibrary.getSprite("baloon_mc"));v.x=r+50;v.y=f-50;v.regX=n.width/2;v.regY=n.height/2;b.addChild(v);l.refreshText(TEXT_TOTAL_SCORE+g);h.refreshText(TEXT_TOTAL_SCORE+g);b.visible=!0;var u=this;createjs.Tween.get(b).to({alpha:1},500).call(function(){u._initListenerEnd()});$(s_oMain).trigger("share_event",g);$(s_oMain).trigger("save_score",
g)};this._onExit=function(){b.off("mousedown",this._onExit);s_oStage.removeChild(b);s_oGame.onNextLevel()};this._onEndGame=function(){b.off("mousedown",this._onEndGame);s_oStage.removeChild(b);s_oGame.onExit()};this._init(a);return this}
function CLevelSettings(){var a=[],c=[],b=[],e=[];this._init=function(){this._initLevelObjects();this._initCarInfos();this._initDropAreas()};this._initLevelObjects=function(){b.push([{x:331,y:-175,width:46,height:500,mc:"sidewalk_5",visible:!1},{x:369,y:40,width:656,height:46,mc:"sidewalk_1",visible:!1},{x:984,y:50,width:46,height:500,mc:"sidewalk_3",visible:!1},{x:332,y:493,width:656,height:46,mc:"sidewalk_4",visible:!1},{x:310,y:215,width:146,height:110,mc:"house3",visible:!0},{x:425,y:330,width:20,
height:160,mc:"bar3",visible:!0},{x:750,y:450,width:73,height:44,mc:"garbage_bin1",visible:!0},{x:830,y:450,width:73,height:44,mc:"garbage_bin1",visible:!0}]);b.push([{x:401,y:-175,width:46,height:500,mc:"sidewalk_5",visible:!1},{x:399,y:40,width:656,height:46,mc:"sidewalk_1",visible:!1},{x:984,y:50,width:46,height:500,mc:"sidewalk_3",visible:!1},{x:328,y:493,width:656,height:46,mc:"sidewalk_4",visible:!1},{x:310,y:220,width:146,height:110,mc:"house3",visible:!0},{x:425,y:335,width:20,height:160,
mc:"bar3",visible:!0},{x:750,y:450,width:73,height:44,mc:"garbage_bin1",visible:!0},{x:830,y:450,width:73,height:44,mc:"garbage_bin1",visible:!0},{x:910,y:450,width:73,height:44,mc:"garbage_bin1",visible:!0}]);b.push([{x:330,y:40,width:46,height:500,mc:"sidewalk_5",visible:!1},{x:361,y:40,width:656,height:46,mc:"sidewalk_1",visible:!1},{x:985,y:-180,width:46,height:500,mc:"sidewalk_3",visible:!1},{x:331,y:495,width:656,height:46,mc:"sidewalk_4",visible:!1},{x:883,y:220,width:146,height:110,mc:"house4",
visible:!0},{x:893,y:335,width:20,height:160,mc:"bar3",visible:!0},{x:900,y:175,width:73,height:44,mc:"garbage_bin1",visible:!0},{x:910,y:90,width:32,height:32,mc:"trash1",visible:!0},{x:944,y:90,width:32,height:32,mc:"trash1",visible:!0}]);b.push([{x:825,y:40,width:656,height:46,mc:"sidewalk_1",visible:!1},{x:985,y:40,width:46,height:500,mc:"sidewalk_3",visible:!1},{x:361,y:495,width:656,height:46,mc:"sidewalk_4",visible:!1},{x:330,y:40,width:46,height:500,mc:"sidewalk_5",visible:!1},{x:572,y:40,
width:110,height:146,mc:"house5",visible:!0},{x:685,y:155,width:160,height:20,mc:"bar4",visible:!0},{x:390,y:310,width:44,height:73,mc:"garbage_bin2",visible:!0},{x:590,y:193,width:75,height:34,mc:"flowers1",visible:!0},{x:850,y:90,width:34,height:75,mc:"flowers2",visible:!0},{x:420,y:120,width:34,height:75,mc:"flowers1",visible:!0},{x:535,y:120,width:32,height:32,mc:"trash2",visible:!0},{x:535,y:155,width:32,height:32,mc:"trash2",visible:!0}]);b.push([{x:331,y:40,width:656,height:46,mc:"sidewalk_1",
visible:!1},{x:985,y:40,width:46,height:500,mc:"sidewalk_3",visible:!1},{x:361,y:495,width:656,height:46,mc:"sidewalk_4",visible:!1},{x:330,y:40,width:46,height:500,mc:"sidewalk_2",visible:!1},{x:520,y:318,width:339,height:31,mc:"divider3",visible:!0},{x:885,y:220,width:146,height:110,mc:"house4",visible:!0},{x:890,y:335,width:20,height:160,mc:"bar3",visible:!0},{x:935,y:120,width:44,height:73,mc:"garbage_bin3",visible:!0}]);b.push([{x:588,y:40,width:656,height:46,mc:"sidewalk_1",visible:!1},{x:985,
y:40,width:46,height:500,mc:"sidewalk_3",visible:!1},{x:361,y:495,width:656,height:46,mc:"sidewalk_4",visible:!1},{x:330,y:40,width:46,height:500,mc:"sidewalk_2",visible:!1},{x:543,y:40,width:110,height:146,mc:"house1",visible:!0},{x:380,y:61,width:160,height:20,mc:"bar1",visible:!0},{x:936,y:296,width:44,height:73,mc:"garbage_bin3",visible:!0},{x:570,y:190,width:32,height:32,mc:"trash1",visible:!0},{x:610,y:190,width:32,height:32,mc:"trash1",visible:!0},{x:570,y:285,width:34,height:75,mc:"flowers2",
visible:!0},{x:675,y:170,width:34,height:75,mc:"flowers2",visible:!0},{x:815,y:90,width:34,height:75,mc:"flowers2",visible:!0},{x:815,y:170,width:34,height:75,mc:"flowers2",visible:!0},{x:675,y:415,width:34,height:75,mc:"flowers2",visible:!0},{x:675,y:370,width:75,height:34,mc:"flowers1",visible:!0}]);b.push([{x:351,y:40,width:656,height:46,mc:"sidewalk_1",visible:!1},{x:985,y:40,width:46,height:500,mc:"sidewalk_3",visible:!1},{x:809,y:495,width:656,height:46,mc:"sidewalk_4",visible:!1},{x:-72,y:495,
width:656,height:46,mc:"sidewalk_4",visible:!1},{x:330,y:40,width:46,height:500,mc:"sidewalk_2",visible:!1},{x:750,y:395,width:110,height:146,mc:"house1",visible:!0},{x:580,y:395,width:160,height:20,mc:"bar1",visible:!0},{x:880,y:440,width:73,height:44,mc:"garbage_bin1",visible:!0},{x:510,y:450,width:32,height:32,mc:"trash2",visible:!0},{x:770,y:355,width:75,height:34,mc:"flowers1",visible:!0}]);b.push([{x:350,y:40,width:656,height:46,mc:"sidewalk_1",visible:!1},{x:985,y:40,width:46,height:500,mc:"sidewalk_3",
visible:!1},{x:355,y:495,width:656,height:46,mc:"sidewalk_4",visible:!1},{x:330,y:-303,width:46,height:500,mc:"sidewalk_2",visible:!1},{x:330,y:360,width:46,height:500,mc:"sidewalk_2",visible:!1},{x:375,y:200,width:20,height:160,mc:"bar3",visible:!0},{x:400,y:195,width:75,height:34,mc:"flowers1",visible:!0},{x:825,y:195,width:75,height:34,mc:"flowers1",visible:!0},{x:480,y:197,width:339,height:31,mc:"divider3",visible:!0},{x:480,y:350,width:339,height:31,mc:"divider3",visible:!0}]);b.push([{x:352,
y:3,width:656,height:46,mc:"sidewalk_1",visible:!1},{x:1017,y:3,width:46,height:500,mc:"sidewalk_3",visible:!1},{x:630,y:527,width:656,height:46,mc:"sidewalk_4",visible:!1},{x:-200,y:527,width:656,height:46,mc:"sidewalk_4",visible:!1},{x:-9,y:249,width:46,height:500,mc:"sidewalk_2",visible:!1},{x:460,y:521,width:160,height:20,mc:"bar1",visible:!0}]);b.push([{x:356,y:40,width:656,height:46,mc:"sidewalk_1",visible:!1},{x:995,y:40,width:46,height:500,mc:"sidewalk_3",visible:!1},{x:538,y:510,width:656,
height:46,mc:"sidewalk_4",visible:!1},{x:320,y:40,width:46,height:500,mc:"sidewalk_2",visible:!1},{x:655,y:80,width:172,height:70,mc:"container1",visible:!0},{x:685,y:320,width:172,height:70,mc:"container1",visible:!0},{x:825,y:80,width:172,height:70,mc:"container3",visible:!0},{x:610,y:335,width:70,height:172,mc:"container6",visible:!0},{x:360,y:505,width:160,height:20,mc:"bar4",visible:!0},{x:618,y:273,width:73,height:44,mc:"garbage_bin1",visible:!0},{x:698,y:273,width:73,height:44,mc:"garbage_bin1",
visible:!0}])};this._initCarInfos=function(){a=[];a.push(null);a.push([{x:917,y:151,type:9,rot:25},{x:655,y:154,type:10,rot:25}]);a.push([{x:511,y:155,type:15,rot:-155},{x:576,y:154,type:8,rot:-155},{x:700,y:160,type:9,rot:-155},{x:830,y:160,type:3,rot:-155},{x:788,y:297,type:4,rot:-90}]);a.push([{x:955,y:347,type:5,rot:0},{x:650,y:425,type:7,rot:0},{x:475,y:345,type:2,rot:-90}]);a.push([{x:829,y:134,type:1,rot:0},{x:772,y:133,type:5,rot:0},{x:568,y:131,type:3,rot:0},{x:690,y:285,type:6,rot:-90},
{x:409,y:398,type:4,rot:0}]);a.push([{x:410,y:330,type:12,rot:0},{x:616,y:252,type:10,rot:90},{x:798,y:386,type:2,rot:0},{x:860,y:426,type:13,rot:0},{x:892,y:138,type:14,rot:0}]);a.push([{x:594,y:130,type:2,rot:0},{x:819,y:130,type:9,rot:0},{x:875,y:130,type:5,rot:0},{x:620,y:250,type:12,rot:-90},{x:525,y:376,type:3,rot:0}]);a.push([{x:870,y:277,type:16,rot:0},{x:940,y:435,type:17,rot:56}]);a.push([{x:428,y:122,type:8,rot:180},{x:598,y:120,type:9,rot:-175},{x:708,y:110,type:15,rot:-7.5},{x:827,y:93,
type:1,rot:0},{x:972,y:110,type:12,rot:0},{x:427,y:250,type:10,rot:0},{x:672,y:280,type:13,rot:0},{x:765,y:260,type:2,rot:0},{x:825,y:275,type:11,rot:0},{x:944,y:280,type:16,rot:0},{x:484,y:365,type:5,rot:0},{x:538,y:403,type:17,rot:180},{x:596,y:380,type:4,rot:0},{x:766,y:407,type:3,rot:180},{x:935,y:375,type:7,rot:0}]);a.push([{x:614,y:115,type:7,rot:60},{x:580,y:445,type:6,rot:180},{x:465,y:135,type:12,rot:48}]);c=[];c.push({x:570,y:440,type:2,rot:90});c.push({x:520,y:415,type:1,rot:90});c.push({x:820,
y:422,type:5,rot:-90});c.push({x:743,y:250,type:9,rot:180});c.push({x:815,y:419,type:8,rot:-90});c.push({x:461,y:155,type:8,rot:166});c.push({x:680,y:337,type:10,rot:40});c.push({x:473,y:280,type:15,rot:90});c.push({x:400,y:430,type:14,rot:24});c.push({x:450,y:340,type:18,rot:0})};this._initDropAreas=function(){e=[];e.push({mc:1,width:55,height:133,x:701,y:85});e.push({mc:2,width:124,height:124,x:725,y:87});e.push({mc:2,width:124,height:124,x:708,y:87});e.push({mc:3,width:133,height:55,x:388,y:433});
e.push({mc:1,width:55,height:133,x:632,y:87});e.push({mc:1,width:55,height:133,x:925,y:87});e.push({mc:1,width:55,height:133,x:508,y:87});e.push({mc:3,width:133,height:55,x:408,y:107});e.push({mc:1,width:55,height:133,x:511,y:200});e.push({mc:4,width:203,height:77,x:683,y:423})};this.getCarInfos=function(d){return a[d]};this.getMyCarInfos=function(d){return c[d]};this.getLevelObjects=function(d){return b[d]};this.getDropArea=function(d){return e[d]};this.getCarX=function(d,m){return a[d][m].x};this.getCarY=
function(d,m){return a[d][m].y};this.getMyCarX=function(d){return c[d].x};this.getMyCarY=function(d){return c[d].y};this.getNumLevels=function(d){return c.length};this._init();return this}
function CLevelBut(a,c,b,e,d){var m,h,l,g=[],p=[],r,f;this._init=function(n,v,u,z){h=[];l=[];f=new createjs.Container;f.x=n;f.y=v;s_oStage.addChild(f);n=new createjs.SpriteSheet({images:[u],frames:{width:u.width/2,height:u.height,regX:u.width/2/2,regY:u.height/2},animations:{state_true:[0],state_false:[1]}});m=z;r=createSprite(n,"state_"+m,u.width/2/2,u.height/2,u.width/2,u.height);r.mouseEnabled=z;r.stop();s_bMobile||(f.cursor="pointer");f.addChild(r);g.push(r);u="#79035c";z||(u="#535353");z=new createjs.Text(d,
"40px "+FONT,u);z.y=15;z.textAlign="center";z.textBaseline="alphabetic";z.lineWidth=200;z.outline=4;f.addChild(z);z=new createjs.Text(d,"40px "+FONT,"#ffffff");z.y=15;z.textAlign="center";z.textBaseline="alphabetic";z.lineWidth=200;f.addChild(z);this._initListener()};this.unload=function(){f.off("mousedown",this.buttonDown);f.off("pressup",this.buttonRelease);f.removeChild(r)};this._initListener=function(){f.on("mousedown",this.buttonDown);f.on("pressup",this.buttonRelease)};this.viewBut=function(n){f.addChild(n)};
this.addEventListener=function(n,v,u){h[n]=v;l[n]=u};this.addEventListenerWithParams=function(n,v,u,z){h[n]=v;l[n]=u;p=z};this.ifClickable=function(){return!0===r.mouseEnabled?1:0};this.setActive=function(n,v){m=v;g[n].gotoAndStop("state_"+m);g[n].mouseEnabled=!0};this.buttonRelease=function(){f.scaleX=1;f.scaleY=1;playSound("but_press",1,!1);m=!m;r.gotoAndStop("state_"+m);h[ON_MOUSE_UP]&&h[ON_MOUSE_UP].call(l[ON_MOUSE_UP],p)};this.buttonDown=function(){f.scaleX=.9;f.scaleY=.9;h[ON_MOUSE_DOWN]&&h[ON_MOUSE_DOWN].call(l[ON_MOUSE_DOWN],
p)};this.setPosition=function(n,v){f.x=n;f.y=v};this.setVisible=function(n){f.visible=n};this._init(a,c,b,e)}
function CLevelMenu(){var a,c,b,e,d=[],m,h,l,g,p;this._init=function(){l=createBitmap(s_oSpriteLibrary.getSprite("bg_menu"));s_oStage.addChild(l);m=new CLevelSettings;h=m.getNumLevels();l=createBitmap(s_oSpriteLibrary.getSprite("msg_box"));s_oStage.addChild(l);(new CTLText(s_oStage,CANVAS_WIDTH/2-250,120,500,70,50,"center","#730358",FONT,1,0,0,TEXT_LEVEL,!0,!0,!1,!1)).setOutline(4);new CTLText(s_oStage,CANVAS_WIDTH/2-250,120,500,70,50,"center","#fff",FONT,1,0,0,TEXT_LEVEL,!0,!0,!1,!1);for(var r=CANVAS_WIDTH/
2,f=0,n=50,v=0;v<h;v++,f+=100)400<f&&(f=0,n+=100),v<s_iLastLevel?d.push(new CLevelBut(r-200+f,175+n,s_oSpriteLibrary.getSprite("level_sprite"),!0,v+1)):d.push(new CLevelBut(r-200+f,175+n,s_oSpriteLibrary.getSprite("level_sprite"),!1,v+1)),0===v?d[v].addEventListenerWithParams(ON_MOUSE_UP,this._onClickHelp,this,v):d[v].addEventListenerWithParams(ON_MOUSE_UP,this._onClick,this,v),s_bFirstTime=!0;r=s_oSpriteLibrary.getSprite("but_exit");b=CANVAS_WIDTH-r.height/2-10;e=r.height/2+10;g=new CGfxButton(b,
e,r,s_oStage);g.addEventListener(ON_MOUSE_UP,this._onExit,this);a=CANVAS_WIDTH-r.width/2-70;c=r.height/2+10;if(!1===DISABLE_SOUND_MOBILE||!1===s_bMobile)r=s_oSpriteLibrary.getSprite("audio_icon"),p=new CToggle(a,c,r,s_bAudioActive,s_oStage),p.addEventListener(ON_MOUSE_UP,this._onAudioToggle,this);this.refreshButtonPos(s_iOffsetX,s_iOffsetY)};this.unload=function(){for(var r=0;r<h;r++)d[r].unload();s_oLevelMenu=null;s_oStage.removeAllChildren()};this.refreshButtonPos=function(r,f){g.setPosition(b-
r,f+e);!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||p.setPosition(a-r,f+c)};this._onNumModeToggle=function(r){r===NUM_ACTIVE?((void 0).setActive(!1),(void 0).setActive(!0)):((void 0).setActive(!0),(void 0).setActive(!1))};this._onAudioToggle=function(){Howler.mute(s_bAudioActive);s_bAudioActive=!s_bAudioActive};this._onClick=function(r){d[r].ifClickable()&&(s_oLevelMenu.unload(),s_oMain.gotoGame(r))};this._onClickHelp=function(r){d[r].ifClickable()&&(s_oLevelMenu.unload(),s_oMain.gotoHelp())};this._onExit=
function(){s_oLevelMenu.unload();s_oMain.gotoMenu();$(s_oMain).trigger("end_level");$(s_oMain).trigger("show_interlevel_ad");$(s_oMain).trigger("end_session")};s_oLevelMenu=this;this._init()}var s_oLevelMenu=null;
function CCar(a,c){var b,e=!1,d=!1,m=!1,h=!1,l=!1,g=!1,p=!1,r=!1,f=!1,n=0,v=0,u=0,z=0,E=.95,B=0,K=0,q=0,H=0,J=0,D=0,F=0,w=100,A=0,L=0,ba=0,Y=0,U=0,W,Q,R,V,P,T,k,G,X,O=s_oSpriteLibrary.getSprite("wheel"),I=s_oSpriteLibrary.getSprite("car_"+a),t,x;this.init=function(C,y){G=new createjs.Container;s_oStage.addChild(G);P=createBitmap(s_oSpriteLibrary.getSprite("rear_light"));P.x=I.width/4;P.y=I.height-2;G.addChild(P);T=createBitmap(s_oSpriteLibrary.getSprite("rear_light"));T.x=I.width-I.width/4-2;T.y=
I.height-2;G.addChild(T);P.visible=!1;T.visible=!1;y&&(W=createBitmap(O),W.x=5,W.y=20,W.regX=O.width/2,W.regY=O.height/2,G.addChild(W),Q=createBitmap(O),Q.x=I.width-5,Q.y=20,Q.regX=O.width/2,Q.regY=O.height/2,G.addChild(Q),R=createBitmap(O),R.x=5,R.y=I.height-20,R.regX=O.width/2,R.regY=O.height/2,G.addChild(R),V=createBitmap(O),V.x=I.width-5,V.y=I.height-20,V.regX=O.width/2,V.regY=O.height/2,G.addChild(V));k=createBitmap(I);G.addChild(k);G.regX=I.width/2;G.regY=35;A=w;G.visible=!0;switch(C){case 1:case 7:case 13:this.Car1init();
break;case 2:case 8:case 14:G.addChild(x);this.Car2init();break;case 3:case 9:case 15:this.Car3init();break;case 4:case 10:case 16:this.Car4init();break;case 5:case 11:case 17:this.Car5init();G.regY=40;break;case 6:case 12:case 18:this.Car6init(),G.regY=60,y&&(W.x=6,W.y=22,Q.x=I.width-6,Q.y=22,R.x=6,R.y=I.height-22,V.x=I.width-6,V.y=I.height-22)}G.rotation=F;e=!0};this.check=function(C){var y=G.localToGlobal(W.x,W.y),Z=G.localToGlobal(Q.x,Q.y),S=G.localToGlobal(R.x,R.y),M=G.localToGlobal(V.x,V.y);
y=C.globalToLocal(y.x,y.y);Z=C.globalToLocal(Z.x,Z.y);S=C.globalToLocal(S.x,S.y);M=C.globalToLocal(M.x,M.y);C=C.getBounds();C.contains(y.x,y.y)&&C.contains(Z.x,Z.y)&&C.contains(S.x,S.y)&&C.contains(M.x,M.y)&&(s_oGame.carParked(),r=!0)};this.Car1init=function(){v=28;u=-3;z=.45;K=2;q=.1;H=.98;U=15;L=40};this.Car2init=function(){v=8;u=-3;z=.25;K=2;q=.1;H=.98;U=10;L=40};this.Car3init=function(){v=8;u=-3;z=.25;K=2;q=.1;H=.98;U=10;L=40};this.Car4init=function(){v=28;u=-3;z=.45;K=2;q=.1;H=.98;U=15;L=40};
this.Car5init=function(){v=28;u=-3;z=.45;K=2;q=.1;H=.98;U=15;L=40};this.Car6init=function(){v=8;u=-3;z=.15;K=2;q=.1;H=.98;U=15;L=40};this.unload=function(){this.unload()};this.initInfo=function(C,y,Z){G.x=ba=C;G.y=Y=y;G.rotation=F=Z;X=new CCollisionRectangle(I,G.x,G.y,G.regX,G.regY,G.rotation)};this._reset=function(){g=l=h=m=!1;D=J=B=n=0;E=.95;b=!1};this.resetPos=function(){this._reset();G.x=ba;G.y=Y;G.rotation=F;w=100;A=0};this.select=function(){p=!0;switch(a){case 1:case 7:case 13:case 2:case 8:case 14:case 3:case 9:case 15:t=
s_oSpriteLibrary.getSprite("select_car_1");var C={images:[t],framerate:20,frames:{width:76,height:130,regX:38,regY:50},animations:{idle:[0,19,"idle"]}};C=new createjs.SpriteSheet(C);x=createSprite(C,"idle",0,0,76,130);x.x=G.x;x.y=G.y;s_oStage.addChild(x);break;case 4:case 10:case 16:t=s_oSpriteLibrary.getSprite("select_car_2");C={images:[t],framerate:20,frames:{width:76,height:110,regX:38,regY:48},animations:{idle:[0,19,"idle"]}};C=new createjs.SpriteSheet(C);x=createSprite(C,"idle",0,0,76,110);x.x=
G.x;x.y=G.y;s_oStage.addChild(x);break;case 5:case 11:case 17:t=s_oSpriteLibrary.getSprite("select_car_4");C={images:[t],framerate:20,frames:{width:66,height:130,regX:33,regY:53},animations:{idle:[0,19,"idle"]}};C=new createjs.SpriteSheet(C);x=createSprite(C,"idle",0,0,66,130);x.x=G.x;x.y=G.y;s_oStage.addChild(x);break;case 6:case 12:case 18:t=s_oSpriteLibrary.getSprite("select_car_3"),C={images:[t],framerate:20,frames:{width:89,height:210,regX:44,regY:70},animations:{idle:[0,19,"idle"]}},C=new createjs.SpriteSheet(C),
x=createSprite(C,"idle",0,0,89,210),x.x=G.x,x.y=G.y,s_oStage.addChild(x)}x.rotation=F};this.moveLeft=function(C){C&&(g=!1);l=C};this.getX=function(){return x.x};this.getY=function(){return x.y};this.getRegX=function(){return G.regX};this.getRegY=function(){return G.regY};this.moveRight=function(C){C&&(l=!1);g=C};this.moveUp=function(C){C&&(h=!1);m=C};this.moveDown=function(C){C&&(m=!1);h=C};this.seeOnStage=function(C,y,Z){Z.addChild(k);k.x=C;k.y=y;k.regX=G.regX;k.regY=G.regY;k.rotation=G.rotation;
W.visible=!1;Q.visible=!1;R.visible=!1;V.visible=!1};this.seeOnStageGameOver=function(C,y,Z){Z.addChild(k);k.regX=G.regX;k.regY=G.regY;6===a||12===a||18===a?(k.x=C+60,k.y=y+10,k.rotation=90):(k.x=C,k.y=y,k.rotation=G.rotation);W.visible=!1;Q.visible=!1;R.visible=!1;V.visible=!1};this.getBitmap=function(){return k};this.getSpeed=function(){return n};this.getEnergy=function(){return A};this.isCrashing=function(){return d};this.isDestroying=function(){return b};this.getEnergyPercLost=function(){return A*
w/100};this.isReady=function(){return e};this.getRectangle=function(){return X.getBox()};this.getVector=function(C){return X.prepareVector(C)};this.checkCollision=function(C,y){if(X.refresh(C,y))return!0;d||(A-=U*Math.abs(.5>n?.5:n),d=!0);return!1};this.update=function(){if(null!==T&&p){m&&n<v&&(n+=z,n>v&&(n=v));h&&n>u&&(n-=z,n<u&&(n=u));l&&(B-=q,B>K&&(B=K));g&&(B+=q,B<-K&&(B=-K));n*=E;n>-MIN_SPEED_OFFSET&&n<MIN_SPEED_OFFSET?(n=0,x.visible=!0):x.visible=!1;d&&(f||(n=-n,E-=.2,f=!0),n>-MIN_SPEED_OFFSET&&
n<MIN_SPEED_OFFSET&&(n=0,f=d=!1,E+=.2,s_oGame.setCanMoveTrue()));J=Math.sin(G.rotation*Math.PI/180)*n;D=Math.cos(G.rotation*Math.PI/180)*-n;0===n||-.09<J&&.09>J||(G.x+=J,x.x+=J);0===n||-.09<D&&.09>D||(G.y+=D,x.y+=D);.09>J&&-.09<J&&.09>D&&-.09<D&&!r&&s_oGame.checkDropArea();0>n?(T.visible=!0,P.visible=!0):(T.visible=!1,P.visible=!1);0<B?.05>B&&(B=0):0>B&&-.05<B&&(B=0);B*=H;B-=.1*B;var C=B*n;G.rotation+=C;x.rotation+=C;(0===n||-.09<J&&.09>J)&&(0===n||-.09<D&&.09>D)||(X.move(J,D),X.applySteering(C));
C=L*B;W.rotation=C;Q.rotation=C}};this.init(a,c)}
function CSteeringWheel(a,c){var b,e,d,m,h;this._init=function(){b=a.x;e=a.y;var l=s_oSpriteLibrary.getSprite("steering_wheel");d=createBitmap(l);d.x=b;d.y=e;d.regX=l.width/2;d.regY=l.height/2;c.addChild(d);m=new createjs.Shape;m.graphics.beginFill("#ff0000").drawRect(0,0,100,130);m.x=b-100;m.y=e-65;m.alpha=.01;c.addChild(m);m.on("mousedown",this.onLeftSteeringWheelDown);m.on("pressup",this.onLeftSteeringWheelUp);h=new createjs.Shape;h.graphics.beginFill("#ff00ff").drawRect(0,0,100,130);h.x=b;h.y=
e-65;h.alpha=.01;c.addChild(h);h.on("mousedown",this.onRightSteeringWheelDown);h.on("pressup",this.onRightSteeringWheelUp)};this.setPosition=function(l,g){d.x=l;m.x=l-100;h.x=l};this.setScale=function(l){d.scaleX=l;d.scaleY=l};this.onLeftSteeringWheelDown=function(){createjs.Tween.get(d,{override:!0}).to({rotation:-90},500).call(function(){});s_oGame.onLeftSteeringWheelDown()};this.onLeftSteeringWheelUp=function(){createjs.Tween.get(d,{override:!0}).to({rotation:0},500).call(function(){});s_oGame.onLeftSteeringWheelUp()};
this.onRightSteeringWheelDown=function(){createjs.Tween.get(d,{override:!0}).to({rotation:90},500).call(function(){});s_oGame.onRightSteeringWheelDown()};this.onRightSteeringWheelUp=function(){createjs.Tween.get(d,{override:!0}).to({rotation:0},500).call(function(){});s_oGame.onRightSteeringWheelUp()};this.unload=function(){c.removeChildren(d,m,h);m.off("mousedown",this.onLeftSteeringWheelDown);m.off("pressup",this.onLeftSteeringWheelUp);h.off("mousedown",this.onRightSteeringWheelDown);h.off("pressup",
this.onRightSteeringWheelUp)};this._init()}
function CHelp(){var a=this,c,b,e,d,m,h,l,g,p,r;this._init=function(){c=createBitmap(s_oSpriteLibrary.getSprite("bg_menu"));s_oStage.addChild(c);b=new createjs.Container;b.alpha=0;c=createBitmap(s_oSpriteLibrary.getSprite("msg_box"));s_oStage.addChild(c);if(s_bMobile){var f=new createjs.Text(TEXT_MOVE_MOBILE," 25px "+FONT,"#730358");f.x=CANVAS_WIDTH/2-200;f.y=CANVAS_HEIGHT/2+110;f.textAlign="center";f.textBaseline="alphabetic";f.lineWidth=400;f.outline=3;b.addChild(f);f=new createjs.Text(TEXT_MOVE_MOBILE,
" 25px "+FONT,"#ffffff");f.x=CANVAS_WIDTH/2-200;f.y=CANVAS_HEIGHT/2+110;f.textAlign="center";f.textBaseline="alphabetic";f.lineWidth=400;b.addChild(f);f=s_oSpriteLibrary.getSprite("steering_wheel");d=createBitmap(f);d.x=CANVAS_WIDTH/2-200;d.y=CANVAS_HEIGHT/2-40;d.regX=f.width/2;d.regY=f.height/2;m=createBitmap(s_oSpriteLibrary.getSprite("help_touch"));m.x=CANVAS_WIDTH/2-230;m.y=CANVAS_HEIGHT/2-40;b.addChild(d,m);this.moveCursorRight();f=new createjs.Text(TEXT_MOVE_MOBILE2," 25px "+FONT,"#730358");
f.x=CANVAS_WIDTH/2;f.y=CANVAS_HEIGHT/2+110;f.textAlign="center";f.textBaseline="alphabetic";f.lineWidth=400;f.outline=3;b.addChild(f);f=new createjs.Text(TEXT_MOVE_MOBILE2," 25px "+FONT,"#ffffff");f.x=CANVAS_WIDTH/2;f.y=CANVAS_HEIGHT/2+110;f.textAlign="center";f.textBaseline="alphabetic";f.lineWidth=400;b.addChild(f);f=s_oSpriteLibrary.getSprite("accelerator");l=new CToggle(CANVAS_WIDTH/2,CANVAS_HEIGHT/2-50,f,!0,s_oStage);l.setClickable(!1);g=createBitmap(s_oSpriteLibrary.getSprite("help_touch"));
g.x=CANVAS_WIDTH/2-30;g.y=CANVAS_HEIGHT/2-80;b.addChild(g);this.pressAccelerator();f=new createjs.Text(TEXT_MOVE_MOBILE1," 25px "+FONT,"#730358");f.x=CANVAS_WIDTH/2+200;f.y=CANVAS_HEIGHT/2+100;f.textAlign="center";f.textBaseline="alphabetic";f.lineWidth=400;f.outline=3;b.addChild(f);f=new createjs.Text(TEXT_MOVE_MOBILE1," 25px "+FONT,"#ffffff");f.x=CANVAS_WIDTH/2+200;f.y=CANVAS_HEIGHT/2+100;f.textAlign="center";f.textBaseline="alphabetic";f.lineWidth=400;b.addChild(f);f=s_oSpriteLibrary.getSprite("breacker");
p=new CToggle(CANVAS_WIDTH/2+200,CANVAS_HEIGHT/2-50,f,!0,s_oStage);p.setClickable(!1);r=createBitmap(s_oSpriteLibrary.getSprite("help_touch"));r.x=CANVAS_WIDTH/2+170;r.y=CANVAS_HEIGHT/2-80;b.addChild(r);this.pressReverse()}else e=new CTLText(b,CANVAS_WIDTH/2-250,CANVAS_HEIGHT/2+15,500,100,50,"center","#730358",FONT,1,0,0,TEXT_MOVE_DESKTOP,!0,!0,!0,!1),e.setOutline(3),new CTLText(b,CANVAS_WIDTH/2-250,CANVAS_HEIGHT/2+15,500,100,50,"center","#fff",FONT,1,0,0,TEXT_MOVE_DESKTOP,!0,!0,!0,!1),d=createBitmap(s_oSpriteLibrary.getSprite("arrow_keys")),
d.x=CANVAS_WIDTH/2-100,d.y=CANVAS_HEIGHT/2-130,b.addChild(d);f=s_oSpriteLibrary.getSprite("but_play");h=new CGfxButton(CANVAS_WIDTH/2,CANVAS_HEIGHT/2+180,f,s_oStage,s_oStage);h.setScale(.5);s_oStage.addChild(b);this.show()};this._initListener=function(){h.addEventListener(ON_MOUSE_UP,this._onExit,this)};this.moveCursorRight=function(){var f=this;m.scaleX=1;m.scaleY=1;createjs.Tween.get(d).to({rotation:0},1E3).call(function(){});createjs.Tween.get(m).to({x:CANVAS_WIDTH/2-180},1E3).call(function(){m.scaleX=
.9;m.scaleY=.9;createjs.Tween.get(d).to({rotation:90},1E3).call(function(){f.moveCursorLeft()})})};this.moveCursorLeft=function(){var f=this;m.scaleX=1;m.scaleY=1;createjs.Tween.get(d).to({rotation:0},1E3).call(function(){});createjs.Tween.get(m).to({x:CANVAS_WIDTH/2-270},1E3).call(function(){m.scaleX=.9;m.scaleY=.9;createjs.Tween.get(d).to({rotation:-90},1E3).call(function(){f.moveCursorRight()})})};this.pressAccelerator=function(){var f=this;createjs.Tween.get(g).to({scaleX:.9,scaleY:.9},1E3).call(function(){l.setActive(!1);
setTimeout(function(){f.releaseAccelerator()},1E3)})};this.releaseAccelerator=function(){var f=this;l.setActive(!0);createjs.Tween.get(g).to({scaleX:1,scaleY:1},1E3).call(function(){f.pressAccelerator()})};this.pressReverse=function(){var f=this;createjs.Tween.get(r).to({scaleX:.9,scaleY:.9},1E3).call(function(){p.setActive(!1);setTimeout(function(){f.releaseReverse()},1E3)})};this.releaseReverse=function(){var f=this;p.setActive(!0);createjs.Tween.get(r).to({scaleX:1,scaleY:1},1E3).call(function(){f.pressReverse()})};
this.show=function(){createjs.Tween.get(b).to({alpha:1},500).call(function(){a._initListener()})};this._onExit=function(){a.unload();s_oMain.gotoGame(0)};this.unload=function(){createjs.Tween.removeAllTweens();s_oStage.removeAllChildren()};this._init();return this}
function CCreditsPanel(){var a,c,b,e,d,m,h;this._init=function(){h=new createjs.Container;s_oStage.addChild(h);var l=new createjs.Shape;l.graphics.beginFill("black").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);l.alpha=.5;h.addChild(l);l=s_oSpriteLibrary.getSprite("msg_box");a=createBitmap(l);h.addChild(a);a.x=.5*CANVAS_WIDTH;a.y=.5*CANVAS_HEIGHT;a.regX=.5*l.width;a.regY=.5*l.height;d=new createjs.Shape;d.graphics.beginFill("#0f0f0f").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);d.alpha=.01;d.on("click",
this._onLogoButRelease);s_bMobile||(d.cursor="pointer");h.addChild(d);l=s_oSpriteLibrary.getSprite("but_exit");b=new CGfxButton(970,110,l,h);b.addEventListener(ON_MOUSE_UP,this.unload,this);e=new createjs.Text(TEXT_CREDITS_DEVELOPED,"28px "+FONT,"#600101");e.textAlign="center";e.textBaseline="alphabetic";e.x=CANVAS_WIDTH/2;e.y=220;h.addChild(e);l=s_oSpriteLibrary.getSprite("logo_ctl");c=createBitmap(l);c.regX=l.width/2;c.regY=l.height/2;c.x=CANVAS_WIDTH/2;c.y=280;h.addChild(c);m=new createjs.Text("www.codethislab.com",
"32px "+FONT,"#600101");m.textAlign="center";m.textBaseline="alphabetic";m.x=CANVAS_WIDTH/2;m.y=360;h.addChild(m);this.refreshButtonPos(s_iOffsetX,s_iOffsetY)};this.refreshButtonPos=function(l,g){};this.unload=function(){d.off("click",this._onLogoButRelease);b.unload();b=null;s_oStage.removeChild(h)};this._onLogoButRelease=function(){window.open("http://www.codethislab.com/index.php?&l=en","_blank")};this._init()}
function CConfirmPanel(a){var c=this,b=[],e=[],d=[],m,h,l,g;this._init=function(){var p=s_oSpriteLibrary.getSprite("msg_box");h=new createjs.Container;m=createBitmap(p);m.on("mousedown",this._onClick);h.addChild(m);new CTLText(h,CANVAS_WIDTH/2-250,120,500,200,50,"center","#600101",FONT,1,0,0,a,!0,!0,!0,!1);l=new CGfxButton(CANVAS_WIDTH/2-180,380,s_oSpriteLibrary.getSprite("but_no"),h);l.pulseAnimation();g=new CGfxButton(CANVAS_WIDTH/2+180,380,s_oSpriteLibrary.getSprite("but_yes"),h);s_oStage.addChild(h);
this.show()};this._initListener=function(){l.addEventListener(ON_MOUSE_DOWN,this.buttonNoDown,this);g.addEventListener(ON_MOUSE_DOWN,this.buttonYesDown,this)};this.addEventListener=function(p,r,f){b[p]=r;e[p]=f};this.buttonNoDown=function(){b[ON_BUT_NO_DOWN]&&b[ON_BUT_NO_DOWN].call(e[ON_BUT_NO_DOWN],d)};this.buttonYesDown=function(){b[ON_BUT_YES_DOWN]&&b[ON_BUT_YES_DOWN].call(e[ON_BUT_YES_DOWN],d)};this._onClick=function(){};this.show=function(){h.alpha=0;createjs.Tween.get(h).to({alpha:1},500,createjs.Ease.quadOut).call(function(){c._initListener()})};
this.unload=function(){m.off("mousedown",this._onClick);createjs.Tween.get(h).to({alpha:0},500).call(function(){s_oStage.removeChild(h)})};this._init();s_oVariousHelp=this;return this}var s_oVariousHelp=null;
function CMsgBox(a,c){var b,e;this._init=function(h){e=new createjs.Container;m.addChild(e);h=new createjs.Shape;h.graphics.beginFill("black").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);h.alpha=.5;h.on("click",function(){});e.addChild(h);h=s_oSpriteLibrary.getSprite("msg_box");h=createBitmap(h);e.addChild(h);new CTLText(e,CANVAS_WIDTH/2-250,120,500,190,50,"center","#600101",FONT,1,0,0,TEXT_ERR_LS,!0,!0,!0,!1);b=new CGfxButton(CANVAS_WIDTH/2,370,s_oSpriteLibrary.getSprite("but_yes"),e);b.addEventListener(ON_MOUSE_UP,
this._onButOk,this)};this._onButOk=function(){d.unload()};this.unload=function(){b.unload();m.removeChild(e)};var d=this;var m=c;this._init(a)}
CTLText.prototype={constructor:CTLText,__autofit:function(){if(this._bFitText){for(var a=this._iFontSize;(this._oText.getBounds().height>this._iHeight-2*this._iPaddingV||this._oText.getBounds().width>this._iWidth-2*this._iPaddingH)&&!(a--,this._oText.font=a+"px "+this._szFont,this._oText.lineHeight=Math.round(a*this._fLineHeightFactor),this.__updateY(),this.__verticalAlign(),8>a););this._iFontSize=a}},__verticalAlign:function(){if(this._bVerticalAlign){var a=this._oText.getBounds().height;this._oText.y-=
(a-this._iHeight)/2+this._iPaddingV}},__updateY:function(){this._oText.y=this._y+this._iPaddingV;switch(this._oText.textBaseline){case "middle":this._oText.y+=this._oText.lineHeight/2+(this._iFontSize*this._fLineHeightFactor-this._iFontSize)}},__createText:function(a){this._bDebug&&(this._oDebugShape=new createjs.Shape,this._oDebugShape.graphics.beginFill("rgba(255,0,0,0.5)").drawRect(this._x,this._y,this._iWidth,this._iHeight),this._oContainer.addChild(this._oDebugShape));this._oText=new createjs.Text(a,
this._iFontSize+"px "+this._szFont,this._szColor);this._oText.textBaseline="middle";this._oText.lineHeight=Math.round(this._iFontSize*this._fLineHeightFactor);this._oText.textAlign=this._szAlign;this._oText.lineWidth=this._bMultiline?this._iWidth-2*this._iPaddingH:null;switch(this._szAlign){case "center":this._oText.x=this._x+this._iWidth/2;break;case "left":this._oText.x=this._x+this._iPaddingH;break;case "right":this._oText.x=this._x+this._iWidth-this._iPaddingH}this._oContainer.addChild(this._oText);
this.refreshText(a)},setVerticalAlign:function(a){this._bVerticalAlign=a},setOutline:function(a){null!==this._oText&&(this._oText.outline=a)},setShadow:function(a,c,b,e){null!==this._oText&&(this._oText.shadow=new createjs.Shadow(a,c,b,e))},setColor:function(a){this._oText.color=a},setAlpha:function(a){this._oText.alpha=a},removeTweens:function(){createjs.Tween.removeTweens(this._oText)},getText:function(){return this._oText},getY:function(){return this._y},getFontSize:function(){return this._iFontSize},
refreshText:function(a){""===a&&(a=" ");null===this._oText&&this.__createText(a);this._oText.text=a;this._oText.font=this._iFontSize+"px "+this._szFont;this._oText.lineHeight=Math.round(this._iFontSize*this._fLineHeightFactor);this.__autofit();this.__updateY();this.__verticalAlign()}};
function CTLText(a,c,b,e,d,m,h,l,g,p,r,f,n,v,u,z,E){this._oContainer=a;this._x=c;this._y=b;this._iWidth=e;this._iHeight=d;this._bMultiline=z;this._iFontSize=m;this._szAlign=h;this._szColor=l;this._szFont=g;this._iPaddingH=r;this._iPaddingV=f;this._bVerticalAlign=u;this._bFitText=v;this._bDebug=E;this._oDebugShape=null;this._fLineHeightFactor=p;this._oText=null;n&&this.__createText(n)};