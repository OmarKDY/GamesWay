/*
 Platform.js <https://mths.be/platform>
 Copyright 2014-2018 Benjamin Tan <https://bnjmnt4n.now.sh/>
 Copyright 2011-2013 John-David Dalton
 Available under MIT license <https://mths.be/mit>
*/
(function(){var a="undefined"!==typeof window&&"undefined"!==typeof window.document?window.document:{},c="undefined"!==typeof module&&module.exports,b=function(){for(var d,h=["requestFullscreen exitFullscreen fullscreenElement fullscreenEnabled fullscreenchange fullscreenerror".split(" "),"webkitRequestFullscreen webkitExitFullscreen webkitFullscreenElement webkitFullscreenEnabled webkitfullscreenchange webkitfullscreenerror".split(" "),"webkitRequestFullScreen webkitCancelFullScreen webkitCurrentFullScreenElement webkitCancelFullScreen webkitfullscreenchange webkitfullscreenerror".split(" "),
"mozRequestFullScreen mozCancelFullScreen mozFullScreenElement mozFullScreenEnabled mozfullscreenchange mozfullscreenerror".split(" "),"msRequestFullscreen msExitFullscreen msFullscreenElement msFullscreenEnabled MSFullscreenChange MSFullscreenError".split(" ")],f=0,g=h.length,e={};f<g;f++)if((d=h[f])&&d[1]in a){for(f=0;f<d.length;f++)e[h[0][f]]=d[f];return e}return!1}(),l={change:b.fullscreenchange,error:b.fullscreenerror},n={request:function(d){return new Promise(function(h,f){var g=function(){this.off("change",
g);h()}.bind(this);this.on("change",g);d=d||a.documentElement;Promise.resolve(d[b.requestFullscreen]())["catch"](f)}.bind(this))},exit:function(){return new Promise(function(d,h){if(this.isFullscreen){var f=function(){this.off("change",f);d()}.bind(this);this.on("change",f);Promise.resolve(a[b.exitFullscreen]())["catch"](h)}else d()}.bind(this))},toggle:function(d){return this.isFullscreen?this.exit():this.request(d)},onchange:function(d){this.on("change",d)},onerror:function(d){this.on("error",d)},
on:function(d,h){var f=l[d];f&&a.addEventListener(f,h,!1)},off:function(d,h){var f=l[d];f&&a.removeEventListener(f,h,!1)},raw:b};b?(Object.defineProperties(n,{isFullscreen:{get:function(){return!!a[b.fullscreenElement]}},element:{enumerable:!0,get:function(){return a[b.fullscreenElement]}},isEnabled:{enumerable:!0,get:function(){return!!a[b.fullscreenEnabled]}}}),c?module.exports=n:window.screenfull=n):c?module.exports={isEnabled:!1}:window.screenfull={isEnabled:!1}})();
(function(){function a(m){m=String(m);return m.charAt(0).toUpperCase()+m.slice(1)}function c(m,F){var G=-1,A=m?m.length:0;if("number"==typeof A&&-1<A&&A<=u)for(;++G<A;)F(m[G],G,m);else l(m,F)}function b(m){m=String(m).replace(/^ +| +$/g,"");return/^(?:webOS|i(?:OS|P))/.test(m)?m:a(m)}function l(m,F){for(var G in m)y.call(m,G)&&F(m[G],G,m)}function n(m){return null==m?a(m):D.call(m).slice(8,-1)}function d(m,F){var G=null!=m?typeof m[F]:"number";return!/^(?:boolean|number|string|undefined)$/.test(G)&&
("object"==G?!!m[F]:!0)}function h(m){return String(m).replace(/([ -])(?!$)/g,"$1?")}function f(m,F){var G=null;c(m,function(A,B){G=F(G,A,B,m)});return G}function g(m){function F(N){return f(N,function(K,J){var P=J.pattern||h(J);!K&&(K=RegExp("\\b"+P+" *\\d+[.\\w_]*","i").exec(m)||RegExp("\\b"+P+" *\\w+-[\\w]*","i").exec(m)||RegExp("\\b"+P+"(?:; *(?:[a-z]+[_-])?[a-z]+\\d+|[^ ();-]*)","i").exec(m))&&((K=String(J.label&&!RegExp(P,"i").test(J.label)?J.label:K).split("/"))[1]&&!/[\d.]+/.test(K[0])&&(K[0]+=
" "+K[1]),J=J.label||J,K=b(K[0].replace(RegExp(P,"i"),J).replace(RegExp("; *(?:"+J+"[_-])?","i")," ").replace(RegExp("("+J+")[-_.]?(\\w)","i"),"$1 $2")));return K})}function G(N){return f(N,function(K,J){return K||(RegExp(J+"(?:-[\\d.]+/|(?: for [\\w-]+)?[ /-])([\\d.]+[^ ();/_-]*)","i").exec(m)||0)[1]||null})}var A=t,B=m&&"object"==typeof m&&"String"!=n(m);B&&(A=m,m=null);var z=A.navigator||{},x=z.userAgent||"";m||(m=x);var aa=B?!!z.likeChrome:/\bChrome\b/.test(m)&&!/internal|\n/i.test(D.toString()),
R=B?"Object":"ScriptBridgingProxyObject",Q=B?"Object":"Environment",S=B&&A.java?"JavaPackage":n(A.java),T=B?"Object":"RuntimeObject";Q=(S=/\bJava/.test(S)&&A.java)&&n(A.environment)==Q;var H=S?"a":"\u03b1",W=S?"b":"\u03b2",Y=A.document||{},O=A.operamini||A.opera,X=w.test(X=B&&O?O["[[Class]]"]:n(O))?X:O=null,p,V=m;B=[];var Z=null,L=m==x;x=L&&O&&"function"==typeof O.version&&O.version();var k=function(N){return f(N,function(K,J){return K||RegExp("\\b"+(J.pattern||h(J))+"\\b","i").exec(m)&&(J.label||
J)})}([{label:"EdgeHTML",pattern:"Edge"},"Trident",{label:"WebKit",pattern:"AppleWebKit"},"iCab","Presto","NetFront","Tasman","KHTML","Gecko"]),q=function(N){return f(N,function(K,J){return K||RegExp("\\b"+(J.pattern||h(J))+"\\b","i").exec(m)&&(J.label||J)})}(["Adobe AIR","Arora","Avant Browser","Breach","Camino","Electron","Epiphany","Fennec","Flock","Galeon","GreenBrowser","iCab","Iceweasel","K-Meleon","Konqueror","Lunascape","Maxthon",{label:"Microsoft Edge",pattern:"Edge"},"Midori","Nook Browser",
"PaleMoon","PhantomJS","Raven","Rekonq","RockMelt",{label:"Samsung Internet",pattern:"SamsungBrowser"},"SeaMonkey",{label:"Silk",pattern:"(?:Cloud9|Silk-Accelerated)"},"Sleipnir","SlimBrowser",{label:"SRWare Iron",pattern:"Iron"},"Sunrise","Swiftfox","Waterfox","WebPositive","Opera Mini",{label:"Opera Mini",pattern:"OPiOS"},"Opera",{label:"Opera",pattern:"OPR"},"Chrome",{label:"Chrome Mobile",pattern:"(?:CriOS|CrMo)"},{label:"Firefox",pattern:"(?:Firefox|Minefield)"},{label:"Firefox for iOS",pattern:"FxiOS"},
{label:"IE",pattern:"IEMobile"},{label:"IE",pattern:"MSIE"},"Safari"]),E=F([{label:"BlackBerry",pattern:"BB10"},"BlackBerry",{label:"Galaxy S",pattern:"GT-I9000"},{label:"Galaxy S2",pattern:"GT-I9100"},{label:"Galaxy S3",pattern:"GT-I9300"},{label:"Galaxy S4",pattern:"GT-I9500"},{label:"Galaxy S5",pattern:"SM-G900"},{label:"Galaxy S6",pattern:"SM-G920"},{label:"Galaxy S6 Edge",pattern:"SM-G925"},{label:"Galaxy S7",pattern:"SM-G930"},{label:"Galaxy S7 Edge",pattern:"SM-G935"},"Google TV","Lumia","iPad",
"iPod","iPhone","Kindle",{label:"Kindle Fire",pattern:"(?:Cloud9|Silk-Accelerated)"},"Nexus","Nook","PlayBook","PlayStation Vita","PlayStation","TouchPad","Transformer",{label:"Wii U",pattern:"WiiU"},"Wii","Xbox One",{label:"Xbox 360",pattern:"Xbox"},"Xoom"]),M=function(N){return f(N,function(K,J,P){return K||(J[E]||J[/^[a-z]+(?: +[a-z]+\b)*/i.exec(E)]||RegExp("\\b"+h(P)+"(?:\\b|\\w*\\d)","i").exec(m))&&P})}({Apple:{iPad:1,iPhone:1,iPod:1},Archos:{},Amazon:{Kindle:1,"Kindle Fire":1},Asus:{Transformer:1},
"Barnes & Noble":{Nook:1},BlackBerry:{PlayBook:1},Google:{"Google TV":1,Nexus:1},HP:{TouchPad:1},HTC:{},LG:{},Microsoft:{Xbox:1,"Xbox One":1},Motorola:{Xoom:1},Nintendo:{"Wii U":1,Wii:1},Nokia:{Lumia:1},Samsung:{"Galaxy S":1,"Galaxy S2":1,"Galaxy S3":1,"Galaxy S4":1},Sony:{PlayStation:1,"PlayStation Vita":1}}),C=function(N){return f(N,function(K,J){var P=J.pattern||h(J);if(!K&&(K=RegExp("\\b"+P+"(?:/[\\d.]+|[ \\w.]*)","i").exec(m))){var U=K,ba=J.label||J,ca={"10.0":"10","6.4":"10 Technical Preview",
"6.3":"8.1","6.2":"8","6.1":"Server 2008 R2 / 7","6.0":"Server 2008 / Vista","5.2":"Server 2003 / XP 64-bit","5.1":"XP","5.01":"2000 SP1","5.0":"2000","4.0":"NT","4.90":"ME"};P&&ba&&/^Win/i.test(U)&&!/^Windows Phone /i.test(U)&&(ca=ca[/[\d.]+$/.exec(U)])&&(U="Windows "+ca);U=String(U);P&&ba&&(U=U.replace(RegExp(P,"i"),ba));K=U=b(U.replace(/ ce$/i," CE").replace(/\bhpw/i,"web").replace(/\bMacintosh\b/,"Mac OS").replace(/_PowerPC\b/i," OS").replace(/\b(OS X) [^ \d]+/i,"$1").replace(/\bMac (OS X)\b/,
"$1").replace(/\/(\d)/," $1").replace(/_/g,".").replace(/(?: BePC|[ .]*fc[ \d.]+)$/i,"").replace(/\bx86\.64\b/gi,"x86_64").replace(/\b(Windows Phone) OS\b/,"$1").replace(/\b(Chrome OS \w+) [\d.]+\b/,"$1").split(" on ")[0])}return K})}(["Windows Phone","Android","CentOS",{label:"Chrome OS",pattern:"CrOS"},"Debian","Fedora","FreeBSD","Gentoo","Haiku","Kubuntu","Linux Mint","OpenBSD","Red Hat","SuSE","Ubuntu","Xubuntu","Cygwin","Symbian OS","hpwOS","webOS ","webOS","Tablet OS","Tizen","Linux","Mac OS X",
"Macintosh","Mac","Windows 98;","Windows "]);k&&(k=[k]);M&&!E&&(E=F([M]));if(p=/\bGoogle TV\b/.exec(E))E=p[0];/\bSimulator\b/i.test(m)&&(E=(E?E+" ":"")+"Simulator");"Opera Mini"==q&&/\bOPiOS\b/.test(m)&&B.push("running in Turbo/Uncompressed mode");"IE"==q&&/\blike iPhone OS\b/.test(m)?(p=g(m.replace(/like iPhone OS/,"")),M=p.manufacturer,E=p.product):/^iP/.test(E)?(q||(q="Safari"),C="iOS"+((p=/ OS ([\d_]+)/i.exec(m))?" "+p[1].replace(/_/g,"."):"")):"Konqueror"!=q||/buntu/i.test(C)?M&&"Google"!=M&&
(/Chrome/.test(q)&&!/\bMobile Safari\b/i.test(m)||/\bVita\b/.test(E))||/\bAndroid\b/.test(C)&&/^Chrome/.test(q)&&/\bVersion\//i.test(m)?(q="Android Browser",C=/\bAndroid\b/.test(C)?C:"Android"):"Silk"==q?(/\bMobi/i.test(m)||(C="Android",B.unshift("desktop mode")),/Accelerated *= *true/i.test(m)&&B.unshift("accelerated")):"PaleMoon"==q&&(p=/\bFirefox\/([\d.]+)\b/.exec(m))?B.push("identifying as Firefox "+p[1]):"Firefox"==q&&(p=/\b(Mobile|Tablet|TV)\b/i.exec(m))?(C||(C="Firefox OS"),E||(E=p[1])):!q||
(p=!/\bMinefield\b/i.test(m)&&/\b(?:Firefox|Safari)\b/.exec(q))?(q&&!E&&/[\/,]|^[^(]+?\)/.test(m.slice(m.indexOf(p+"/")+8))&&(q=null),(p=E||M||C)&&(E||M||/\b(?:Android|Symbian OS|Tablet OS|webOS)\b/.test(C))&&(q=/[a-z]+(?: Hat)?/i.exec(/\bAndroid\b/.test(C)?C:p)+" Browser")):"Electron"==q&&(p=(/\bChrome\/([\d.]+)\b/.exec(m)||0)[1])&&B.push("Chromium "+p):C="Kubuntu";x||(x=G(["(?:Cloud9|CriOS|CrMo|Edge|FxiOS|IEMobile|Iron|Opera ?Mini|OPiOS|OPR|Raven|SamsungBrowser|Silk(?!/[\\d.]+$))","Version",h(q),
"(?:Firefox|Minefield|NetFront)"]));if(p="iCab"==k&&3<parseFloat(x)&&"WebKit"||/\bOpera\b/.test(q)&&(/\bOPR\b/.test(m)?"Blink":"Presto")||/\b(?:Midori|Nook|Safari)\b/i.test(m)&&!/^(?:Trident|EdgeHTML)$/.test(k)&&"WebKit"||!k&&/\bMSIE\b/i.test(m)&&("Mac OS"==C?"Tasman":"Trident")||"WebKit"==k&&/\bPlayStation\b(?! Vita\b)/i.test(q)&&"NetFront")k=[p];"IE"==q&&(p=(/; *(?:XBLWP|ZuneWP)(\d+)/i.exec(m)||0)[1])?(q+=" Mobile",C="Windows Phone "+(/\+$/.test(p)?p:p+".x"),B.unshift("desktop mode")):/\bWPDesktop\b/i.test(m)?
(q="IE Mobile",C="Windows Phone 8.x",B.unshift("desktop mode"),x||(x=(/\brv:([\d.]+)/.exec(m)||0)[1])):"IE"!=q&&"Trident"==k&&(p=/\brv:([\d.]+)/.exec(m))&&(q&&B.push("identifying as "+q+(x?" "+x:"")),q="IE",x=p[1]);if(L){if(d(A,"global"))if(S&&(p=S.lang.System,V=p.getProperty("os.arch"),C=C||p.getProperty("os.name")+" "+p.getProperty("os.version")),Q){try{x=A.require("ringo/engine").version.join("."),q="RingoJS"}catch(N){(p=A.system)&&p.global.system==A.system&&(q="Narwhal",C||(C=p[0].os||null))}q||
(q="Rhino")}else"object"==typeof A.process&&!A.process.browser&&(p=A.process)&&("object"==typeof p.versions&&("string"==typeof p.versions.electron?(B.push("Node "+p.versions.node),q="Electron",x=p.versions.electron):"string"==typeof p.versions.nw&&(B.push("Chromium "+x,"Node "+p.versions.node),q="NW.js",x=p.versions.nw)),q||(q="Node.js",V=p.arch,C=p.platform,x=(x=/[\d.]+/.exec(p.version))?x[0]:null));else n(p=A.runtime)==R?(q="Adobe AIR",C=p.flash.system.Capabilities.os):n(p=A.phantom)==T?(q="PhantomJS",
x=(p=p.version||null)&&p.major+"."+p.minor+"."+p.patch):"number"==typeof Y.documentMode&&(p=/\bTrident\/(\d+)/i.exec(m))?(x=[x,Y.documentMode],(p=+p[1]+4)!=x[1]&&(B.push("IE "+x[1]+" mode"),k&&(k[1]=""),x[1]=p),x="IE"==q?String(x[1].toFixed(1)):x[0]):"number"==typeof Y.documentMode&&/^(?:Chrome|Firefox)\b/.test(q)&&(B.push("masking as "+q+" "+x),q="IE",x="11.0",k=["Trident"],C="Windows");C=C&&b(C)}x&&(p=/(?:[ab]|dp|pre|[ab]\d+pre)(?:\d+\+?)?$/i.exec(x)||/(?:alpha|beta)(?: ?\d)?/i.exec(m+";"+(L&&z.appMinorVersion))||
/\bMinefield\b/i.test(m)&&"a")&&(Z=/b/i.test(p)?"beta":"alpha",x=x.replace(RegExp(p+"\\+?$"),"")+("beta"==Z?W:H)+(/\d+\+?/.exec(p)||""));if("Fennec"==q||"Firefox"==q&&/\b(?:Android|Firefox OS)\b/.test(C))q="Firefox Mobile";else if("Maxthon"==q&&x)x=x.replace(/\.[\d.]+/,".x");else if(/\bXbox\b/i.test(E))"Xbox 360"==E&&(C=null),"Xbox 360"==E&&/\bIEMobile\b/.test(m)&&B.unshift("mobile mode");else if(!/^(?:Chrome|IE|Opera)$/.test(q)&&(!q||E||/Browser|Mobi/.test(q))||"Windows CE"!=C&&!/Mobi/i.test(m))if("IE"==
q&&L)try{null===A.external&&B.unshift("platform preview")}catch(N){B.unshift("embedded")}else(/\bBlackBerry\b/.test(E)||/\bBB10\b/.test(m))&&(p=(RegExp(E.replace(/ +/g," *")+"/([.\\d]+)","i").exec(m)||0)[1]||x)?(p=[p,/BB10/.test(m)],C=(p[1]?(E=null,M="BlackBerry"):"Device Software")+" "+p[0],x=null):this!=l&&"Wii"!=E&&(L&&O||/Opera/.test(q)&&/\b(?:MSIE|Firefox)\b/i.test(m)||"Firefox"==q&&/\bOS X (?:\d+\.){2,}/.test(C)||"IE"==q&&(C&&!/^Win/.test(C)&&5.5<x||/\bWindows XP\b/.test(C)&&8<x||8==x&&!/\bTrident\b/.test(m)))&&
!w.test(p=g.call(l,m.replace(w,"")+";"))&&p.name&&(p="ing as "+p.name+((p=p.version)?" "+p:""),w.test(q)?(/\bIE\b/.test(p)&&"Mac OS"==C&&(C=null),p="identify"+p):(p="mask"+p,q=X?b(X.replace(/([a-z])([A-Z])/g,"$1 $2")):"Opera",/\bIE\b/.test(p)&&(C=null),L||(x=null)),k=["Presto"],B.push(p));else q+=" Mobile";if(p=(/\bAppleWebKit\/([\d.]+\+?)/i.exec(m)||0)[1]){p=[parseFloat(p.replace(/\.(\d)$/,".0$1")),p];if("Safari"==q&&"+"==p[1].slice(-1))q="WebKit Nightly",Z="alpha",x=p[1].slice(0,-1);else if(x==
p[1]||x==(p[2]=(/\bSafari\/([\d.]+\+?)/i.exec(m)||0)[1]))x=null;p[1]=(/\bChrome\/([\d.]+)/i.exec(m)||0)[1];537.36==p[0]&&537.36==p[2]&&28<=parseFloat(p[1])&&"WebKit"==k&&(k=["Blink"]);L&&(aa||p[1])?(k&&(k[1]="like Chrome"),p=p[1]||(p=p[0],530>p?1:532>p?2:532.05>p?3:533>p?4:534.03>p?5:534.07>p?6:534.1>p?7:534.13>p?8:534.16>p?9:534.24>p?10:534.3>p?11:535.01>p?12:535.02>p?"13+":535.07>p?15:535.11>p?16:535.19>p?17:536.05>p?18:536.1>p?19:537.01>p?20:537.11>p?"21+":537.13>p?23:537.18>p?24:537.24>p?25:537.36>
p?26:"Blink"!=k?"27":"28")):(k&&(k[1]="like Safari"),p=(p=p[0],400>p?1:500>p?2:526>p?3:533>p?4:534>p?"4+":535>p?5:537>p?6:538>p?7:601>p?8:"8"));k&&(k[1]+=" "+(p+="number"==typeof p?".x":/[.+]/.test(p)?"":"+"));"Safari"==q&&(!x||45<parseInt(x))&&(x=p)}"Opera"==q&&(p=/\bzbov|zvav$/.exec(C))?(q+=" ",B.unshift("desktop mode"),"zvav"==p?(q+="Mini",x=null):q+="Mobile",C=C.replace(RegExp(" *"+p+"$"),"")):"Safari"==q&&/\bChrome\b/.exec(k&&k[1])&&(B.unshift("desktop mode"),q="Chrome Mobile",x=null,/\bOS X\b/.test(C)?
(M="Apple",C="iOS 4.3+"):C=null);x&&0==x.indexOf(p=/[\d.]+$/.exec(C))&&-1<m.indexOf("/"+p+"-")&&(C=String(C.replace(p,"")).replace(/^ +| +$/g,""));k&&!/\b(?:Avant|Nook)\b/.test(q)&&(/Browser|Lunascape|Maxthon/.test(q)||"Safari"!=q&&/^iOS/.test(C)&&/\bSafari\b/.test(k[1])||/^(?:Adobe|Arora|Breach|Midori|Opera|Phantom|Rekonq|Rock|Samsung Internet|Sleipnir|Web)/.test(q)&&k[1])&&(p=k[k.length-1])&&B.push(p);B.length&&(B=["("+B.join("; ")+")"]);M&&E&&0>E.indexOf(M)&&B.push("on "+M);E&&B.push((/^on /.test(B[B.length-
1])?"":"on ")+E);if(C){var da=(p=/ ([\d.+]+)$/.exec(C))&&"/"==C.charAt(C.length-p[0].length-1);C={architecture:32,family:p&&!da?C.replace(p[0],""):C,version:p?p[1]:null,toString:function(){var N=this.version;return this.family+(N&&!da?" "+N:"")+(64==this.architecture?" 64-bit":"")}}}(p=/\b(?:AMD|IA|Win|WOW|x86_|x)64\b/i.exec(V))&&!/\bi686\b/i.test(V)?(C&&(C.architecture=64,C.family=C.family.replace(RegExp(" *"+p),"")),q&&(/\bWOW64\b/i.test(m)||L&&/\w(?:86|32)$/.test(z.cpuClass||z.platform)&&!/\bWin64; x64\b/i.test(m))&&
B.unshift("32-bit")):C&&/^OS X/.test(C.family)&&"Chrome"==q&&39<=parseFloat(x)&&(C.architecture=64);m||(m=null);A={};A.description=m;A.layout=k&&k[0];A.manufacturer=M;A.name=q;A.prerelease=Z;A.product=E;A.ua=m;A.version=q&&x;A.os=C||{architecture:null,family:null,version:null,toString:function(){return"null"}};A.parse=g;A.toString=function(){return this.description||""};A.version&&B.unshift(x);A.name&&B.unshift(q);C&&q&&(C!=String(C).split(" ")[0]||C!=q.split(" ")[0]&&!E)&&B.push(E?"("+C+")":"on "+
C);B.length&&(A.description=B.join(" "));return A}var e={"function":!0,object:!0},t=e[typeof window]&&window||this,v=e[typeof exports]&&exports;e=e[typeof module]&&module&&!module.nodeType&&module;var r=v&&e&&"object"==typeof global&&global;!r||r.global!==r&&r.window!==r&&r.self!==r||(t=r);var u=Math.pow(2,53)-1,w=/\bOpera/;r=Object.prototype;var y=r.hasOwnProperty,D=r.toString,I=g();"function"==typeof define&&"object"==typeof define.amd&&define.amd?(t.platform=I,define(function(){return I})):v&&
e?l(I,function(m,F){v[F]=m}):t.platform=I}).call(this);
!function(){function a(n){var d=n;if(l[d])d=l[d];else{for(var h=d,f,g=[],e=0;h;){if(null!==(f=b.text.exec(h)))g.push(f[0]);else if(null!==(f=b.modulo.exec(h)))g.push("%");else if(null!==(f=b.placeholder.exec(h))){if(f[2]){e|=1;var t=[],v=f[2],r;if(null!==(r=b.key.exec(v)))for(t.push(r[1]);""!==(v=v.substring(r[0].length));)if(null!==(r=b.key_access.exec(v)))t.push(r[1]);else if(null!==(r=b.index_access.exec(v)))t.push(r[1]);else throw new SyntaxError("[sprintf] failed to parse named argument key");else throw new SyntaxError("[sprintf] failed to parse named argument key");
f[2]=t}else e|=2;if(3===e)throw Error("[sprintf] mixing positional and named placeholders is not (yet) supported");g.push({placeholder:f[0],param_no:f[1],keys:f[2],sign:f[3],pad_char:f[4],align:f[5],width:f[6],precision:f[7],type:f[8]})}else throw new SyntaxError("[sprintf] unexpected placeholder");h=h.substring(f[0].length)}d=l[d]=g}h=arguments;f=1;g=d.length;t="";var u,w;for(v=0;v<g;v++)if("string"===typeof d[v])t+=d[v];else if("object"===typeof d[v]){r=d[v];if(r.keys)for(e=h[f],u=0;u<r.keys.length;u++){if(void 0==
e)throw Error(a('[sprintf] Cannot access property "%s" of undefined value "%s"',r.keys[u],r.keys[u-1]));e=e[r.keys[u]]}else e=r.param_no?h[r.param_no]:h[f++];b.not_type.test(r.type)&&b.not_primitive.test(r.type)&&e instanceof Function&&(e=e());if(b.numeric_arg.test(r.type)&&"number"!==typeof e&&isNaN(e))throw new TypeError(a("[sprintf] expecting number but found %T",e));b.number.test(r.type)&&(w=0<=e);switch(r.type){case "b":e=parseInt(e,10).toString(2);break;case "c":e=String.fromCharCode(parseInt(e,
10));break;case "d":case "i":e=parseInt(e,10);break;case "j":e=JSON.stringify(e,null,r.width?parseInt(r.width):0);break;case "e":e=r.precision?parseFloat(e).toExponential(r.precision):parseFloat(e).toExponential();break;case "f":e=r.precision?parseFloat(e).toFixed(r.precision):parseFloat(e);break;case "g":e=r.precision?String(Number(e.toPrecision(r.precision))):parseFloat(e);break;case "o":e=(parseInt(e,10)>>>0).toString(8);break;case "s":e=String(e);e=r.precision?e.substring(0,r.precision):e;break;
case "t":e=String(!!e);e=r.precision?e.substring(0,r.precision):e;break;case "T":e=Object.prototype.toString.call(e).slice(8,-1).toLowerCase();e=r.precision?e.substring(0,r.precision):e;break;case "u":e=parseInt(e,10)>>>0;break;case "v":e=e.valueOf();e=r.precision?e.substring(0,r.precision):e;break;case "x":e=(parseInt(e,10)>>>0).toString(16);break;case "X":e=(parseInt(e,10)>>>0).toString(16).toUpperCase()}if(b.json.test(r.type))t+=e;else{if(!b.number.test(r.type)||w&&!r.sign)var y="";else y=w?"+":
"-",e=e.toString().replace(b.sign,"");u=r.pad_char?"0"===r.pad_char?"0":r.pad_char.charAt(1):" ";var D=r.width-(y+e).length;D=r.width?0<D?u.repeat(D):"":"";t+=r.align?y+e+D:"0"===u?y+D+e:D+y+e}}return t}function c(n,d){return a.apply(null,[n].concat(d||[]))}var b={not_string:/[^s]/,not_bool:/[^t]/,not_type:/[^T]/,not_primitive:/[^v]/,number:/[diefg]/,numeric_arg:/[bcdiefguxX]/,json:/[j]/,not_json:/[^j]/,text:/^[^\x25]+/,modulo:/^\x25{2}/,placeholder:/^\x25(?:([1-9]\d*)\$|\(([^)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-gijostTuvxX])/,
key:/^([a-z_][a-z_\d]*)/i,key_access:/^\.([a-z_][a-z_\d]*)/i,index_access:/^\[(\d+)\]/,sign:/^[+-]/},l=Object.create(null);"undefined"!==typeof exports&&(exports.sprintf=a,exports.vsprintf=c);"undefined"!==typeof window&&(window.sprintf=a,window.vsprintf=c,"function"===typeof define&&define.amd&&define(function(){return{sprintf:a,vsprintf:c}}))}();
var s_iScaleFactor=1,s_bIsIphone=!1,s_iOffsetX,s_iOffsetY,s_bFocus=!0,browserName=function(a){switch(!0){case -1<a.indexOf("edge"):return"MS Edge";case -1<a.indexOf("edg/"):return"Edge ( chromium based)";case -1<a.indexOf("opr")&&!!window.opr:return"Opera";case -1<a.indexOf("chrome")&&!!window.chrome:return"Chrome";case -1<a.indexOf("trident"):return"MS IE";case -1<a.indexOf("firefox"):return"Mozilla Firefox";case -1<a.indexOf("safari"):return"Safari";default:return"other"}}(window.navigator.userAgent.toLowerCase());
window.addEventListener("resize",function(a){sizeHandler()},!0);function trace(a){console.log(a)}
function getSize(a){var c=a.toLowerCase(),b=window.document,l=b.documentElement;if(void 0===window["inner"+a])a=l["client"+a];else if(window["inner"+a]!=l["client"+a]){var n=b.createElement("body");n.id="vpw-test-b";n.style.cssText="overflow:scroll";var d=b.createElement("div");d.id="vpw-test-d";d.style.cssText="position:absolute;top:-1000px";d.innerHTML="<style>@media("+c+":"+l["client"+a]+"px){body#vpw-test-b div#vpw-test-d{"+c+":7px!important}}</style>";n.appendChild(d);l.insertBefore(n,b.head);
a=7==d["offset"+a]?l["client"+a]:window["inner"+a];l.removeChild(n)}else a=window["inner"+a];return a}function isIpad(){var a=-1!==navigator.userAgent.toLowerCase().indexOf("ipad");return!a&&navigator.userAgent.match(/Mac/)&&navigator.maxTouchPoints&&2<navigator.maxTouchPoints?!0:a}
function isMobile(){return isIpad()?!0:navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i)?!0:!1}
function sizeHandler(){window.scrollTo(0,1);if(document.querySelector("#canvas")){var a=null!==platform.name&&"safari"===platform.name.toLowerCase()?getIOSWindowHeight():getSize("Height");var c=getSize("Width");s_bFocus&&_checkOrientation(c,a);var b=Math.min(a/CANVAS_HEIGHT,c/CANVAS_WIDTH),l=Math.round(CANVAS_WIDTH*b);b=Math.round(CANVAS_HEIGHT*b);if(b<a){var n=a-b;b+=n;l+=CANVAS_WIDTH/CANVAS_HEIGHT*n}else l<c&&(n=c-l,l+=n,b+=CANVAS_HEIGHT/CANVAS_WIDTH*n);n=a/2-b/2;var d=c/2-l/2,h=CANVAS_WIDTH/l;
if(d*h<-EDGEBOARD_X||n*h<-EDGEBOARD_Y)b=Math.min(a/(CANVAS_HEIGHT-2*EDGEBOARD_Y),c/(CANVAS_WIDTH-2*EDGEBOARD_X)),l=Math.round(CANVAS_WIDTH*b),b=Math.round(CANVAS_HEIGHT*b),n=(a-b)/2,d=(c-l)/2,h=CANVAS_WIDTH/l;s_iOffsetX=-1*d*h;s_iOffsetY=-1*n*h;0<=n&&(s_iOffsetY=0);0<=d&&(s_iOffsetX=0);null!==s_oInterface&&s_oInterface.refreshButtonPos(s_iOffsetX,s_iOffsetY);null!==s_oMenu&&s_oMenu.refreshButtonPos(s_iOffsetX,s_iOffsetY);s_bIsIphone&&s_oStage?(canvas=document.getElementById("canvas"),s_oStage.canvas.width=
2*l,s_oStage.canvas.height=2*b,canvas.style.width=l+"px",canvas.style.height=b+"px",c=Math.min(l/CANVAS_WIDTH,b/CANVAS_HEIGHT),s_iScaleFactor=2*c,s_oStage.scaleX=s_oStage.scaleY=2*c):s_bMobile||isChrome()?(document.querySelector("#canvas").style.width=l+"px",document.querySelector("#canvas").style.height=b+"px"):s_oStage&&(s_oStage.canvas.width=l,s_oStage.canvas.height=b,s_iScaleFactor=Math.min(l/CANVAS_WIDTH,b/CANVAS_HEIGHT),s_oStage.scaleX=s_oStage.scaleY=s_iScaleFactor);0<=n&&(n=(a-b)/2);document.querySelector("#canvas").style.top=
n+"px";document.querySelector("#canvas").style.left=d+"px";fullscreenHandler()}}window.addEventListener("orientationchange",onOrientationChange);function onOrientationChange(){window.matchMedia("(orientation: portrait)").matches&&sizeHandler();window.matchMedia("(orientation: landscape)").matches&&sizeHandler()}function isChrome(){return/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)}
function isIOS(){var a="iPad Simulator;iPhone Simulator;iPod Simulator;iPad;iPhone;iPod".split(";");if(-1!==navigator.userAgent.toLowerCase().indexOf("iphone"))return s_bIsIphone=!0;for(;a.length;)if(navigator.platform===a.pop())return!0;return s_bIsIphone=!1}
function _checkOrientation(a,c){s_bMobile&&ENABLE_CHECK_ORIENTATION&&(a>c?"landscape"===document.querySelector(".orientation-msg-container").getAttribute("data-orientation")?(document.querySelector(".orientation-msg-container").style.display="none",s_oMain.startUpdate()):(document.querySelector(".orientation-msg-container").style.display="block",s_oMain.stopUpdate()):"portrait"===document.querySelector(".orientation-msg-container").getAttribute("data-orientation")?(document.querySelector(".orientation-msg-container").style.display=
"none",s_oMain.startUpdate()):(document.querySelector(".orientation-msg-container").style.display="block",s_oMain.stopUpdate()))}function getIOSWindowHeight(){return document.documentElement.clientWidth/window.innerWidth*window.innerHeight}function getHeightOfIOSToolbars(){var a=(0===window.orientation?screen.height:screen.width)-getIOSWindowHeight();return 1<a?a:0}
function playSound(a,c,b){return!1===DISABLE_SOUND_MOBILE||!1===s_bMobile?(s_aSounds[a].play(),s_aSounds[a].volume(c),s_aSounds[a].loop(b),s_aSounds[a]):null}function stopSound(a){!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||s_aSounds[a].stop()}function setVolume(a,c){!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||s_aSounds[a].volume(c)}function setMute(a,c){!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||s_aSounds[a].mute(c)}
function fadeSound(a,c,b,l){!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||s_aSounds[a].fade(c,b,l)}function soundPlaying(a){if(!1===DISABLE_SOUND_MOBILE||!1===s_bMobile)return s_aSounds[a].playing()}function createBitmap(a,c,b){var l=new createjs.Bitmap(a),n=new createjs.Shape;c&&b?n.graphics.beginFill("#fff").drawRect(0,0,c,b):n.graphics.beginFill("#ff0").drawRect(0,0,a.width,a.height);l.hitArea=n;return l}
function createSprite(a,c,b,l,n,d){a=null!==c?new createjs.Sprite(a,c):new createjs.Sprite(a);c=new createjs.Shape;c.graphics.beginFill("#000000").drawRect(-b,-l,n,d);a.hitArea=c;return a}function randomFloatBetween(a,c,b){"undefined"===typeof b&&(b=2);return parseFloat(Math.min(a+Math.random()*(c-a),c).toFixed(b))}function tweenVectorsOnX(a,c,b){return a+b*(c-a)}function shuffle(a){for(var c=a.length,b,l;0!==c;)l=Math.floor(Math.random()*c),--c,b=a[c],a[c]=a[l],a[l]=b;return a}
function bubbleSort(a){do{var c=!1;for(var b=0;b<a.length-1;b++)a[b]>a[b+1]&&(c=a[b],a[b]=a[b+1],a[b+1]=c,c=!0)}while(c)}function compare(a,c){return a.index>c.index?-1:a.index<c.index?1:0}function easeLinear(a,c,b,l){return b*a/l+c}function easeInQuad(a,c,b,l){return b*(a/=l)*a+c}function easeInSine(a,c,b,l){return-b*Math.cos(a/l*(Math.PI/2))+b+c}function easeInCubic(a,c,b,l){return b*(a/=l)*a*a+c}
function getTrajectoryPoint(a,c){var b=new createjs.Point,l=(1-a)*(1-a),n=a*a;b.x=l*c.start.x+2*(1-a)*a*c.traj.x+n*c.end.x;b.y=l*c.start.y+2*(1-a)*a*c.traj.y+n*c.end.y;return b}function formatTime(a){a/=1E3;var c=Math.floor(a/60);a=parseFloat(a-60*c).toFixed(1);var b="";b=10>c?b+("0"+c+":"):b+(c+":");return 10>a?b+("0"+a):b+a}function degreesToRadians(a){return a*Math.PI/180}function checkRectCollision(a,c){var b=getBounds(a,.9);var l=getBounds(c,.98);return calculateIntersection(b,l)}
function calculateIntersection(a,c){var b,l,n,d;var h=a.x+(b=a.width/2);var f=a.y+(l=a.height/2);var g=c.x+(n=c.width/2);var e=c.y+(d=c.height/2);h=Math.abs(h-g)-(b+n);f=Math.abs(f-e)-(l+d);return 0>h&&0>f?(h=Math.min(Math.min(a.width,c.width),-h),f=Math.min(Math.min(a.height,c.height),-f),{x:Math.max(a.x,c.x),y:Math.max(a.y,c.y),width:h,height:f,rect1:a,rect2:c}):null}
function getBounds(a,c){var b={x:Infinity,y:Infinity,width:0,height:0};if(a instanceof createjs.Container){b.x2=-Infinity;b.y2=-Infinity;var l=a.children,n=l.length,d;for(d=0;d<n;d++){var h=getBounds(l[d],1);h.x<b.x&&(b.x=h.x);h.y<b.y&&(b.y=h.y);h.x+h.width>b.x2&&(b.x2=h.x+h.width);h.y+h.height>b.y2&&(b.y2=h.y+h.height)}Infinity==b.x&&(b.x=0);Infinity==b.y&&(b.y=0);Infinity==b.x2&&(b.x2=0);Infinity==b.y2&&(b.y2=0);b.width=b.x2-b.x;b.height=b.y2-b.y;delete b.x2;delete b.y2}else{if(a instanceof createjs.Bitmap){n=
a.sourceRect||a.image;d=n.width*c;var f=n.height*c}else if(a instanceof createjs.Sprite)if(a.spriteSheet._frames&&a.spriteSheet._frames[a.currentFrame]&&a.spriteSheet._frames[a.currentFrame].image){n=a.spriteSheet.getFrame(a.currentFrame);d=n.rect.width;f=n.rect.height;l=n.regX;var g=n.regY}else b.x=a.x||0,b.y=a.y||0;else b.x=a.x||0,b.y=a.y||0;l=l||0;d=d||0;g=g||0;f=f||0;b.regX=l;b.regY=g;n=a.localToGlobal(0-l,0-g);h=a.localToGlobal(d-l,f-g);d=a.localToGlobal(d-l,0-g);l=a.localToGlobal(0-l,f-g);b.x=
Math.min(Math.min(Math.min(n.x,h.x),d.x),l.x);b.y=Math.min(Math.min(Math.min(n.y,h.y),d.y),l.y);b.width=Math.max(Math.max(Math.max(n.x,h.x),d.x),l.x)-b.x;b.height=Math.max(Math.max(Math.max(n.y,h.y),d.y),l.y)-b.y}return b}function NoClickDelay(a){this.element=a;window.Touch&&this.element.addEventListener("touchstart",this,!1)}function shuffle(a){for(var c=a.length,b,l;0<c;)l=Math.floor(Math.random()*c),c--,b=a[c],a[c]=a[l],a[l]=b;return a}
NoClickDelay.prototype={handleEvent:function(a){switch(a.type){case "touchstart":this.onTouchStart(a);break;case "touchmove":this.onTouchMove(a);break;case "touchend":this.onTouchEnd(a)}},onTouchStart:function(a){a.preventDefault();this.moved=!1;this.element.addEventListener("touchmove",this,!1);this.element.addEventListener("touchend",this,!1)},onTouchMove:function(a){this.moved=!0},onTouchEnd:function(a){this.element.removeEventListener("touchmove",this,!1);this.element.removeEventListener("touchend",
this,!1);if(!this.moved){a=document.elementFromPoint(a.changedTouches[0].clientX,a.changedTouches[0].clientY);3==a.nodeType&&(a=a.parentNode);var c=document.createEvent("MouseEvents");c.initEvent("click",!0,!0);a.dispatchEvent(c)}}};
(function(){function a(b){var l={focus:"visible",focusin:"visible",pageshow:"visible",blur:"hidden",focusout:"hidden",pagehide:"hidden"};b=b||window.event;b.type in l?document.body.className=l[b.type]:(document.body.className=this[c]?"hidden":"visible","hidden"===document.body.className?(s_oMain.stopUpdate(),s_bFocus=!1):(s_oMain.startUpdate(),s_bFocus=!0))}var c="hidden";c in document?document.addEventListener("visibilitychange",a):(c="mozHidden")in document?document.addEventListener("mozvisibilitychange",
a):(c="webkitHidden")in document?document.addEventListener("webkitvisibilitychange",a):(c="msHidden")in document?document.addEventListener("msvisibilitychange",a):"onfocusin"in document?document.onfocusin=document.onfocusout=a:window.onpageshow=window.onpagehide=window.onfocus=window.onblur=a})();function ctlArcadeResume(){null!==s_oMain&&s_oMain.startUpdate()}function ctlArcadePause(){null!==s_oMain&&s_oMain.stopUpdate()}
function getParamValue(a){for(var c=window.location.search.substring(1).split("&"),b=0;b<c.length;b++){var l=c[b].split("=");if(l[0]==a)return l[1]}}function fullscreenHandler(){ENABLE_FULLSCREEN&&screenfull.isEnabled&&(s_bFullscreen=screenfull.isFullscreen,null!==s_oInterface&&s_oInterface.resetFullscreenBut(),null!==s_oMenu&&s_oMenu.resetFullscreenBut())}
if(screenfull.isEnabled)screenfull.on("change",function(){s_bFullscreen=screenfull.isFullscreen;null!==s_oInterface&&s_oInterface.resetFullscreenBut();null!==s_oMenu&&s_oMenu.resetFullscreenBut()});
function CSpriteLibrary(){var a={},c,b,l,n,d,h;this.init=function(f,g,e){c={};l=b=0;n=f;d=g;h=e};this.addSprite=function(f,g){if(!a.hasOwnProperty(f)){var e=new Image;a[f]=c[f]={szPath:g,oSprite:e,bLoaded:!1};b++}};this.getSprite=function(f){return a.hasOwnProperty(f)?a[f].oSprite:null};this._onSpritesLoaded=function(){b=0;d.call(h)};this._onSpriteLoaded=function(){n.call(h);++l===b&&this._onSpritesLoaded()};this.loadSprites=function(){for(var f in c)c[f].oSprite.oSpriteLibrary=this,c[f].oSprite.szKey=
f,c[f].oSprite.onload=function(){this.oSpriteLibrary.setLoaded(this.szKey);this.oSpriteLibrary._onSpriteLoaded(this.szKey)},c[f].oSprite.onerror=function(g){var e=g.currentTarget;setTimeout(function(){c[e.szKey].oSprite.src=c[e.szKey].szPath},500)},c[f].oSprite.src=c[f].szPath};this.setLoaded=function(f){a[f].bLoaded=!0};this.isLoaded=function(f){return a[f].bLoaded};this.getNumSprites=function(){return b}}
CTLText.prototype={constructor:CTLText,__autofit:function(){if(this._bFitText){for(var a=this._iFontSize;(this._oText.getBounds().height>this._iHeight-2*this._iPaddingV||this._oText.getBounds().width>this._iWidth-2*this._iPaddingH)&&!(a--,this._oText.font=a+"px "+this._szFont,this._oText.lineHeight=Math.round(a*this._fLineHeightFactor),this.__updateY(),this.__verticalAlign(),8>a););this._iFontSize=a}},__verticalAlign:function(){if(this._bVerticalAlign){var a=this._oText.getBounds().height;this._oText.y-=
(a-this._iHeight)/2+this._iPaddingV}},__updateY:function(){this._oText.y=this._y+this._iPaddingV;switch(this._oText.textBaseline){case "middle":this._oText.y+=this._oText.lineHeight/2+(this._iFontSize*this._fLineHeightFactor-this._iFontSize)}},__createText:function(a){this._bDebug&&(this._oDebugShape=new createjs.Shape,this._oDebugShape.graphics.beginFill("rgba(255,0,0,0.5)").drawRect(this._x,this._y,this._iWidth,this._iHeight),this._oContainer.addChild(this._oDebugShape));this._oText=new createjs.Text(a,
this._iFontSize+"px "+this._szFont,this._szColor);this._oText.textBaseline="middle";this._oText.lineHeight=Math.round(this._iFontSize*this._fLineHeightFactor);this._oText.textAlign=this._szAlign;this._oText.lineWidth=this._bMultiline?this._iWidth-2*this._iPaddingH:null;switch(this._szAlign){case "center":this._oText.x=this._x+this._iWidth/2;break;case "left":this._oText.x=this._x+this._iPaddingH;break;case "right":this._oText.x=this._x+this._iWidth-this._iPaddingH}this._oContainer.addChild(this._oText);
this.refreshText(a)},setVerticalAlign:function(a){this._bVerticalAlign=a},setOutline:function(a){null!==this._oText&&(this._oText.outline=a)},setShadow:function(a,c,b,l){null!==this._oText&&(this._oText.shadow=new createjs.Shadow(a,c,b,l))},setColor:function(a){this._oText.color=a},setAlpha:function(a){this._oText.alpha=a},setY:function(a){this._y=this._oText.y=a},removeTweens:function(){createjs.Tween.removeTweens(this._oText)},getText:function(){return this._oText},getY:function(){return this._y},
getFontSize:function(){return this._iFontSize},refreshText:function(a){""===a&&(a=" ");null===this._oText&&this.__createText(a);this._oText.text=a;this._oText.font=this._iFontSize+"px "+this._szFont;this._oText.lineHeight=Math.round(this._iFontSize*this._fLineHeightFactor);this.__autofit();this.__updateY();this.__verticalAlign()}};
function CTLText(a,c,b,l,n,d,h,f,g,e,t,v,r,u,w,y,D){this._oContainer=a;this._x=c;this._y=b;this._iWidth=l;this._iHeight=n;this._bMultiline=y;this._iFontSize=d;this._szAlign=h;this._szColor=f;this._szFont=g;this._iPaddingH=t;this._iPaddingV=v;this._bVerticalAlign=w;this._bFitText=u;this._bDebug=D;this._oDebugShape=null;this._fLineHeightFactor=e;this._oText=null;r&&this.__createText(r)}
var CANVAS_WIDTH=1080,CANVAS_HEIGHT=1136,EDGEBOARD_X=220,EDGEBOARD_Y=0,FPS=24,FPS_TIME=1E3/24,DISABLE_SOUND_MOBILE=!1,PRIMARY_FONT="walibi",SOUNDTRACK_VOLUME_IN_GAME=.6,STATE_LOADING=0,STATE_MENU=1,STATE_HELP=1,STATE_GAME=3,ON_MOUSE_DOWN=0,ON_MOUSE_UP=1,ON_MOUSE_OVER=2,ON_MOUSE_OUT=3,ON_DRAG_START=4,ON_DRAG_END=5,H_MOVE=37,V_MOVE=50,LEVEL_TIME,MAX_LEVEL_DIFFICULTY=20,SCORE_IN_NEST,SCORE_WITH_FLY,SCORE_DEATH,UNLOAD_OFFSET=100,TURTLE_OFFSET=74,NUM_CONSECUTIVE_TURTLE_0=3,NUM_CONSECUTIVE_TURTLE_3=2,SINK_TURTLE_OCCURRENCY,
NUM_LEVEL_INCREASE_SINK,TIME_FLY_TO_SPAWN,TIME_FLY_TO_DISAPPEAR,FROG_STARTING_LOGIC_POS={row:0,col:8},LIVES,FROG_SPEED,STREET_LANE_SPEED=[],STREET_SPEED_DECREASE_PER_LEVEL=[],STREET_LANE_OCCURENCE=[],STREET_OCCURENCE_DECREASE_PER_LEVEL=[],WATER_LANE_TIMESPEED=[],WATER_TIMESPEED_DECREASE_PER_LEVEL=[],WATER_LANE_OCCURENCE=[],WATER_OCCURENCE_INCREASE_PER_LEVEL=[],ENABLE_FULLSCREEN,ENABLE_CHECK_ORIENTATION;
function CPreloader(){var a,c,b,l,n,d,h,f,g,e;this._init=function(){s_oSpriteLibrary.init(this._onImagesLoaded,this._onAllImagesLoaded,this);s_oSpriteLibrary.addSprite("progress_bar","./sprites/progress_bar.png");s_oSpriteLibrary.addSprite("200x200","./sprites/200x200.jpg");s_oSpriteLibrary.addSprite("but_start","./sprites/but_start.png");s_oSpriteLibrary.loadSprites();e=new createjs.Container;s_oStage.addChild(e)};this.unload=function(){g.unload();e.removeAllChildren()};this._onImagesLoaded=function(){};
this._onAllImagesLoaded=function(){this.attachSprites();s_oMain.preloaderReady()};this.attachSprites=function(){var t=new createjs.Shape;t.graphics.beginFill("black").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);e.addChild(t);t=s_oSpriteLibrary.getSprite("200x200");h=createBitmap(t);h.regX=.5*t.width;h.regY=.5*t.height;h.x=CANVAS_WIDTH/2;h.y=CANVAS_HEIGHT/2-80;e.addChild(h);f=new createjs.Shape;f.graphics.beginFill("rgba(0,0,0,0.01)").drawRoundRect(h.x-100,h.y-100,200,200,10);e.addChild(f);h.mask=f;t=
s_oSpriteLibrary.getSprite("progress_bar");l=createBitmap(t);l.x=CANVAS_WIDTH/2-t.width/2;l.y=CANVAS_HEIGHT/2+70;e.addChild(l);a=t.width;c=t.height;n=new createjs.Shape;n.graphics.beginFill("rgba(0,0,0,0.01)").drawRect(l.x,l.y,1,c);e.addChild(n);l.mask=n;b=new createjs.Text("","30px "+PRIMARY_FONT,"#fff");b.x=CANVAS_WIDTH/2;b.y=CANVAS_HEIGHT/2+120;b.textBaseline="alphabetic";b.textAlign="center";e.addChild(b);t=s_oSpriteLibrary.getSprite("but_start");g=new CTextButton(CANVAS_WIDTH/2,CANVAS_HEIGHT/
2+100,t,TEXT_PRELOADER_CONTINUE,"Arial","#000","bold 36",e);g.addEventListener(ON_MOUSE_UP,this._onButStartRelease,this);g.setVisible(!1);d=new createjs.Shape;d.graphics.beginFill("black").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);e.addChild(d);createjs.Tween.get(d).to({alpha:0},500).call(function(){createjs.Tween.removeTweens(d);e.removeChild(d)})};this._onButStartRelease=function(){s_oMain._onRemovePreloader()};this.refreshLoader=function(t){b.text=t+"%";100===t&&(s_oMain._onRemovePreloader(),g.setVisible(!1),
b.visible=!1,l.visible=!1);n.graphics.clear();t=Math.floor(t*a/100);n.graphics.beginFill("rgba(0,0,0,0.01)").drawRect(l.x,l.y,t,c)};this._init()}
function CMain(a){var c,b=0,l=0,n=STATE_LOADING,d,h;this.initContainer=function(){s_oCanvas=document.getElementById("canvas");s_oStage=new createjs.Stage(s_oCanvas);s_oStage.preventSelection=!1;s_bMobile=isMobile();!1===s_bMobile?s_oStage.enableMouseOver(20):createjs.Touch.enable(s_oStage,!0);s_iPrevTime=(new Date).getTime();createjs.Ticker.addEventListener("tick",this._update);createjs.Ticker.framerate=FPS;navigator.userAgent.match(/Windows Phone/i)&&(DISABLE_SOUND_MOBILE=!0);s_oSpriteLibrary=new CSpriteLibrary;
d=new CPreloader};this.preloaderReady=function(){!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||s_oMain._initSounds();this._loadImages();c=!0};this.soundLoaded=function(){b++;d.refreshLoader(Math.floor(b/l*100))};this._initSounds=function(){Howler.mute(!s_bAudioActive);s_aSoundsInfo=[];s_aSoundsInfo.push({path:"./sounds/",filename:"fr_soundtrack",loop:!0,volume:1,ingamename:"soundtrack"});s_aSoundsInfo.push({path:"./sounds/",filename:"press_button",loop:!1,volume:1,ingamename:"click"});s_aSoundsInfo.push({path:"./sounds/",
filename:"fr_game_over",loop:!1,volume:1,ingamename:"game_over"});s_aSoundsInfo.push({path:"./sounds/",filename:"fr_frog_arrived",loop:!1,volume:1,ingamename:"frog_arrived"});s_aSoundsInfo.push({path:"./sounds/",filename:"fr_frog_death_road",loop:!1,volume:1,ingamename:"splat"});s_aSoundsInfo.push({path:"./sounds/",filename:"fr_frog_death_water",loop:!1,volume:1,ingamename:"drown"});s_aSoundsInfo.push({path:"./sounds/",filename:"fr_frog_jump",loop:!1,volume:1,ingamename:"jump"});s_aSoundsInfo.push({path:"./sounds/",
filename:"fr_power_up",loop:!1,volume:1,ingamename:"eat_fly"});s_aSoundsInfo.push({path:"./sounds/",filename:"fr_win_level",loop:!1,volume:1,ingamename:"win_level"});s_aSoundsInfo.push({path:"./sounds/",filename:"fr_horn_1",loop:!1,volume:1,ingamename:"big_hornet"});s_aSoundsInfo.push({path:"./sounds/",filename:"fr_horn_2",loop:!1,volume:1,ingamename:"small_hornet"});l+=s_aSoundsInfo.length;s_aSounds=[];for(var g=0;g<s_aSoundsInfo.length;g++)this.tryToLoadSound(s_aSoundsInfo[g],!1)};this.tryToLoadSound=
function(g,e){setTimeout(function(){s_aSounds[g.ingamename]=new Howl({src:[g.path+g.filename+".mp3"],autoplay:!1,preload:!0,loop:g.loop,volume:g.volume,onload:s_oMain.soundLoaded,onloaderror:function(t,v){for(var r=0;r<s_aSoundsInfo.length;r++)if(t===s_aSounds[s_aSoundsInfo[r].ingamename]._sounds[0]._id){s_oMain.tryToLoadSound(s_aSoundsInfo[r],!0);break}},onplayerror:function(t){for(var v=0;v<s_aSoundsInfo.length;v++)if(t===s_aSounds[s_aSoundsInfo[v].ingamename]._sounds[0]._id){s_aSounds[s_aSoundsInfo[v].ingamename].once("unlock",
function(){s_aSounds[s_aSoundsInfo[v].ingamename].play();"soundtrack"===s_aSoundsInfo[v].ingamename&&null!==s_oGame&&setVolume("soundtrack",SOUNDTRACK_VOLUME_IN_GAME)});break}}})},e?200:0)};this._loadImages=function(){s_oSpriteLibrary.init(this._onImagesLoaded,this._onAllImagesLoaded,this);s_oSpriteLibrary.addSprite("but_play","./sprites/but_play.png");s_oSpriteLibrary.addSprite("msg_box","./sprites/msg_box.png");s_oSpriteLibrary.addSprite("bg_menu","./sprites/bg_menu.jpg");s_oSpriteLibrary.addSprite("bg_game",
"./sprites/bg_game.png");s_oSpriteLibrary.addSprite("gui_panel_bottom","./sprites/gui_panel_bottom.png");s_oSpriteLibrary.addSprite("gui_panel_top","./sprites/gui_panel_top.png");s_oSpriteLibrary.addSprite("life","./sprites/life.png");s_oSpriteLibrary.addSprite("time_bar_frame","./sprites/time_bar_frame.png");s_oSpriteLibrary.addSprite("time_bar_fill","./sprites/time_bar_fill.png");s_oSpriteLibrary.addSprite("bg_help","./sprites/bg_help.png");s_oSpriteLibrary.addSprite("bg_help_desktop","./sprites/bg_help_desktop.png");
s_oSpriteLibrary.addSprite("but_exit","./sprites/but_exit.png");s_oSpriteLibrary.addSprite("audio_icon","./sprites/audio_icon.png");s_oSpriteLibrary.addSprite("but_up","./sprites/but_up.png");s_oSpriteLibrary.addSprite("but_down","./sprites/but_down.png");s_oSpriteLibrary.addSprite("but_left","./sprites/but_left.png");s_oSpriteLibrary.addSprite("but_right","./sprites/but_right.png");s_oSpriteLibrary.addSprite("skid_rows","./sprites/skid_rows.png");s_oSpriteLibrary.addSprite("bridge","./sprites/bridge.png");
s_oSpriteLibrary.addSprite("but_credits","./sprites/but_credits.png");s_oSpriteLibrary.addSprite("but_fullscreen","./sprites/but_fullscreen.png");s_oSpriteLibrary.addSprite("ctl_logo","./sprites/ctl_logo.png");for(var g,e=0;10>e;e++)g="water_anim_"+e,s_oSpriteLibrary.addSprite(g,"./sprites/"+g+".jpg");for(e=1;11>e;e++){g="car_"+e;var t="car_"+(e-1);s_oSpriteLibrary.addSprite(t,"./sprites/"+g+".png")}s_oSpriteLibrary.addSprite("trunk","./sprites/trunk.png");s_oSpriteLibrary.addSprite("turtle","./sprites/turtle.png");
s_oSpriteLibrary.addSprite("fly","./sprites/fly.png");s_oSpriteLibrary.addSprite("frog","./sprites/frog.png");l+=s_oSpriteLibrary.getNumSprites();s_oSpriteLibrary.loadSprites()};this._onImagesLoaded=function(){b++;d.refreshLoader(Math.floor(b/l*100))};this._onAllImagesLoaded=function(){};this._onRemovePreloader=function(){d.unload();playSound("soundtrack",1,!0);this.gotoMenu()};this.gotoMenu=function(){new CMenu;n=STATE_MENU};this.gotoGame=function(g){s_bEasyMode=g;h=new CGame(f);n=STATE_GAME;document.dispatchEvent(new CustomEvent("game_start"))};
this.gotoHelp=function(){new CHelp;n=STATE_HELP};this.stopUpdate=function(){c=!1;createjs.Ticker.paused=!0;document.querySelector("#block_game").style.display="block";Howler.mute(!0)};this.startUpdate=function(){s_iPrevTime=(new Date).getTime();c=!0;createjs.Ticker.paused=!1;document.querySelector("#block_game").style.display="none";s_bAudioActive&&Howler.mute(!1)};this._update=function(g){if(!1!==c){var e=(new Date).getTime();s_iTimeElaps=e-s_iPrevTime;s_iCntTime+=s_iTimeElaps;s_iCntFps++;s_iPrevTime=
e;1E3<=s_iCntTime&&(s_iCurFps=s_iCntFps,s_iCntTime-=1E3,s_iCntFps=0);n===STATE_GAME&&h.update();s_oStage.update(g)}};s_oMain=this;var f=a;ENABLE_FULLSCREEN=a.fullscreen;ENABLE_CHECK_ORIENTATION=a.check_orientation;this.initContainer()}var s_bMobile,s_bEasyMode,s_bAudioActive=!1,s_bFullscreen=!1,s_iCntTime=0,s_iTimeElaps=0,s_iPrevTime=0,s_iCntFps=0,s_iCurFps=0,s_iCurLevel=0,s_iScore=0,s_oDrawLayer,s_oStage,s_oMain,s_oSpriteLibrary,s_oCanvas;
function CTextButton(a,c,b,l,n,d,h,f){var g,e,t,v,r,u,w,y,D,I;this._init=function(m,F,G,A,B,z,x){g=!1;e=1;t=[];v=[];I=createBitmap(G);y=new createjs.Container;y.x=m;y.y=F;y.regX=G.width/2;y.regY=G.height/2;s_bMobile||(y.cursor="pointer");y.addChild(I);f.addChild(y);D=new CTLText(y,40,20,G.width-80,G.height-40,x,"center",z,B,1,2,2,A,!0,!0,!1,!1);D.setShadow("#000",2,2,5);this._initListener()};this.unload=function(){y.off("mousedown",r);y.off("pressup",u);f.removeChild(y)};this.setVisible=function(m){y.visible=
m};this.setAlign=function(m){D.textAlign=m};this.setTextX=function(m){D.x=m};this.setScale=function(m){e=y.scaleX=y.scaleY=m};this.enable=function(){g=!1};this.disable=function(){g=!0};this._initListener=function(){r=y.on("mousedown",this.buttonDown);u=y.on("pressup",this.buttonRelease)};this.addEventListener=function(m,F,G){t[m]=F;v[m]=G};this.addEventListenerWithParams=function(m,F,G,A){t[m]=F;v[m]=G;w=A};this.buttonRelease=function(){g||(playSound("click",1,!1),y.scaleX=e,y.scaleY=e,t[ON_MOUSE_UP]&&
t[ON_MOUSE_UP].call(v[ON_MOUSE_UP],w))};this.buttonDown=function(){g||(y.scaleX=.9*e,y.scaleY=.9*e,t[ON_MOUSE_DOWN]&&t[ON_MOUSE_DOWN].call(v[ON_MOUSE_DOWN]))};this.setPosition=function(m,F){y.x=m;y.y=F};this.tweenPosition=function(m,F,G,A,B,z,x){createjs.Tween.get(y).wait(A).to({x:m,y:F},G,B).call(function(){void 0!==z&&z.call(x)})};this.changeText=function(m){D.refreshText(m)};this.setX=function(m){y.x=m};this.setY=function(m){y.y=m};this.getButtonImage=function(){return y};this.getX=function(){return y.x};
this.getY=function(){return y.y};this.getSprite=function(){return y};this.getScale=function(){return y.scaleX};this._init(a,c,b,l,n,d,h)}
function CToggle(a,c,b,l,n){var d,h,f,g,e,t,v;this._init=function(r,u,w,y,D){v=void 0!==D?D:s_oStage;h=[];f=[];D=new createjs.SpriteSheet({images:[w],frames:{width:w.width/2,height:w.height,regX:w.width/2/2,regY:w.height/2},animations:{state_true:[0],state_false:[1]}});d=y;g=createSprite(D,"state_"+d,w.width/2/2,w.height/2,w.width/2,w.height);g.x=r;g.y=u;g.stop();s_bMobile||(g.cursor="pointer");v.addChild(g);this._initListener()};this.unload=function(){g.off("mousedown",e);g.off("pressup",t);v.removeChild(g)};
this._initListener=function(){e=g.on("mousedown",this.buttonDown);t=g.on("pressup",this.buttonRelease)};this.addEventListener=function(r,u,w){h[r]=u;f[r]=w};this.setCursorType=function(r){g.cursor=r};this.setActive=function(r){d=r;g.gotoAndStop("state_"+d)};this.buttonRelease=function(){g.scaleX=1;g.scaleY=1;playSound("click",1,!1);d=!d;g.gotoAndStop("state_"+d);h[ON_MOUSE_UP]&&h[ON_MOUSE_UP].call(f[ON_MOUSE_UP],d)};this.buttonDown=function(){g.scaleX=.9;g.scaleY=.9;h[ON_MOUSE_DOWN]&&h[ON_MOUSE_DOWN].call(f[ON_MOUSE_DOWN])};
this.setPosition=function(r,u){g.x=r;g.y=u};this._init(a,c,b,l,n)}
function CGfxButton(a,c,b,l){var n,d,h,f,g;this._init=function(e,t,v){n=[];d=[];g=createBitmap(v);g.x=e;g.y=t;g.regX=v.width/2;g.regY=v.height/2;g.cursor="pointer";s_oStage.addChild(g);this._initListener()};this.unload=function(){g.off("mousedown",h);g.off("pressup",f);s_oStage.removeChild(g)};this.setVisible=function(e){g.visible=e};this._initListener=function(){h=g.on("mousedown",this.buttonDown);f=g.on("pressup",this.buttonRelease)};this.addEventListener=function(e,t,v){n[e]=t;d[e]=v};this.buttonRelease=
function(){g.scaleX=1;g.scaleY=1;playSound("click",1,!1);n[ON_MOUSE_UP]&&n[ON_MOUSE_UP].call(d[ON_MOUSE_UP])};this.buttonDown=function(){g.scaleX=.9;g.scaleY=.9;n[ON_MOUSE_DOWN]&&n[ON_MOUSE_DOWN].call(d[ON_MOUSE_DOWN])};this.setPosition=function(e,t){g.x=e;g.y=t};this.setX=function(e){g.x=e};this.setY=function(e){g.y=e};this.getButtonImage=function(){return g};this.getX=function(){return g.x};this.getY=function(){return g.y};this._init(a,c,b);return this}
function CMenu(){var a,c,b,l,n,d,h,f,g,e,t,v,r=null,u=null;this._init=function(){h=createBitmap(s_oSpriteLibrary.getSprite("bg_menu"));s_oStage.addChild(h);var w=s_oSpriteLibrary.getSprite("but_play");f=new CTextButton(CANVAS_WIDTH/2,CANVAS_HEIGHT-200,w,TEXT_PLAY,PRIMARY_FONT,"#fcff00",40,s_oStage);f.addEventListener(ON_MOUSE_UP,this._onButPlayRelease,this);w=s_oSpriteLibrary.getSprite("but_credits");a=w.width/2+10;c=w.height/2+10;t=new CGfxButton(CANVAS_WIDTH/2,CANVAS_HEIGHT-240,w,s_oStage);t.addEventListener(ON_MOUSE_UP,
this._onCreditsBut,this);if(!1===DISABLE_SOUND_MOBILE||!1===s_bMobile)w=s_oSpriteLibrary.getSprite("audio_icon"),n=CANVAS_WIDTH-w.height/2-5,d=w.height/2+5,e=new CToggle(n,d,w,s_bAudioActive,s_oStage),e.addEventListener(ON_MOUSE_UP,this._onAudioToggle,this);w=window.document;var y=w.documentElement;r=y.requestFullscreen||y.mozRequestFullScreen||y.webkitRequestFullScreen||y.msRequestFullscreen;u=w.exitFullscreen||w.mozCancelFullScreen||w.webkitExitFullscreen||w.msExitFullscreen;!1===ENABLE_FULLSCREEN&&
(r=!1);r&&screenfull.isEnabled&&(w=s_oSpriteLibrary.getSprite("but_fullscreen"),b=a+w.width/2+10,l=w.height/2+10,v=new CToggle(b,l,w,s_bFullscreen,s_oStage),v.addEventListener(ON_MOUSE_UP,this._onFullscreenRelease,this));g=new createjs.Shape;g.graphics.beginFill("black").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);s_oStage.addChild(g);createjs.Tween.get(g).to({alpha:0},1E3).call(function(){g.visible=!1});this.refreshButtonPos(s_iOffsetX,s_iOffsetY)};this.refreshButtonPos=function(w,y){!1!==DISABLE_SOUND_MOBILE&&
!1!==s_bMobile||e.setPosition(n-w,y+d);t.setPosition(a+w,y+c);r&&screenfull.isEnabled&&v.setPosition(b+w,l+y)};this.unload=function(){f.unload();f=null;t.unload();if(!1===DISABLE_SOUND_MOBILE||!1===s_bMobile)e.unload(),e=null;r&&screenfull.isEnabled&&v.unload();s_oStage.removeChild(h);s_oMenu=h=null};this._onAudioToggle=function(){Howler.mute(s_bAudioActive);s_bAudioActive=!s_bAudioActive};this._onCreditsBut=function(){new CCreditsPanel};this._onButPlayRelease=function(){this.unload();document.dispatchEvent(new CustomEvent("start_session"));
document.dispatchEvent(new CustomEvent("start_level",{detail:{level:1}}));s_oMain.gotoGame()};this.resetFullscreenBut=function(){r&&screenfull.isEnabled&&v.setActive(s_bFullscreen)};this._onFullscreenRelease=function(){s_bFullscreen?u.call(window.document):r.call(window.document.documentElement);sizeHandler()};s_oMenu=this;this._init()}var s_oMenu=null;
function CGame(a){var c,b,l,n;function d(k){f&&(e=!1,k.preventDefault())}function h(k){k||(k=window.event);if(!e)switch(e=!0,k.preventDefault(),k.keyCode){case 37:s_oGame.onLeftPress();break;case 38:s_oGame.onUpPress();break;case 39:s_oGame.onRightPress();break;case 40:s_oGame.onDownPress()}}var f,g,e,t,v,r,u,w,y,D,I,m,F,G,A,B,z,x,aa,R,Q,S=null,T,H,W,Y,O,X,p,V,Z,L;this._init=function(){e=g=!0;s_iScore=0;r=LIVES;R=[];D=SINK_TURTLE_OCCURRENCY;s_iCurLevel=0;setVolume("soundtrack",SOUNDTRACK_VOLUME_IN_GAME);
u=17;w=15;l=(CANVAS_WIDTH-11-2*EDGEBOARD_X)/u;n=(CANVAS_HEIGHT-386)/w;var k=5.5+l/2+EDGEBOARD_X;m=[];for(var q=0;q<w;q++){m[q]=[];for(var E=0;E<u;E++)m[q][E]={x:k+l*E,y:808-n*q}}Y=new createjs.Container;s_oStage.addChild(Y);X=new createjs.Container;s_oStage.addChild(X);O=new createjs.Container;s_oStage.addChild(O);k=createBitmap(s_oSpriteLibrary.getSprite("bg_game"));s_oStage.addChild(k);V=new createjs.Container;s_oStage.addChild(V);p=new createjs.Container;s_oStage.addChild(p);k=s_oSpriteLibrary.getSprite("bridge");
q=createBitmap(k);s_oStage.addChild(q);k=createBitmap(k);k.scaleY=-1;k.scaleX=-1;k.x=CANVAS_WIDTH;k.y=CANVAS_HEIGHT-140;s_oStage.addChild(k);Q=new CInterface;this._initLevel();new CHelpPanel;L=new Hammer(s_oCanvas);L.get("swipe").set({direction:Hammer.DIRECTION_ALL});L.get("swipe").set({velocity:.01});L.get("swipe").set({threshold:5});L.on("swipeleft",function(M){s_oGame.onLeftPress(s_oStage.mouseY)});L.on("swiperight",function(){s_oGame.onRightPress(s_oStage.mouseY)});L.on("swipeup",function(){s_oGame.onUpPress(s_oStage.mouseY)});
L.on("swipedown",function(){s_oGame.onDownPress(s_oStage.mouseY)});if(!1===s_bMobile)document.onkeydown=h,document.onkeyup=d;else L.on("tap",function(){s_oGame.onUpPress(s_oStage.mouseY)})};this._initLevel=function(){g=e=v=t=f=!1;I=y=0;T=new CWater(220,m[9][0].y,n,s_iCurLevel,Y);W=new CStreet(m[3][0].y,n,s_iCurLevel);F=[];for(var k=0;5>k;k++)F[k]=W.getLaneInfo(k).occur;G=[];for(k=0;5>k;k++)G[k]=T.getLaneInfo(k).occur;document.dispatchEvent(new CustomEvent("start_level",{detail:{level:s_iCurLevel+
1}}));A=[];for(k=0;k<STREET_LANE_OCCURENCE.length;k++){var q=Math.random()*CANVAS_WIDTH/2;var E=Math.floor(10*Math.random());A.push(new CCar(W.getLaneInfo(k),E,p));A[k].instantCar(q+CANVAS_WIDTH/4,W.getLaneInfo(k).pos)}B=[];z=[,,"free",,,"free",,,"free",,,"free",,,"free"];x=[];aa=[];R[0]=D;R[1]=D;c=FROG_STARTING_LOGIC_POS.row;b=FROG_STARTING_LOGIC_POS.col;H=new CFrog(m[c][b].x,m[c][b].y,V)};this.onUpPress=function(k){100>k||g||(g=!0,k=H.getPos().y-V_MOVE,k<m[w-1][0].y&&(k=m[w-1][0].y),H.move(H.getPos().x,
k,"up",k))};this.onDownPress=function(k){100>k||g||(g=!0,k=H.getPos().y+V_MOVE,k>m[0][0].y&&(k=m[0][0].y),H.move(H.getPos().x,k,"down",k))};this.onLeftPress=function(k){100>k||g||(g=!0,k=H.getPos().x-H_MOVE,k<m[0][0].x&&(k=m[0][0].x),H.move(k,H.getPos().y,"left",k))};this.onRightPress=function(k){100>k||g||(g=!0,k=H.getPos().x+H_MOVE,k>m[0][u-1].x&&(k=m[0][u-1].x),H.move(k,H.getPos().y,"right",k))};this.updateLogicPos=function(){for(var k=0;k<w;k++)for(var q=0;q<u;q++)H.getPos().x>=m[k][q].x-l/2&&
H.getPos().x<=m[k][q].x+l/2&&(b=q),H.getPos().y>=m[k][q].y-n/2&&H.getPos().y<=m[k][q].y+n/2&&(c=k);g=!1;8<c&&14>c&&!g&&this._checkFrogInWater()};this.updateScore=function(k){s_iScore+=k;0>s_iScore&&(s_iScore=0);Q.refreshScore(s_iScore)};this.unload=function(){Q.unload();null!==S&&S.unload();for(var k=0;k<A.length;k++)A[k].unload();for(k=0;k<B.length;k++)B[k].unload();L.off("swipeleft",function(){s_oGame.onLeftPress(s_oStage.mouseY)});L.off("swiperight",function(){s_oGame.onRightPress(s_oStage.mouseY)});
L.off("swipeup",function(){s_oGame.onUpPress(s_oStage.mouseY)});L.off("swipedown",function(){s_oGame.onDownPress(s_oStage.mouseY)});s_bMobile?L.off("tap",function(){s_oGame.onUpPress()}):s_oStage.off("click",function(){s_oGame.onUpPress()});createjs.Tween.removeAllTweens();s_oStage.removeAllChildren()};this.onExit=function(){setVolume("soundtrack",1);this.unload();s_oMain.gotoMenu()};this._onExitHelp=function(){v=f=!0;g=e=!1;Q.refreshBar()};this.gameOver=function(){setVolume("soundtrack",.3);for(var k=
0;k<B.length;k++)B[k].stopAnim();v=!1;createjs.Tween.removeAllTweens();S=new CEndPanel(s_oSpriteLibrary.getSprite("msg_box"));S.show(s_iScore)};this._updateLives=function(k){"add"===k?r++:r--;Q.refreshLives(r);0===r&&(H.setTextVisible(!1),this.gameOver())};this.reset=function(){for(var k=0;k<A.length;k++)A[k].unload();for(k=0;k<B.length;k++)B[k].unload();for(k=0;k<aa.length;k++)aa[k].unload();0===s_iCurLevel%NUM_LEVEL_INCREASE_SINK&&D--;0>D&&(D=0);Q.refreshBar();this._initLevel();f=v=!0};this._checkNewLevel=
function(){y++;5===y&&(document.dispatchEvent(new CustomEvent("end_level",{detail:{level:s_iCurLevel+1}})),document.dispatchEvent(new CustomEvent("save_score",{detail:{score:s_iScore}})),document.dispatchEvent(new CustomEvent("show_interlevel_ad")),s_iCurLevel++,H.setTextVisible(!1),Q.stopBar(),f=!1,e=g=!0,(new CLevelPanel(s_iCurLevel)).show(s_iScore))};this.addElemToRemoveList=function(k){if("car"===k.getType())for(var q=0;q<A.length;q++){if(A[q]===k){var E=q;var M="car"}}else for(q=0;q<B.length;q++)B[q]===
k&&(E=q,M="support");x.push({elem:k,index:E,type:M})};this.freeCell=function(k){z[k]="free"};this._generateFly=function(){I+=s_iTimeElaps;if(I>TIME_FLY_TO_SPAWN){I=0;for(var k=[],q=0;q<z.length;q++)"free"===z[q]&&k.push(q);0<k.length&&(shuffle(k),Z=new CFly(m[14][k[0]].x,m[14][k[0]].y,k[0]),z[k[0]]="fly")}};this._generateNewFrog=function(){0!==r&&(c=FROG_STARTING_LOGIC_POS.row,b=FROG_STARTING_LOGIC_POS.col,H=new CFrog(m[c][b].x,m[c][b].y,V),Q.refreshBar(),f=!0,g=!1)};this._generateCar=function(){for(var k=
0;k<F.length;k++)if(F[k]+=s_iTimeElaps,F[k]>W.getLaneInfo(k).occur){F[k]=0;var q=Math.floor(10*Math.random());A.push(new CCar(W.getLaneInfo(k),q,p));A[A.length-1].playHornet(c)}};this._generateSupport=function(){for(var k=0;k<G.length;k++)if(G[k]+=s_iTimeElaps,G[k]>T.getLaneInfo(k).occur)if(G[k]=0,0===k){if(0===R[0]){for(var q=0;q<NUM_CONSECUTIVE_TURTLE_0;q++)B.push(new CTurtle(T.getLaneInfo(k),1,q*TURTLE_OFFSET,O));R[0]=D+1}else for(q=0;q<NUM_CONSECUTIVE_TURTLE_0;q++)B.push(new CTurtle(T.getLaneInfo(k),
0,q*TURTLE_OFFSET,O));R[0]--}else if(3===k){if(0===R[1]){for(q=0;q<NUM_CONSECUTIVE_TURTLE_3;q++)B.push(new CTurtle(T.getLaneInfo(k),1,q*TURTLE_OFFSET,O));R[1]=D+1}else for(q=0;q<NUM_CONSECUTIVE_TURTLE_3;q++)B.push(new CTurtle(T.getLaneInfo(k),0,q*TURTLE_OFFSET,O));R[1]--}else B.push(new CTrunk(T.getLaneInfo(k),O))};this._checkFrogInWater=function(){for(var k=H.getLogicRect(),q=0;q<B.length;q++)if(null!==B[q].getLogicRect()&&B[q].getLogicRect().intersects(k)){var E=B[q].getSpeed();H.getPos().x>=m[0][0].x&&
H.getPos().x<=m[0][16].x?H.carry(E):H.getPos().x<m[0][0].x?H.setPos(m[0][0].x,H.getPos().y):H.setPos(m[0][16].x,H.getPos().y);t=!0}t||(g=!0,this._updateLives("sub"),H.drown(),H.unload(),X.addChild(H.getContainer()),f=!1,this._generateNewFrog(),this.updateScore(SCORE_DEATH))};this.update=function(){if(f){var k=H.getLogicRect();if(14===c)"free"===z[b]||"fly"===z[b]?(playSound("frog_arrived",1,!1),k=!1,"fly"===z[b]&&(playSound("eat_fly",1,!1),k=!0,Z.unload()),k?this.updateScore(SCORE_WITH_FLY):this.updateScore(SCORE_IN_NEST),
this._checkNewLevel(),z[b]="taken",H.setPos(m[c][b].x,m[c][b].y),c=0,aa.push(H),H.great(),5>y&&this._generateNewFrog()):"taken"===z[b]?(H.unload(),this._generateNewFrog()):(H.crash(),this._updateLives("sub"),f=!1,this._generateNewFrog(),this.updateScore(SCORE_DEATH));else if(8<c&&14>c&&!g)this._checkFrogInWater();else for(var q=0;q<A.length;q++)A[q].getLogicRect().intersects(k)&&(g=!0,this._updateLives("sub"),f=!1,H.splat(),this._generateNewFrog(),this.updateScore(SCORE_DEATH));t=!1}if(v){this._generateCar();
this._generateSupport();this._generateFly();T.update();for(q=0;q<A.length;q++)A[q].update();for(q=0;q<B.length;q++)B[q].update();x.sort(compare);for(q=0;q<x.length;q++)x[q].elem.unload(),"car"===x[q].type?A.splice(x[q].index,1):B.splice(x[q].index,1);x=[]}};s_oGame=this;LIVES=a.lives;LEVEL_TIME=a.crossing_time;SCORE_IN_NEST=a.score_in_nest;SCORE_WITH_FLY=a.score_with_fly;SCORE_DEATH=a.score_death;FROG_SPEED=a.frog_speed;SINK_TURTLE_OCCURRENCY=a.sink_turtle_occurrency;NUM_LEVEL_INCREASE_SINK=a.num_level_increase_sink;
TIME_FLY_TO_SPAWN=a.time_fly_to_spawn;TIME_FLY_TO_DISAPPEAR=a.time_fly_to_disappear;STREET_LANE_TIMESPEED=a.street_lane_timespeed;STREET_TIMESPEED_DECREASE_PER_LEVEL=a.street_timespeed_decrease_per_level;STREET_LANE_OCCURENCE=a.street_lane_occurrence;STREET_OCCURENCE_DECREASE_PER_LEVEL=a.street_occurrence_decrease_per_level;WATER_LANE_TIMESPEED=a.water_lane_timespeed;WATER_TIMESPEED_DECREASE_PER_LEVEL=a.water_timespeed_decrease_per_level;WATER_LANE_OCCURENCE=a.water_lane_occurrence;WATER_OCCURENCE_INCREASE_PER_LEVEL=
a.water_occurrence_increase_per_level;this._init()}var s_oGame;
function CInterface(){var a,c,b,l,n,d,h,f,g,e,t=null,v,r,u,w,y,D,I,m,F,G,A=null,B=null;this._init=function(){var z=s_oSpriteLibrary.getSprite("gui_panel_top"),x=createBitmap(z);s_oStage.addChild(x);z=s_oSpriteLibrary.getSprite("but_exit");h=CANVAS_WIDTH-z.height/2-5;f=z.height/2+5;e=new CGfxButton(h,f,z,s_oStage);e.addEventListener(ON_MOUSE_UP,this._onExit,this);x=CANVAS_WIDTH-z.width/2-70;!1===DISABLE_SOUND_MOBILE||!1===s_bMobile?(n=x,d=z.height/2+5,z=s_oSpriteLibrary.getSprite("audio_icon"),g=new CToggle(n,
d,z,s_bAudioActive,s_oStage),g.addEventListener(ON_MOUSE_UP,this._onAudioToggle,this),a=n-z.width/2-10):a=x;c=z.height/2+5;x=window.document;z=x.documentElement;A=z.requestFullscreen||z.mozRequestFullScreen||z.webkitRequestFullScreen||z.msRequestFullscreen;B=x.exitFullscreen||x.mozCancelFullScreen||x.webkitExitFullscreen||x.msExitFullscreen;!1===ENABLE_FULLSCREEN&&(A=!1);A&&screenfull.isEnabled&&(z=s_oSpriteLibrary.getSprite("but_fullscreen"),G=new CToggle(a,c,z,s_bFullscreen,s_oStage),G.addEventListener(ON_MOUSE_UP,
this._onFullscreenRelease,this));F=new createjs.Container;l=b=14;F.x=b;F.y=l;s_oStage.addChild(F);z=s_oSpriteLibrary.getSprite("life");x=createBitmap(z);F.addChild(x);I=new createjs.Text("X"+LIVES,"40px "+PRIMARY_FONT,"#fcff00");I.x=56;I.y=34;I.textAlign="left";I.textBaseline="alphabetic";I.lineWidth=200;F.addChild(I);z=s_oSpriteLibrary.getSprite("gui_panel_bottom");m=createBitmap(z);m.regY=z.height;m.y=CANVAS_HEIGHT;s_oStage.addChild(m);x=new createjs.Container;x.x=370;x.y=940;s_oStage.addChild(x);
w=new createjs.Text(TEXT_TIME,"40px "+PRIMARY_FONT,"#fcff00");w.x=10;w.y=0;w.textAlign="left";w.textBaseline="alphabetic";w.lineWidth=200;x.addChild(w);z=new createjs.Text(TEXT_TIME,"40px "+PRIMARY_FONT,"#000000");z.x=10;z.y=0;z.textAlign="left";z.textBaseline="alphabetic";z.lineWidth=200;z.outline=3;x.addChild(z);z=s_oSpriteLibrary.getSprite("time_bar_fill");y=createBitmap(z);y.x=10;y.y=18;x.addChild(y);D=new createjs.Shape;D.graphics.beginFill("rgba(255,0,0,0.01)").drawRect(0,0,z.width,z.height);
D.x=10;D.y=18;x.addChild(D);y.mask=D;z=s_oSpriteLibrary.getSprite("time_bar_frame");z=createBitmap(z);z.x=7;z.y=15;x.addChild(z);v=new createjs.Text(TEXT_SCORE,"40px "+PRIMARY_FONT,"#fcff00");v.x=10;v.y=110;v.textAlign="left";v.textBaseline="alphabetic";v.lineWidth=200;x.addChild(v);z=new createjs.Text(TEXT_SCORE,"40px "+PRIMARY_FONT,"#000000");z.x=10;z.y=110;z.textAlign="left";z.textBaseline="alphabetic";z.lineWidth=200;z.outline=3;x.addChild(z);r=new createjs.Text("0","36px "+PRIMARY_FONT,"#fcff00");
r.x=10;r.y=155;r.textAlign="left";r.textBaseline="alphabetic";r.lineWidth=200;x.addChild(r);u=new createjs.Text("0","36px "+PRIMARY_FONT,"#000000");u.x=10;u.y=155;u.textAlign="left";u.textBaseline="alphabetic";u.lineWidth=200;u.outline=3;x.addChild(u);this.refreshButtonPos(s_iOffsetX,s_iOffsetY)};this.refreshButtonPos=function(z,x){e.setPosition(h-z,x+f);!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||g.setPosition(n-z,x+d);A&&screenfull.isEnabled&&G.setPosition(a-z,c+x);F.x=b+z;F.y=x+l};this.unload=function(){if(!1===
DISABLE_SOUND_MOBILE||!1===s_bMobile)g.unload(),g=null;A&&screenfull.isEnabled&&G.unload();e.unload();s_oInterface=null};this.refreshScore=function(z){r.text=z;u.text=z};this.refreshLives=function(z){I.text="X"+z};this.refreshBar=function(){D.scaleX=1;createjs.Tween.get(D,{override:!0}).to({scaleX:0},LEVEL_TIME,createjs.Ease.linear).call(function(){s_oGame.gameOver()})};this.stopBar=function(){createjs.Tween.removeTweens(D)};this._onButHelpRelease=function(){t=new CHelpPanel};this._onButRestartRelease=
function(){s_oGame.restartGame()};this.onExitFromHelp=function(){t.unload()};this._onAudioToggle=function(){Howler.mute(s_bAudioActive);s_bAudioActive=!s_bAudioActive};this.resetFullscreenBut=function(){A&&screenfull.isEnabled&&G.setActive(s_bFullscreen)};this._onFullscreenRelease=function(){s_bFullscreen?B.call(window.document):A.call(window.document.documentElement);sizeHandler()};this._onExit=function(){document.dispatchEvent(new CustomEvent("end_level",{detail:{level:s_iCurLevel+1}}));document.dispatchEvent(new CustomEvent("share_event",
{detail:{score:s_iScore}}));document.dispatchEvent(new CustomEvent("end_session"));s_oGame.onExit()};s_oInterface=this;this._init();return this}var s_oInterface=null;
function CHelpPanel(){var a,c,b,l,n,d,h;this._init=function(){if(!1===s_bMobile){n=TEXT_HELP1;var f=s_oSpriteLibrary.getSprite("bg_help_desktop")}else n=TEXT_HELP_MOB1,f=s_oSpriteLibrary.getSprite("bg_help");h=new createjs.Container;h.on("pressup",function(){g._onExitHelp()});s_oStage.addChild(h);d=createBitmap(f);h.addChild(d);f=150;a=new CTLText(h,290,280-f/2,380,f,22,"left","#fcff00",PRIMARY_FONT,1.2,2,2,n,!0,!0,!0,!1);a.setShadow("#000",2,2,5);f=100;c=new CTLText(h,540,420-f/2,250,f,22,"left",
"#fcff00",PRIMARY_FONT,1.2,2,2,TEXT_HELP2,!0,!0,!0,!1);c.setShadow("#000",2,2,5);f=100;b=new CTLText(h,290,580-f/2,250,f,22,"left","#fcff00",PRIMARY_FONT,1.2,2,2,TEXT_HELP3,!0,!0,!0,!1);b.setShadow("#000",2,2,5);f=100;l=new CTLText(h,440,710-f/2,360,f,22,"left","#fcff00",PRIMARY_FONT,1.2,2,2,TEXT_HELP4,!0,!0,!0,!1);l.setShadow("#000",2,2,5);var g=this};this.unload=function(){s_oStage.removeChild(h);h.removeAllEventListeners()};this._onExitHelp=function(){this.unload();s_oGame._onExitHelp()};this._init()}
function CEndPanel(a){var c,b,l,n;this._init=function(d){c=createBitmap(d);c.x=0;c.y=0;b=new createjs.Container;b.alpha=0;b.visible=!1;b.addChild(c);d=500;var h=70,f=CANVAS_WIDTH/2,g=CANVAS_HEIGHT/2-164;l=new CTLText(b,f-d/2,g-h/2,d,h,60,"center","#fcff00",PRIMARY_FONT,1.2,2,2," ",!0,!0,!1,!1);l.setShadow("#000",4,4,5);d=500;h=50;f=CANVAS_WIDTH/2;g=CANVAS_HEIGHT/2+50;n=new CTLText(b,f-d/2,g-h/2,d,h,40,"center","#fcff00",PRIMARY_FONT,1.2,2,2," ",!0,!0,!1,!1);n.setShadow("#000",4,4,5);s_oStage.addChild(b)};
this.unload=function(){b.removeAllEventListeners()};this._initListener=function(){b.on("mousedown",this._onExit)};this.show=function(d){playSound("game_over",1,!1);l.refreshText(TEXT_GAMEOVER);n.refreshText(TEXT_SCORE+": "+d);b.visible=!0;var h=this;createjs.Tween.get(b).to({alpha:1},500).call(function(){h._initListener()});document.dispatchEvent(new CustomEvent("save_score",{detail:{score:d}}));document.dispatchEvent(new CustomEvent("end_level",{detail:{level:s_iCurLevel}}));document.dispatchEvent(new CustomEvent("share_event",
{detail:{score:d}}))};this._onExit=function(){b.removeAllEventListeners();s_oStage.removeChild(b);document.dispatchEvent(new CustomEvent("show_interlevel_ad"));document.dispatchEvent(new CustomEvent("end_session"));s_oGame.onExit()};this._init(a);return this}
function CWinText(a,c,b,l){var n,d,h;this._init=function(f,g,e,t){h=new createjs.Container;h.x=g;h.y=e-60;h.alpha=0;h.visible=t;s_oStage.addChild(h);n=new createjs.Text("","30px "+PRIMARY_FONT,"#fcff00");n.textAlign="center";n.text=f;n.textBaseline="alphabetic";h.addChild(n);d=new createjs.Text("","30px "+PRIMARY_FONT,"#000000");d.textAlign="center";d.text=f;d.outline=3;d.textBaseline="alphabetic";h.addChild(d)};this.great=function(){h.scaleX=0;h.scaleY=0;h.alpha=1;var f=this;createjs.Tween.get(h).to({scaleX:1,
scaleY:1},100,createjs.Ease.linear).wait(2E3).call(function(){f.unload()})};this.splat=function(){var f=this;createjs.Tween.get(h).to({alpha:1},300,createjs.Ease.linear).to({alpha:0},2E3,createjs.Ease.cubicIn).call(function(){f.unload()})};this.crash=function(){var f=this;createjs.Tween.get(h).to({alpha:1},300,createjs.Ease.linear).to({alpha:0},2E3,createjs.Ease.cubicIn).call(function(){f.unload()})};this.drown=function(){h.scaleX=0;h.scaleY=0;h.alpha=0;h.y=b;var f=this;createjs.Tween.get(h).to({alpha:1},
2500,createjs.Ease.linear).to({alpha:0},2500,createjs.Ease.linear);createjs.Tween.get(h).to({scaleX:1,scaleY:1},5E3,createjs.Ease.linear).call(function(){f.unload()})};this.unload=function(){s_oStage.removeChild(h)};this._init(a,c,b,l)}
function CFrog(a,c,b){var l,n,d,h,f,g,e,t,v;this._init=function(r,u,w){h=d=!1;f=!0;g=FROG_SPEED;l=10;n=25;v=new createjs.Container;v.x=r;v.y=u;w.addChild(v);r={images:[s_oSpriteLibrary.getSprite("frog")],frames:{width:50,height:75,regX:25,regY:37.5},animations:{idle:[0],jump:[1,5,"idle"],splat:[6],drown:[7,44,"drown_stop"],drown_stop:[44],skid_marks:[45]}};r=new createjs.SpriteSheet(r);e=createSprite(r,"jump",0,0,50,75);v.addChild(e);t=createBitmap(s_oSpriteLibrary.getSprite("skid_rows"));t.regX=
25;t.regY=37.5;t.visible=!1;v.addChild(t)};this.unload=function(){b.removeChild(v)};this._disappear=function(){var r=this;createjs.Tween.get(v).wait(2E3).to({alpha:0},2E3,createjs.Ease.linear).call(function(){r.unload()})};this.move=function(r,u,w,y){h=!0;playSound("jump",1,!1);switch(w){case "up":e.rotation=0;break;case "down":e.rotation=180;break;case "left":e.rotation=270;break;case "right":e.rotation=90}e.gotoAndPlay("jump");createjs.Tween.get(v).to({x:r,y:u},g,createjs.Ease.linear).call(function(){s_oGame.updateLogicPos();
h=!1});createjs.Tween.get(v).to({scaleX:1.5,scaleY:1.5},g/2,createjs.Ease.quintIn).to({scaleX:1,scaleY:1},g/2,createjs.Ease.quintIn)};this.isJumping=function(){return h};this.setTextVisible=function(r){f=r};this.drown=function(){playSound("drown",1,!1);d=!0;e.gotoAndPlay("drown");(new CWinText(TEXT_DROWN,this.getPos().x,this.getPos().y,f)).drown();this._disappear()};this.splat=function(){playSound("splat",1,!1);e.gotoAndPlay("splat");d=t.visible=!0;(new CWinText(TEXT_SPLAT,this.getPos().x,this.getPos().y,
f)).splat();this._disappear()};this.crash=function(){playSound("splat",1,!1);e.gotoAndPlay("splat");d=!0;(new CWinText(TEXT_SPLAT,this.getPos().x,this.getPos().y,f)).splat();this._disappear()};this.great=function(){(new CWinText(TEXT_GREAT,this.getPos().x,this.getPos().y,f)).great()};this.getDead=function(){return d};this.setPos=function(r,u){v.x=r;v.y=u};this.getPos=function(){return{x:v.x,y:v.y}};this.getContainer=function(){return v};this.getLogicRect=function(){return new createjs.Rectangle(v.x-
l/2,v.y-n/2,l,n)};this.carry=function(r){v.x+=r};this._init(a,c,b)}
function CWater(a,c,b,l,n){var d,h,f,g,e,t,v,r;this._init=function(u,w,y,D,I){d=!0;h=0;f=9;t=[];r=new createjs.Container;r.x=u;r.y=w-280;I.addChild(r);for(u=0;10>u;u++)I="water_anim_"+u,t[u]=createBitmap(s_oSpriteLibrary.getSprite(I)),t[u].visible=!1,r.addChild(t[u]);t[0].visible=!0;v=[];g=-UNLOAD_OFFSET+EDGEBOARD_X;e=CANVAS_WIDTH+UNLOAD_OFFSET-EDGEBOARD_X;D>MAX_LEVEL_DIFFICULTY&&(D=MAX_LEVEL_DIFFICULTY);I=[];for(u=0;u<WATER_LANE_TIMESPEED.length;u++)I[u]=WATER_LANE_TIMESPEED[u]+D*WATER_TIMESPEED_DECREASE_PER_LEVEL[u];
var m=[];for(u=0;u<WATER_LANE_OCCURENCE.length;u++)m[u]=WATER_LANE_OCCURENCE[u]+D*WATER_OCCURENCE_INCREASE_PER_LEVEL[u];v[0]={pos:w-0*y,start:e,end:g,speed:I[0],occur:m[0]};v[1]={pos:w-1*y,start:g,end:e,speed:I[1],occur:m[1]};v[2]={pos:w-2*y,start:g,end:e,speed:I[2],occur:m[2]};v[3]={pos:w-3*y,start:e,end:g,speed:I[3],occur:m[3]};v[4]={pos:w-4*y,start:g,end:e,speed:I[4],occur:m[4]}};this.getLaneInfo=function(u){return v[u]};this.update=function(){d=!d;0===h?(t[f].visible=!1,t[0].visible=!0):(t[h-
1].visible=!1,t[h].visible=!0);d&&h++;h>f&&(h=0)};this._init(a,c,b,l,n)}
function CStreet(a,c,b){var l,n,d;this.init=function(h,f,g){l=[];n=-UNLOAD_OFFSET+EDGEBOARD_X;d=CANVAS_WIDTH+UNLOAD_OFFSET-EDGEBOARD_X;g>MAX_LEVEL_DIFFICULTY&&(g=MAX_LEVEL_DIFFICULTY);for(var e=[],t=0;t<STREET_LANE_TIMESPEED.length;t++)e[t]=STREET_LANE_TIMESPEED[t]+g*STREET_TIMESPEED_DECREASE_PER_LEVEL[t];shuffle(e);var v=[];for(t=0;t<STREET_LANE_OCCURENCE.length;t++)v[t]=STREET_LANE_OCCURENCE[t]+g*STREET_OCCURENCE_DECREASE_PER_LEVEL[t];shuffle(v);for(t=0;5>t;t++){g=t%2;if(0===g){g=d;var r=n}else g=
n,r=d;l[t]={pos:h-t*f,start:g,end:r,speed:e[t],occur:v[t]}}};this.getLaneInfo=function(h){return l[h]};this.init(a,c,b)}
function CCar(a,c,b){var l,n,d,h,f,g,e,t,v,r,u;this.init=function(w,y,D){f=!1;e=0;l=w.pos;n=w.start;d=w.end;h=w.speed;w=s_oSpriteLibrary.getSprite("car_"+y);t=w.width;v=w.height;u=createBitmap(w);u.x=n;u.y=l;u.regX=t/2;u.regY=v/2;n<d?(u.rotation=180,g="right"):g="left";r=d;D.addChild(u)};this.unload=function(){b.removeChild(u)};this.playHornet=function(w){var y=Math.random();(!1===DISABLE_SOUND_MOBILE||!1===s_bMobile)&&.66>y&&2<w&&8>w&&(0===c||1===c?playSound("big_hornet",1,!1):playSound("small_hornet",
1,!1))};this.instantCar=function(w){h=a.speed/2;n=w};this.setPos=function(w,y){u.x=w;u.y=y};this.getType=function(){return"car"};this.setGone=function(w){f=w};this.getGone=function(){return f};this.getLogicRect=function(){return new createjs.Rectangle(u.x-t/2,u.y-v/2,t,v)};this.update=function(){if(!f){e+=s_iTimeElaps;var w=easeLinear(e,0,1,h);w=tweenVectorsOnX(n,r,w);u.x=w;if("right"===g&&u.x>r||"left"===g&&u.x<r)f=!0,s_oGame.addElemToRemoveList(this)}};this.init(a,c,b)}
function CTrunk(a,c){var b,l,n,d,h,f,g,e,t,v,r;this.init=function(u,w){n=!1;f=0;b=190;l=40;v=u;r=w;var y={images:[s_oSpriteLibrary.getSprite("trunk")],frames:{width:222,height:50,regX:111,regY:25},animations:{idle:[0,14]}};y=new createjs.SpriteSheet(y);t=createSprite(y,"idle",0,0,222,50);t.x=v.start;t.y=v.pos;v.start<v.end?(t.rotation=180,d="right"):d="left";h=v.end;r.addChild(t)};this.unload=function(){r.removeChild(t)};this.stopAnim=function(){t.stop()};this.getType=function(){return"support"};
this.getPos=function(){return{x:t.x,y:t.y}};this.getSpeed=function(){return g};this.setGone=function(u){n=u};this.getGone=function(){return n};this.getLogicRect=function(){return new createjs.Rectangle(t.x-b/2,t.y-l/2,b,l)};this.update=function(){if(!n){f+=s_iTimeElaps;var u=easeLinear(f,0,1,a.speed);u=tweenVectorsOnX(a.start,h,u);e=t.x;t.x=u;g=u-e;if("right"===d&&t.x>h||"left"===d&&t.x<h)n=!0,s_oGame.addElemToRemoveList(this)}};this.init(a,c)}
function CTurtle(a,c,b,l){var n,d,h,f,g,e,t,v,r,u,w,y;this.init=function(D,I,m,F){h=!1;t=0;n=70;d=50;w=D;y=F;D=0===I?{idle:[0,33]}:{idle:[0,99]};D={images:[s_oSpriteLibrary.getSprite("turtle")],frames:{width:74,height:74,regX:37,regY:37},animations:D};D=new createjs.SpriteSheet(D);u=createSprite(D,"idle",0,0,74,74);u.y=w.pos;g=w.start+m;w.start<w.end?(u.rotation=180,f="right"):f="left";e=w.end+m-100;y.addChild(u)};this.unload=function(){y.removeChild(u)};this.stopAnim=function(){u.stop()};this.getType=
function(){return"support"};this.getPos=function(){return{x:u.x,y:u.y}};this.getSpeed=function(){return v};this.setGone=function(D){h=D};this.getGone=function(){return h};this.getLogicRect=function(){return 40>u.currentAnimationFrame||90<u.currentAnimationFrame?new createjs.Rectangle(u.x-n/2,u.y-d/2,n,d):null};this.update=function(){if(!h){t+=s_iTimeElaps;var D=easeLinear(t,0,1,a.speed);D=tweenVectorsOnX(g,e,D);r=u.x;u.x=D;v=D-r;if("right"===f&&u.x>e||"left"===f&&u.x<e)h=!0,s_oGame.addElemToRemoveList(this)}};
this.init(a,c,b,l)}
function CLevelPanel(a){var c,b,l,n;this._init=function(){c=createBitmap(s_oSpriteLibrary.getSprite("msg_box"));c.x=0;c.y=0;b=new createjs.Container;b.alpha=0;b.visible=!1;b.addChild(c);var d=500,h=70,f=CANVAS_WIDTH/2,g=CANVAS_HEIGHT/2-164;l=new CTLText(b,f-d/2,g-h/2,d,h,60,"center","#fcff00",PRIMARY_FONT,1.2,2,2," ",!0,!0,!1,!1);l.setShadow("#000",4,4,5);d=500;h=50;f=CANVAS_WIDTH/2;g=CANVAS_HEIGHT/2+50;n=new CTLText(b,f-d/2,g-h/2,d,h,40,"center","#fcff00",PRIMARY_FONT,1.2,2,2," ",!0,!0,!1,!1);n.setShadow("#000",
4,4,5);s_oStage.addChild(b)};this.unload=function(){b.removeAllEventListeners()};this._initListener=function(){b.on("mousedown",this._onExit)};this.show=function(d){playSound("win_level",1,!1);this._initListener();l.refreshText(sprintf(TEXT_LEVELEND,a));n.refreshText(TEXT_SCORE+" "+d);b.visible=!0;createjs.Tween.get(b).to({alpha:1},500);document.dispatchEvent(new CustomEvent("save_score",{detail:{score:d}}))};this._onExit=function(){b.removeAllEventListeners();s_oStage.removeChild(b);s_oGame.reset()};
this._init(a);return this}function CFly(a,c,b){var l;this._init=function(n,d,h){var f=s_oSpriteLibrary.getSprite("fly");l=createBitmap(f);l.x=n;l.y=d;l.regX=f.width/2;l.regY=f.height/2;s_oStage.addChild(l);var g=this;createjs.Tween.get(l).wait(TIME_FLY_TO_DISAPPEAR).call(function(){g.unload();s_oGame.freeCell(h)})};this.unload=function(){createjs.Tween.removeTweens(l);s_oStage.removeChild(l)};this._init(a,c,b)}
function CCreditsPanel(){var a,c,b,l,n;this._init=function(){b=new createjs.Container;s_oStage.addChild(b);var d=s_oSpriteLibrary.getSprite("msg_box");d=createBitmap(d);b.addChild(d);d=400;var h=40,f=CANVAS_WIDTH/2;d=new CTLText(b,f-d/2,415-h/2,d,h,30,"center","#fcff00",PRIMARY_FONT,1.2,2,2,TEXT_DEVELOPED,!0,!0,!0,!1);d.setShadow("#000",2,2,5);d=400;h=40;f=CANVAS_WIDTH/2;d=new CTLText(b,f-d/2,580-h/2,d,h,26,"center","#fcff00",PRIMARY_FONT,1.2,2,2,"www.codethislab.com",!0,!0,!0,!1);d.setShadow("#000",
2,2,5);d=s_oSpriteLibrary.getSprite("ctl_logo");n=createBitmap(d);n.regX=d.width/2;n.regY=d.height/2;n.x=CANVAS_WIDTH/2;n.y=CANVAS_HEIGHT/2-70;b.addChild(n);c=new createjs.Shape;c.graphics.beginFill("#0f0f0f").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);c.alpha=.01;a=c.on("click",this._onLogoButRelease);b.addChild(c);d=s_oSpriteLibrary.getSprite("but_exit");l=new CGfxButton(770,230,d,b);l.addEventListener(ON_MOUSE_UP,this.unload,this)};this.unload=function(){c.off("click",a);s_oStage.removeChild(b);
l.unload()};this._onLogoButRelease=function(){window.open("http://www.codethislab.com/index.php?&l=en")};this._init()};