/*
 Platform.js <https://mths.be/platform>
 Copyright 2014-2018 Benjamin Tan <https://bnjmnt4n.now.sh/>
 Copyright 2011-2013 John-David Dalton
 Available under MIT license <https://mths.be/mit>
*/
(function(){var a="undefined"!==typeof window&&"undefined"!==typeof window.document?window.document:{},e="undefined"!==typeof module&&module.exports,d=function(){for(var m,h=["requestFullscreen exitFullscreen fullscreenElement fullscreenEnabled fullscreenchange fullscreenerror".split(" "),"webkitRequestFullscreen webkitExitFullscreen webkitFullscreenElement webkitFullscreenEnabled webkitfullscreenchange webkitfullscreenerror".split(" "),"webkitRequestFullScreen webkitCancelFullScreen webkitCurrentFullScreenElement webkitCancelFullScreen webkitfullscreenchange webkitfullscreenerror".split(" "),
"mozRequestFullScreen mozCancelFullScreen mozFullScreenElement mozFullScreenEnabled mozfullscreenchange mozfullscreenerror".split(" "),"msRequestFullscreen msExitFullscreen msFullscreenElement msFullscreenEnabled MSFullscreenChange MSFullscreenError".split(" ")],l=0,b=h.length,g={};l<b;l++)if((m=h[l])&&m[1]in a){for(l=0;l<m.length;l++)g[h[0][l]]=m[l];return g}return!1}(),c={change:d.fullscreenchange,error:d.fullscreenerror},f={request:function(m){return new Promise(function(h,l){var b=function(){this.off("change",
b);h()}.bind(this);this.on("change",b);m=m||a.documentElement;Promise.resolve(m[d.requestFullscreen]())["catch"](l)}.bind(this))},exit:function(){return new Promise(function(m,h){if(this.isFullscreen){var l=function(){this.off("change",l);m()}.bind(this);this.on("change",l);Promise.resolve(a[d.exitFullscreen]())["catch"](h)}else m()}.bind(this))},toggle:function(m){return this.isFullscreen?this.exit():this.request(m)},onchange:function(m){this.on("change",m)},onerror:function(m){this.on("error",m)},
on:function(m,h){var l=c[m];l&&a.addEventListener(l,h,!1)},off:function(m,h){var l=c[m];l&&a.removeEventListener(l,h,!1)},raw:d};d?(Object.defineProperties(f,{isFullscreen:{get:function(){return!!a[d.fullscreenElement]}},element:{enumerable:!0,get:function(){return a[d.fullscreenElement]}},isEnabled:{enumerable:!0,get:function(){return!!a[d.fullscreenEnabled]}}}),e?module.exports=f:window.screenfull=f):e?module.exports={isEnabled:!1}:window.screenfull={isEnabled:!1}})();
(function(){function a(q){q=String(q);return q.charAt(0).toUpperCase()+q.slice(1)}function e(q,w){var A=-1,G=q?q.length:0;if("number"==typeof G&&-1<G&&G<=v)for(;++A<G;)w(q[A],A,q);else c(q,w)}function d(q){q=String(q).replace(/^ +| +$/g,"");return/^(?:webOS|i(?:OS|P))/.test(q)?q:a(q)}function c(q,w){for(var A in q)n.call(q,A)&&w(q[A],A,q)}function f(q){return null==q?a(q):I.call(q).slice(8,-1)}function m(q,w){var A=null!=q?typeof q[w]:"number";return!/^(?:boolean|number|string|undefined)$/.test(A)&&
("object"==A?!!q[w]:!0)}function h(q){return String(q).replace(/([ -])(?!$)/g,"$1?")}function l(q,w){var A=null;e(q,function(G,B){A=w(A,G,B,q)});return A}function b(q){function w(P){return l(P,function(N,M){var S=M.pattern||h(M);!N&&(N=RegExp("\\b"+S+" *\\d+[.\\w_]*","i").exec(q)||RegExp("\\b"+S+" *\\w+-[\\w]*","i").exec(q)||RegExp("\\b"+S+"(?:; *(?:[a-z]+[_-])?[a-z]+\\d+|[^ ();-]*)","i").exec(q))&&((N=String(M.label&&!RegExp(S,"i").test(M.label)?M.label:N).split("/"))[1]&&!/[\d.]+/.test(N[0])&&(N[0]+=
" "+N[1]),M=M.label||M,N=d(N[0].replace(RegExp(S,"i"),M).replace(RegExp("; *(?:"+M+"[_-])?","i")," ").replace(RegExp("("+M+")[-_.]?(\\w)","i"),"$1 $2")));return N})}function A(P){return l(P,function(N,M){return N||(RegExp(M+"(?:-[\\d.]+/|(?: for [\\w-]+)?[ /-])([\\d.]+[^ ();/_-]*)","i").exec(q)||0)[1]||null})}var G=k,B=q&&"object"==typeof q&&"String"!=f(q);B&&(G=q,q=null);var R=G.navigator||{},E=R.userAgent||"";q||(q=E);var V=B?!!R.likeChrome:/\bChrome\b/.test(q)&&!/internal|\n/i.test(I.toString()),
aa=B?"Object":"ScriptBridgingProxyObject",r=B?"Object":"Environment",t=B&&G.java?"JavaPackage":f(G.java),z=B?"Object":"RuntimeObject";r=(t=/\bJava/.test(t)&&G.java)&&f(G.environment)==r;var F=t?"a":"\u03b1",O=t?"b":"\u03b2",H=G.document||{},Q=G.operamini||G.opera,W=x.test(W=B&&Q?Q["[[Class]]"]:f(Q))?W:Q=null,p,Y=q;B=[];var Z=null,X=q==E;E=X&&Q&&"function"==typeof Q.version&&Q.version();var K=function(P){return l(P,function(N,M){return N||RegExp("\\b"+(M.pattern||h(M))+"\\b","i").exec(q)&&(M.label||
M)})}([{label:"EdgeHTML",pattern:"Edge"},"Trident",{label:"WebKit",pattern:"AppleWebKit"},"iCab","Presto","NetFront","Tasman","KHTML","Gecko"]),C=function(P){return l(P,function(N,M){return N||RegExp("\\b"+(M.pattern||h(M))+"\\b","i").exec(q)&&(M.label||M)})}(["Adobe AIR","Arora","Avant Browser","Breach","Camino","Electron","Epiphany","Fennec","Flock","Galeon","GreenBrowser","iCab","Iceweasel","K-Meleon","Konqueror","Lunascape","Maxthon",{label:"Microsoft Edge",pattern:"Edge"},"Midori","Nook Browser",
"PaleMoon","PhantomJS","Raven","Rekonq","RockMelt",{label:"Samsung Internet",pattern:"SamsungBrowser"},"SeaMonkey",{label:"Silk",pattern:"(?:Cloud9|Silk-Accelerated)"},"Sleipnir","SlimBrowser",{label:"SRWare Iron",pattern:"Iron"},"Sunrise","Swiftfox","Waterfox","WebPositive","Opera Mini",{label:"Opera Mini",pattern:"OPiOS"},"Opera",{label:"Opera",pattern:"OPR"},"Chrome",{label:"Chrome Mobile",pattern:"(?:CriOS|CrMo)"},{label:"Firefox",pattern:"(?:Firefox|Minefield)"},{label:"Firefox for iOS",pattern:"FxiOS"},
{label:"IE",pattern:"IEMobile"},{label:"IE",pattern:"MSIE"},"Safari"]),L=w([{label:"BlackBerry",pattern:"BB10"},"BlackBerry",{label:"Galaxy S",pattern:"GT-I9000"},{label:"Galaxy S2",pattern:"GT-I9100"},{label:"Galaxy S3",pattern:"GT-I9300"},{label:"Galaxy S4",pattern:"GT-I9500"},{label:"Galaxy S5",pattern:"SM-G900"},{label:"Galaxy S6",pattern:"SM-G920"},{label:"Galaxy S6 Edge",pattern:"SM-G925"},{label:"Galaxy S7",pattern:"SM-G930"},{label:"Galaxy S7 Edge",pattern:"SM-G935"},"Google TV","Lumia","iPad",
"iPod","iPhone","Kindle",{label:"Kindle Fire",pattern:"(?:Cloud9|Silk-Accelerated)"},"Nexus","Nook","PlayBook","PlayStation Vita","PlayStation","TouchPad","Transformer",{label:"Wii U",pattern:"WiiU"},"Wii","Xbox One",{label:"Xbox 360",pattern:"Xbox"},"Xoom"]),T=function(P){return l(P,function(N,M,S){return N||(M[L]||M[/^[a-z]+(?: +[a-z]+\b)*/i.exec(L)]||RegExp("\\b"+h(S)+"(?:\\b|\\w*\\d)","i").exec(q))&&S})}({Apple:{iPad:1,iPhone:1,iPod:1},Archos:{},Amazon:{Kindle:1,"Kindle Fire":1},Asus:{Transformer:1},
"Barnes & Noble":{Nook:1},BlackBerry:{PlayBook:1},Google:{"Google TV":1,Nexus:1},HP:{TouchPad:1},HTC:{},LG:{},Microsoft:{Xbox:1,"Xbox One":1},Motorola:{Xoom:1},Nintendo:{"Wii U":1,Wii:1},Nokia:{Lumia:1},Samsung:{"Galaxy S":1,"Galaxy S2":1,"Galaxy S3":1,"Galaxy S4":1},Sony:{PlayStation:1,"PlayStation Vita":1}}),D=function(P){return l(P,function(N,M){var S=M.pattern||h(M);if(!N&&(N=RegExp("\\b"+S+"(?:/[\\d.]+|[ \\w.]*)","i").exec(q))){var U=N,ba=M.label||M,ca={"10.0":"10","6.4":"10 Technical Preview",
"6.3":"8.1","6.2":"8","6.1":"Server 2008 R2 / 7","6.0":"Server 2008 / Vista","5.2":"Server 2003 / XP 64-bit","5.1":"XP","5.01":"2000 SP1","5.0":"2000","4.0":"NT","4.90":"ME"};S&&ba&&/^Win/i.test(U)&&!/^Windows Phone /i.test(U)&&(ca=ca[/[\d.]+$/.exec(U)])&&(U="Windows "+ca);U=String(U);S&&ba&&(U=U.replace(RegExp(S,"i"),ba));N=U=d(U.replace(/ ce$/i," CE").replace(/\bhpw/i,"web").replace(/\bMacintosh\b/,"Mac OS").replace(/_PowerPC\b/i," OS").replace(/\b(OS X) [^ \d]+/i,"$1").replace(/\bMac (OS X)\b/,
"$1").replace(/\/(\d)/," $1").replace(/_/g,".").replace(/(?: BePC|[ .]*fc[ \d.]+)$/i,"").replace(/\bx86\.64\b/gi,"x86_64").replace(/\b(Windows Phone) OS\b/,"$1").replace(/\b(Chrome OS \w+) [\d.]+\b/,"$1").split(" on ")[0])}return N})}(["Windows Phone","Android","CentOS",{label:"Chrome OS",pattern:"CrOS"},"Debian","Fedora","FreeBSD","Gentoo","Haiku","Kubuntu","Linux Mint","OpenBSD","Red Hat","SuSE","Ubuntu","Xubuntu","Cygwin","Symbian OS","hpwOS","webOS ","webOS","Tablet OS","Tizen","Linux","Mac OS X",
"Macintosh","Mac","Windows 98;","Windows "]);K&&(K=[K]);T&&!L&&(L=w([T]));if(p=/\bGoogle TV\b/.exec(L))L=p[0];/\bSimulator\b/i.test(q)&&(L=(L?L+" ":"")+"Simulator");"Opera Mini"==C&&/\bOPiOS\b/.test(q)&&B.push("running in Turbo/Uncompressed mode");"IE"==C&&/\blike iPhone OS\b/.test(q)?(p=b(q.replace(/like iPhone OS/,"")),T=p.manufacturer,L=p.product):/^iP/.test(L)?(C||(C="Safari"),D="iOS"+((p=/ OS ([\d_]+)/i.exec(q))?" "+p[1].replace(/_/g,"."):"")):"Konqueror"!=C||/buntu/i.test(D)?T&&"Google"!=T&&
(/Chrome/.test(C)&&!/\bMobile Safari\b/i.test(q)||/\bVita\b/.test(L))||/\bAndroid\b/.test(D)&&/^Chrome/.test(C)&&/\bVersion\//i.test(q)?(C="Android Browser",D=/\bAndroid\b/.test(D)?D:"Android"):"Silk"==C?(/\bMobi/i.test(q)||(D="Android",B.unshift("desktop mode")),/Accelerated *= *true/i.test(q)&&B.unshift("accelerated")):"PaleMoon"==C&&(p=/\bFirefox\/([\d.]+)\b/.exec(q))?B.push("identifying as Firefox "+p[1]):"Firefox"==C&&(p=/\b(Mobile|Tablet|TV)\b/i.exec(q))?(D||(D="Firefox OS"),L||(L=p[1])):!C||
(p=!/\bMinefield\b/i.test(q)&&/\b(?:Firefox|Safari)\b/.exec(C))?(C&&!L&&/[\/,]|^[^(]+?\)/.test(q.slice(q.indexOf(p+"/")+8))&&(C=null),(p=L||T||D)&&(L||T||/\b(?:Android|Symbian OS|Tablet OS|webOS)\b/.test(D))&&(C=/[a-z]+(?: Hat)?/i.exec(/\bAndroid\b/.test(D)?D:p)+" Browser")):"Electron"==C&&(p=(/\bChrome\/([\d.]+)\b/.exec(q)||0)[1])&&B.push("Chromium "+p):D="Kubuntu";E||(E=A(["(?:Cloud9|CriOS|CrMo|Edge|FxiOS|IEMobile|Iron|Opera ?Mini|OPiOS|OPR|Raven|SamsungBrowser|Silk(?!/[\\d.]+$))","Version",h(C),
"(?:Firefox|Minefield|NetFront)"]));if(p="iCab"==K&&3<parseFloat(E)&&"WebKit"||/\bOpera\b/.test(C)&&(/\bOPR\b/.test(q)?"Blink":"Presto")||/\b(?:Midori|Nook|Safari)\b/i.test(q)&&!/^(?:Trident|EdgeHTML)$/.test(K)&&"WebKit"||!K&&/\bMSIE\b/i.test(q)&&("Mac OS"==D?"Tasman":"Trident")||"WebKit"==K&&/\bPlayStation\b(?! Vita\b)/i.test(C)&&"NetFront")K=[p];"IE"==C&&(p=(/; *(?:XBLWP|ZuneWP)(\d+)/i.exec(q)||0)[1])?(C+=" Mobile",D="Windows Phone "+(/\+$/.test(p)?p:p+".x"),B.unshift("desktop mode")):/\bWPDesktop\b/i.test(q)?
(C="IE Mobile",D="Windows Phone 8.x",B.unshift("desktop mode"),E||(E=(/\brv:([\d.]+)/.exec(q)||0)[1])):"IE"!=C&&"Trident"==K&&(p=/\brv:([\d.]+)/.exec(q))&&(C&&B.push("identifying as "+C+(E?" "+E:"")),C="IE",E=p[1]);if(X){if(m(G,"global"))if(t&&(p=t.lang.System,Y=p.getProperty("os.arch"),D=D||p.getProperty("os.name")+" "+p.getProperty("os.version")),r){try{E=G.require("ringo/engine").version.join("."),C="RingoJS"}catch(P){(p=G.system)&&p.global.system==G.system&&(C="Narwhal",D||(D=p[0].os||null))}C||
(C="Rhino")}else"object"==typeof G.process&&!G.process.browser&&(p=G.process)&&("object"==typeof p.versions&&("string"==typeof p.versions.electron?(B.push("Node "+p.versions.node),C="Electron",E=p.versions.electron):"string"==typeof p.versions.nw&&(B.push("Chromium "+E,"Node "+p.versions.node),C="NW.js",E=p.versions.nw)),C||(C="Node.js",Y=p.arch,D=p.platform,E=(E=/[\d.]+/.exec(p.version))?E[0]:null));else f(p=G.runtime)==aa?(C="Adobe AIR",D=p.flash.system.Capabilities.os):f(p=G.phantom)==z?(C="PhantomJS",
E=(p=p.version||null)&&p.major+"."+p.minor+"."+p.patch):"number"==typeof H.documentMode&&(p=/\bTrident\/(\d+)/i.exec(q))?(E=[E,H.documentMode],(p=+p[1]+4)!=E[1]&&(B.push("IE "+E[1]+" mode"),K&&(K[1]=""),E[1]=p),E="IE"==C?String(E[1].toFixed(1)):E[0]):"number"==typeof H.documentMode&&/^(?:Chrome|Firefox)\b/.test(C)&&(B.push("masking as "+C+" "+E),C="IE",E="11.0",K=["Trident"],D="Windows");D=D&&d(D)}E&&(p=/(?:[ab]|dp|pre|[ab]\d+pre)(?:\d+\+?)?$/i.exec(E)||/(?:alpha|beta)(?: ?\d)?/i.exec(q+";"+(X&&R.appMinorVersion))||
/\bMinefield\b/i.test(q)&&"a")&&(Z=/b/i.test(p)?"beta":"alpha",E=E.replace(RegExp(p+"\\+?$"),"")+("beta"==Z?O:F)+(/\d+\+?/.exec(p)||""));if("Fennec"==C||"Firefox"==C&&/\b(?:Android|Firefox OS)\b/.test(D))C="Firefox Mobile";else if("Maxthon"==C&&E)E=E.replace(/\.[\d.]+/,".x");else if(/\bXbox\b/i.test(L))"Xbox 360"==L&&(D=null),"Xbox 360"==L&&/\bIEMobile\b/.test(q)&&B.unshift("mobile mode");else if(!/^(?:Chrome|IE|Opera)$/.test(C)&&(!C||L||/Browser|Mobi/.test(C))||"Windows CE"!=D&&!/Mobi/i.test(q))if("IE"==
C&&X)try{null===G.external&&B.unshift("platform preview")}catch(P){B.unshift("embedded")}else(/\bBlackBerry\b/.test(L)||/\bBB10\b/.test(q))&&(p=(RegExp(L.replace(/ +/g," *")+"/([.\\d]+)","i").exec(q)||0)[1]||E)?(p=[p,/BB10/.test(q)],D=(p[1]?(L=null,T="BlackBerry"):"Device Software")+" "+p[0],E=null):this!=c&&"Wii"!=L&&(X&&Q||/Opera/.test(C)&&/\b(?:MSIE|Firefox)\b/i.test(q)||"Firefox"==C&&/\bOS X (?:\d+\.){2,}/.test(D)||"IE"==C&&(D&&!/^Win/.test(D)&&5.5<E||/\bWindows XP\b/.test(D)&&8<E||8==E&&!/\bTrident\b/.test(q)))&&
!x.test(p=b.call(c,q.replace(x,"")+";"))&&p.name&&(p="ing as "+p.name+((p=p.version)?" "+p:""),x.test(C)?(/\bIE\b/.test(p)&&"Mac OS"==D&&(D=null),p="identify"+p):(p="mask"+p,C=W?d(W.replace(/([a-z])([A-Z])/g,"$1 $2")):"Opera",/\bIE\b/.test(p)&&(D=null),X||(E=null)),K=["Presto"],B.push(p));else C+=" Mobile";if(p=(/\bAppleWebKit\/([\d.]+\+?)/i.exec(q)||0)[1]){p=[parseFloat(p.replace(/\.(\d)$/,".0$1")),p];if("Safari"==C&&"+"==p[1].slice(-1))C="WebKit Nightly",Z="alpha",E=p[1].slice(0,-1);else if(E==
p[1]||E==(p[2]=(/\bSafari\/([\d.]+\+?)/i.exec(q)||0)[1]))E=null;p[1]=(/\bChrome\/([\d.]+)/i.exec(q)||0)[1];537.36==p[0]&&537.36==p[2]&&28<=parseFloat(p[1])&&"WebKit"==K&&(K=["Blink"]);X&&(V||p[1])?(K&&(K[1]="like Chrome"),p=p[1]||(p=p[0],530>p?1:532>p?2:532.05>p?3:533>p?4:534.03>p?5:534.07>p?6:534.1>p?7:534.13>p?8:534.16>p?9:534.24>p?10:534.3>p?11:535.01>p?12:535.02>p?"13+":535.07>p?15:535.11>p?16:535.19>p?17:536.05>p?18:536.1>p?19:537.01>p?20:537.11>p?"21+":537.13>p?23:537.18>p?24:537.24>p?25:537.36>
p?26:"Blink"!=K?"27":"28")):(K&&(K[1]="like Safari"),p=(p=p[0],400>p?1:500>p?2:526>p?3:533>p?4:534>p?"4+":535>p?5:537>p?6:538>p?7:601>p?8:"8"));K&&(K[1]+=" "+(p+="number"==typeof p?".x":/[.+]/.test(p)?"":"+"));"Safari"==C&&(!E||45<parseInt(E))&&(E=p)}"Opera"==C&&(p=/\bzbov|zvav$/.exec(D))?(C+=" ",B.unshift("desktop mode"),"zvav"==p?(C+="Mini",E=null):C+="Mobile",D=D.replace(RegExp(" *"+p+"$"),"")):"Safari"==C&&/\bChrome\b/.exec(K&&K[1])&&(B.unshift("desktop mode"),C="Chrome Mobile",E=null,/\bOS X\b/.test(D)?
(T="Apple",D="iOS 4.3+"):D=null);E&&0==E.indexOf(p=/[\d.]+$/.exec(D))&&-1<q.indexOf("/"+p+"-")&&(D=String(D.replace(p,"")).replace(/^ +| +$/g,""));K&&!/\b(?:Avant|Nook)\b/.test(C)&&(/Browser|Lunascape|Maxthon/.test(C)||"Safari"!=C&&/^iOS/.test(D)&&/\bSafari\b/.test(K[1])||/^(?:Adobe|Arora|Breach|Midori|Opera|Phantom|Rekonq|Rock|Samsung Internet|Sleipnir|Web)/.test(C)&&K[1])&&(p=K[K.length-1])&&B.push(p);B.length&&(B=["("+B.join("; ")+")"]);T&&L&&0>L.indexOf(T)&&B.push("on "+T);L&&B.push((/^on /.test(B[B.length-
1])?"":"on ")+L);if(D){var da=(p=/ ([\d.+]+)$/.exec(D))&&"/"==D.charAt(D.length-p[0].length-1);D={architecture:32,family:p&&!da?D.replace(p[0],""):D,version:p?p[1]:null,toString:function(){var P=this.version;return this.family+(P&&!da?" "+P:"")+(64==this.architecture?" 64-bit":"")}}}(p=/\b(?:AMD|IA|Win|WOW|x86_|x)64\b/i.exec(Y))&&!/\bi686\b/i.test(Y)?(D&&(D.architecture=64,D.family=D.family.replace(RegExp(" *"+p),"")),C&&(/\bWOW64\b/i.test(q)||X&&/\w(?:86|32)$/.test(R.cpuClass||R.platform)&&!/\bWin64; x64\b/i.test(q))&&
B.unshift("32-bit")):D&&/^OS X/.test(D.family)&&"Chrome"==C&&39<=parseFloat(E)&&(D.architecture=64);q||(q=null);G={};G.description=q;G.layout=K&&K[0];G.manufacturer=T;G.name=C;G.prerelease=Z;G.product=L;G.ua=q;G.version=C&&E;G.os=D||{architecture:null,family:null,version:null,toString:function(){return"null"}};G.parse=b;G.toString=function(){return this.description||""};G.version&&B.unshift(E);G.name&&B.unshift(C);D&&C&&(D!=String(D).split(" ")[0]||D!=C.split(" ")[0]&&!L)&&B.push(L?"("+D+")":"on "+
D);B.length&&(G.description=B.join(" "));return G}var g={"function":!0,object:!0},k=g[typeof window]&&window||this,y=g[typeof exports]&&exports;g=g[typeof module]&&module&&!module.nodeType&&module;var u=y&&g&&"object"==typeof global&&global;!u||u.global!==u&&u.window!==u&&u.self!==u||(k=u);var v=Math.pow(2,53)-1,x=/\bOpera/;u=Object.prototype;var n=u.hasOwnProperty,I=u.toString,J=b();"function"==typeof define&&"object"==typeof define.amd&&define.amd?(k.platform=J,define(function(){return J})):y&&
g?c(J,function(q,w){y[w]=q}):k.platform=J}).call(this);var s_iScaleFactor=1,s_bIsIphone=!1,s_iOffsetX,s_iOffsetY,s_bFocus=!0;
(function(a){(jQuery.browser=jQuery.browser||{}).mobile=/android|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(ad|hone|od)|iris|kindle|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|symbian|tablet|treo|up\.(browser|link)|vodafone|wap|webos|windows (ce|phone)|xda|xiino/i.test(a)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|e\-|e\/|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(di|rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|xda(\-|2|g)|yas\-|your|zeto|zte\-/i.test(a.substr(0,4))})(navigator.userAgent||
navigator.vendor||window.opera);$(window).resize(function(){s_oGame&&s_oGame.showPausePanel(!1);s_oMain.startUpdate();sizeHandler()});$(window).blur(function(){s_oGame&&s_oGame.showPausePanel(!0);s_oMain.stopUpdate()});$(window).focus(function(){s_oGame&&s_oGame.showPausePanel(!1);s_oMain.startUpdate()});function trace(a){console.log(a)}
function getSize(a){var e=a.toLowerCase(),d=window.document,c=d.documentElement;if(void 0===window["inner"+a])a=c["client"+a];else if(window["inner"+a]!=c["client"+a]){var f=d.createElement("body");f.id="vpw-test-b";f.style.cssText="overflow:scroll";var m=d.createElement("div");m.id="vpw-test-d";m.style.cssText="position:absolute;top:-1000px";m.innerHTML="<style>@media("+e+":"+c["client"+a]+"px){body#vpw-test-b div#vpw-test-d{"+e+":7px!important}}</style>";f.appendChild(m);c.insertBefore(f,d.head);
a=7==m["offset"+a]?c["client"+a]:window["inner"+a];c.removeChild(f)}else a=window["inner"+a];return a}window.addEventListener("orientationchange",onOrientationChange);function onOrientationChange(){window.matchMedia("(orientation: portrait)").matches&&sizeHandler();window.matchMedia("(orientation: landscape)").matches&&sizeHandler()}function isChrome(){return/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)}
function isIphone(){return-1!==navigator.userAgent.toLowerCase().indexOf("iphone")?!0:!1}function isIOS(){var a="iPad Simulator;iPhone Simulator;iPod Simulator;iPad;iPhone;iPod".split(";");for(-1!==navigator.userAgent.toLowerCase().indexOf("iphone")&&(s_bIsIphone=!0);a.length;)if(navigator.platform===a.pop())return!0;return s_bIsIphone=!1}function getIOSWindowHeight(){return document.documentElement.clientWidth/window.innerWidth*window.innerHeight}
function getHeightOfIOSToolbars(){var a=(0===window.orientation?screen.height:screen.width)-getIOSWindowHeight();return 1<a?a:0}function isIpad(){var a=-1!==navigator.userAgent.toLowerCase().indexOf("ipad");return!a&&navigator.userAgent.match(/Mac/)&&navigator.maxTouchPoints&&2<navigator.maxTouchPoints?!0:a}function isMobile(){return isIpad()?!0:jQuery.browser.mobile}
function sizeHandler(){window.scrollTo(0,1);if($("#canvas")){var a=null!==platform.name&&"safari"===platform.name.toLowerCase()?getIOSWindowHeight():getSize("Height");var e=getSize("Width");s_bFocus&&_checkOrientation(e,a);var d=Math.min(a/CANVAS_HEIGHT,e/CANVAS_WIDTH),c=Math.round(CANVAS_WIDTH*d);d=Math.round(CANVAS_HEIGHT*d);if(d<a){var f=a-d;d+=f;c+=CANVAS_WIDTH/CANVAS_HEIGHT*f}else c<e&&(f=e-c,c+=f,d+=CANVAS_HEIGHT/CANVAS_WIDTH*f);f=a/2-d/2;var m=e/2-c/2,h=CANVAS_WIDTH/c;if(m*h<-EDGEBOARD_X||
f*h<-EDGEBOARD_Y)d=Math.min(a/(CANVAS_HEIGHT-2*EDGEBOARD_Y),e/(CANVAS_WIDTH-2*EDGEBOARD_X)),c=Math.round(CANVAS_WIDTH*d),d=Math.round(CANVAS_HEIGHT*d),f=(a-d)/2,m=(e-c)/2,h=CANVAS_WIDTH/c;s_iOffsetX=-1*m*h;s_iOffsetY=-1*f*h;0<=f&&(s_iOffsetY=0);0<=m&&(s_iOffsetX=0);null!==s_oInterface&&s_oInterface.refreshButtonPos(s_iOffsetX,s_iOffsetY);null!==s_oMenu&&s_oMenu.refreshButtonPos(s_iOffsetX,s_iOffsetY);s_bIsIphone&&s_oStage?(canvas=document.getElementById("canvas"),s_oStage.canvas.width=2*c,s_oStage.canvas.height=
2*d,canvas.style.width=c+"px",canvas.style.height=d+"px",s_oStage.scaleX=s_oStage.scaleY=2*Math.min(c/CANVAS_WIDTH,d/CANVAS_HEIGHT)):s_bMobile||isChrome()?($("#canvas").css("width",c+"px"),$("#canvas").css("height",d+"px")):s_oStage&&(s_oStage.canvas.width=c,s_oStage.canvas.height=d,s_iScaleFactor=Math.min(c/CANVAS_WIDTH,d/CANVAS_HEIGHT),s_oStage.scaleX=s_oStage.scaleY=s_iScaleFactor);0>f||(f=(a-d)/2);$("#canvas").css("top",f+"px");$("#canvas").css("left",m+"px");fullscreenHandler()}}
function _checkOrientation(a,e){s_bMobile&&ENABLE_CHECK_ORIENTATION&&(a>e?"landscape"===$(".orientation-msg-container").attr("data-orientation")?($(".orientation-msg-container").css("display","none"),s_oMain.startUpdate()):($(".orientation-msg-container").css("display","block"),s_oMain.stopUpdate()):"portrait"===$(".orientation-msg-container").attr("data-orientation")?($(".orientation-msg-container").css("display","none"),s_oMain.startUpdate()):($(".orientation-msg-container").css("display","block"),
s_oMain.stopUpdate()))}function playSound(a,e,d){return!1===DISABLE_SOUND_MOBILE||!1===s_bMobile?(s_aSounds[a].play(),s_aSounds[a].volume(e),s_aSounds[a].loop(d),s_aSounds[a]):null}function stopSound(a){!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||s_aSounds[a].stop()}function setVolume(a,e){!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||s_aSounds[a].volume(e)}function setMute(a,e){!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||s_aSounds[a].mute(e)}
function fadeVolume(a,e,d){!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||(new createjs.Tween.get(a)).to({volume:e},d)}function createBitmap(a,e,d){var c=new createjs.Bitmap(a),f=new createjs.Shape;e&&d?f.graphics.beginFill("#fff").drawRect(0,0,e,d):f.graphics.beginFill("#ff0").drawRect(0,0,a.width,a.height);c.hitArea=f;return c}
function createSprite(a,e,d,c,f,m){a=null!==e?new createjs.Sprite(a,e):new createjs.Sprite(a);e=new createjs.Shape;e.graphics.beginFill("#000000").drawRect(-d,-c,f,m);a.hitArea=e;return a}function randomFloatBetween(a,e,d){"undefined"===typeof d&&(d=2);return parseFloat(Math.min(a+Math.random()*(e-a),e).toFixed(d))}function rotateVector2D(a,e){var d=e.getX()*Math.cos(a)+e.getY()*Math.sin(a),c=e.getX()*-Math.sin(a)+e.getY()*Math.cos(a);e.set(d,c)}function tweenVectorsOnX(a,e,d){return a+d*(e-a)}
function shuffle(a){for(var e=a.length,d,c;0!==e;)c=Math.floor(Math.random()*e),--e,d=a[e],a[e]=a[c],a[c]=d;return a}function bubbleSort(a){do{var e=!1;for(var d=0;d<a.length-1;d++)a[d]>a[d+1]&&(e=a[d],a[d]=a[d+1],a[d+1]=e,e=!0)}while(e)}function compare(a,e){return a.index>e.index?-1:a.index<e.index?1:0}function easeLinear(a,e,d,c){return d*a/c+e}function easeInQuad(a,e,d,c){return d*(a/=c)*a+e}function easeInSine(a,e,d,c){return-d*Math.cos(a/c*(Math.PI/2))+d+e}
function easeInCubic(a,e,d,c){return d*(a/=c)*a*a+e}function getTrajectoryPoint(a,e){var d=new createjs.Point,c=(1-a)*(1-a),f=a*a;d.x=c*e.start.x+2*(1-a)*a*e.traj.x+f*e.end.x;d.y=c*e.start.y+2*(1-a)*a*e.traj.y+f*e.end.y;return d}function formatTime(a){a/=1E3;var e=Math.floor(a/60);a=Math.floor(a-60*e);var d="";d=10>e?d+("0"+e+":"):d+(e+":");return 10>a?d+("0"+a):d+a}function degreesToRadians(a){return a*Math.PI/180}
function checkRectCollision(a,e){var d=getBounds(a,.9);var c=getBounds(e,.98);return calculateIntersection(d,c)}function calculateIntersection(a,e){var d,c,f,m;var h=a.x+(d=a.width/2);var l=a.y+(c=a.height/2);var b=e.x+(f=e.width/2);var g=e.y+(m=e.height/2);h=Math.abs(h-b)-(d+f);l=Math.abs(l-g)-(c+m);return 0>h&&0>l?(h=Math.min(Math.min(a.width,e.width),-h),l=Math.min(Math.min(a.height,e.height),-l),{x:Math.max(a.x,e.x),y:Math.max(a.y,e.y),width:h,height:l,rect1:a,rect2:e}):null}
function dlx_cover(a){a.right.left=a.left;a.left.right=a.right;for(var e=a.down;e!==a;e=e.down)for(var d=e.right;d!==e;d=d.right)d.down.up=d.up,d.up.down=d.down,d.column.size--}function dlx_uncover(a){for(var e=a.up;e!==a;e=e.up)for(var d=e.left;d!==e;d=d.left)d.column.size++,d.down.up=d,d.up.down=d;a.right.left=a;a.left.right=a}
function dlx_search(a,e,d,c,f){if(a.right===a)return c.push(e.slice(0)),c.length>=f?c:null;for(var m=null,h=99999,l=a.right;l!==a;l=l.right){if(0===l.size)return null;l.size<h&&(h=l.size,m=l)}dlx_cover(m);for(var b=m.down;b!==m;b=b.down){e[d]=b.row;for(l=b.right;l!==b;l=l.right)dlx_cover(l.column);h=dlx_search(a,e,d+1,c,f);if(null!==h)return h;for(l=b.left;l!==b;l=l.left)dlx_uncover(l.column)}dlx_uncover(m);return null}
function dlx_solve(a,e,d){for(var c=Array(a[0].length),f=0;f<c.length;f++)c[f]={};for(f=0;f<c.length;f++)c[f].index=f,c[f].up=c[f],c[f].down=c[f],f>=e?(f-1>=e&&(c[f].left=c[f-1]),f+1<c.length&&(c[f].right=c[f+1])):(c[f].left=c[f],c[f].right=c[f]),c[f].size=0;for(f=0;f<a.length;f++)for(var m=null,h=0;h<a[f].length;h++)if(a[f][h]){var l={};l.row=f;l.column=c[h];l.up=c[h].up;l.down=c[h];m?(l.left=m,l.right=m.right,m.right.left=l,m.right=l):(l.left=l,l.right=l);c[h].up.down=l;c[h].up=l;c[h].size++;m=
l}a={};a.right=c[e];a.left=c[c.length-1];c[e].left=a;c[c.length-1].right=a;solutions=[];dlx_search(a,[],0,solutions,d);return solutions}
function solve_sudoku(a){for(var e=[],d=[],c=0;9>c;c++)for(var f=0;9>f;f++){var m=a[c][f]-1;if(0<=m){var h=Array(324);h[9*c+f]=1;h[81+9*c+m]=1;h[162+9*f+m]=1;h[243+9*(3*Math.floor(c/3)+Math.floor(f/3))+m]=1;e.push(h);d.push({row:c,col:f,n:m+1})}else for(m=0;9>m;m++)h=Array(324),h[9*c+f]=1,h[81+9*c+m]=1,h[162+9*f+m]=1,h[243+9*(3*Math.floor(c/3)+Math.floor(f/3))+m]=1,e.push(h),d.push({row:c,col:f,n:m+1})}e=dlx_solve(e,0,2);if(0<e.length){f=e[0];for(c=0;c<f.length;c++)a[d[f[c]].row][d[f[c]].col]=d[f[c]].n;
return e.length}return 0}function solve(a){a=solve_sudoku(a);if(0<a){if(1<a)return 1}else return trace("no solution"),0}
function getBounds(a,e){var d={x:Infinity,y:Infinity,width:0,height:0};if(a instanceof createjs.Container){d.x2=-Infinity;d.y2=-Infinity;var c=a.children,f=c.length,m;for(m=0;m<f;m++){var h=getBounds(c[m],1);h.x<d.x&&(d.x=h.x);h.y<d.y&&(d.y=h.y);h.x+h.width>d.x2&&(d.x2=h.x+h.width);h.y+h.height>d.y2&&(d.y2=h.y+h.height)}Infinity==d.x&&(d.x=0);Infinity==d.y&&(d.y=0);Infinity==d.x2&&(d.x2=0);Infinity==d.y2&&(d.y2=0);d.width=d.x2-d.x;d.height=d.y2-d.y;delete d.x2;delete d.y2}else{if(a instanceof createjs.Bitmap){f=
a.sourceRect||a.image;m=f.width*e;var l=f.height*e}else if(a instanceof createjs.Sprite)if(a.spriteSheet._frames&&a.spriteSheet._frames[a.currentFrame]&&a.spriteSheet._frames[a.currentFrame].image){f=a.spriteSheet.getFrame(a.currentFrame);m=f.rect.width;l=f.rect.height;c=f.regX;var b=f.regY}else d.x=a.x||0,d.y=a.y||0;else d.x=a.x||0,d.y=a.y||0;c=c||0;m=m||0;b=b||0;l=l||0;d.regX=c;d.regY=b;f=a.localToGlobal(0-c,0-b);h=a.localToGlobal(m-c,l-b);m=a.localToGlobal(m-c,0-b);c=a.localToGlobal(0-c,l-b);d.x=
Math.min(Math.min(Math.min(f.x,h.x),m.x),c.x);d.y=Math.min(Math.min(Math.min(f.y,h.y),m.y),c.y);d.width=Math.max(Math.max(Math.max(f.x,h.x),m.x),c.x)-d.x;d.height=Math.max(Math.max(Math.max(f.y,h.y),m.y),c.y)-d.y}return d}function NoClickDelay(a){this.element=a;window.Touch&&this.element.addEventListener("touchstart",this,!1)}function shuffle(a){for(var e=a.length,d,c;0<e;)c=Math.floor(Math.random()*e),e--,d=a[e],a[e]=a[c],a[c]=d;return a}
NoClickDelay.prototype={handleEvent:function(a){switch(a.type){case "touchstart":this.onTouchStart(a);break;case "touchmove":this.onTouchMove(a);break;case "touchend":this.onTouchEnd(a)}},onTouchStart:function(a){a.preventDefault();this.moved=!1;this.element.addEventListener("touchmove",this,!1);this.element.addEventListener("touchend",this,!1)},onTouchMove:function(a){this.moved=!0},onTouchEnd:function(a){this.element.removeEventListener("touchmove",this,!1);this.element.removeEventListener("touchend",
this,!1);if(!this.moved){a=document.elementFromPoint(a.changedTouches[0].clientX,a.changedTouches[0].clientY);3==a.nodeType&&(a=a.parentNode);var e=document.createEvent("MouseEvents");e.initEvent("click",!0,!0);a.dispatchEvent(e)}}};
(function(){function a(d){var c={focus:"visible",focusin:"visible",pageshow:"visible",blur:"hidden",focusout:"hidden",pagehide:"hidden"};d=d||window.event;d.type in c?document.body.className=c[d.type]:(document.body.className=this[e]?"hidden":"visible","hidden"===document.body.className?(s_oMain.stopUpdate(),s_bFocus=!1):(s_oMain.startUpdate(),s_bFocus=!0))}var e="hidden";e in document?document.addEventListener("visibilitychange",a):(e="mozHidden")in document?document.addEventListener("mozvisibilitychange",
a):(e="webkitHidden")in document?document.addEventListener("webkitvisibilitychange",a):(e="msHidden")in document?document.addEventListener("msvisibilitychange",a):"onfocusin"in document?document.onfocusin=document.onfocusout=a:window.onpageshow=window.onpagehide=window.onfocus=window.onblur=a})();function ctlArcadeResume(){null!==s_oMain&&s_oMain.startUpdate()}function ctlArcadePause(){null!==s_oMain&&s_oMain.stopUpdate()}
function getParamValue(a){for(var e=window.location.search.substring(1).split("&"),d=0;d<e.length;d++){var c=e[d].split("=");if(c[0]==a)return c[1]}}function fullscreenHandler(){ENABLE_FULLSCREEN&&!1!==screenfull.isEnabled&&(s_bFullscreen=screenfull.isFullscreen,null!==s_oInterface&&s_oInterface.resetFullscreenBut(),null!==s_oMenu&&s_oMenu.resetFullscreenBut())}
if(screenfull.isEnabled)screenfull.on("change",function(){s_bFullscreen=screenfull.isFullscreen;null!==s_oInterface&&s_oInterface.resetFullscreenBut();null!==s_oMenu&&s_oMenu.resetFullscreenBut()});
function CSpriteLibrary(){var a={},e,d,c,f,m,h;this.init=function(l,b,g){e={};c=d=0;f=l;m=b;h=g};this.addSprite=function(l,b){if(!a.hasOwnProperty(l)){var g=new Image;a[l]=e[l]={szPath:b,oSprite:g,bLoaded:!1};d++}};this.getSprite=function(l){return a.hasOwnProperty(l)?a[l].oSprite:null};this._onSpritesLoaded=function(){d=0;m.call(h)};this._onSpriteLoaded=function(){f.call(h);++c===d&&this._onSpritesLoaded()};this.loadSprites=function(){for(var l in e)e[l].oSprite.oSpriteLibrary=this,e[l].oSprite.szKey=
l,e[l].oSprite.onload=function(){this.oSpriteLibrary.setLoaded(this.szKey);this.oSpriteLibrary._onSpriteLoaded(this.szKey)},e[l].oSprite.onerror=function(b){var g=b.currentTarget;setTimeout(function(){e[g.szKey].oSprite.src=e[g.szKey].szPath},500)},e[l].oSprite.src=e[l].szPath};this.setLoaded=function(l){a[l].bLoaded=!0};this.isLoaded=function(l){return a[l].bLoaded};this.getNumSprites=function(){return d}}
var CANVAS_WIDTH=1080,CANVAS_HEIGHT=1920,EDGEBOARD_X=25,EDGEBOARD_Y=200,CELL_SIZE=106,FPS_TIME=1E3/30,DISABLE_SOUND_MOBILE=!1,PRIMARY_FONT="comfortaa",SECONDARY_FONT="blackplotan",GAME_Y_OFFSET=6,TIME_LOOP_WAIT=2E3,STATE_LOADING=0,STATE_MENU=1,STATE_HELP=1,STATE_GAME=3,EASY_MODE=0,MEDIUM_MODE=1,HARD_MODE=2,ON_MOUSE_DOWN=0,ON_MOUSE_UP=1,ON_MOUSE_OVER=2,ON_MOUSE_OUT=3,ON_DRAG_START=4,ON_DRAG_END=5,MAX_GIVENS_EASY,MAX_GIVENS_MEDIUM,MAX_GIVENS_HARD,RANGE_GIVENS=0,LOWER_BOUND_EASY=4,LOWER_BOUND_MEDIUM=
3,LOWER_BOUND_HARD=2,TIME_BONUS_LIMIT=[],ENABLE_FULLSCREEN,ENABLE_CHECK_ORIENTATION,WORD_LIST=[];
function CPreloader(){var a,e,d,c,f,m,h,l,b,g;this._init=function(){s_oSpriteLibrary.init(this._onImagesLoaded,this._onAllImagesLoaded,this);s_oSpriteLibrary.addSprite("progress_bar","./sprites/progress_bar.png");s_oSpriteLibrary.addSprite("200x200","./sprites/200x200.jpg");s_oSpriteLibrary.addSprite("but_start","./sprites/but_start.png");s_oSpriteLibrary.loadSprites();g=new createjs.Container;s_oStage.addChild(g)};this.unload=function(){g.removeAllChildren();b.unload()};this._onImagesLoaded=function(){};
this._onAllImagesLoaded=function(){this.attachSprites();s_oMain.preloaderReady()};this.attachSprites=function(){var k=new createjs.Shape;k.graphics.beginFill("black").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);g.addChild(k);k=s_oSpriteLibrary.getSprite("200x200");h=createBitmap(k);h.regX=.5*k.width;h.regY=.5*k.height;h.x=CANVAS_WIDTH/2;h.y=CANVAS_HEIGHT/2-140;g.addChild(h);l=new createjs.Shape;l.graphics.beginFill("rgba(0,0,0,0.01)").drawRoundRect(h.x-100,h.y-100,200,200,10);g.addChild(l);h.mask=l;
k=s_oSpriteLibrary.getSprite("progress_bar");c=createBitmap(k);c.x=CANVAS_WIDTH/2-k.width/2;c.y=CANVAS_HEIGHT/2+90;g.addChild(c);a=k.width;e=k.height;f=new createjs.Shape;f.graphics.beginFill("rgba(0,0,0,0.01)").drawRect(c.x,c.y,1,e);g.addChild(f);c.mask=f;d=new createjs.Text("","30px "+PRIMARY_FONT,"#fff");d.x=CANVAS_WIDTH/2;d.y=CANVAS_HEIGHT/2+140;d.textBaseline="alphabetic";d.textAlign="center";g.addChild(d);k=s_oSpriteLibrary.getSprite("but_start");b=new CTextButton(CANVAS_WIDTH/2,CANVAS_HEIGHT/
2+40,k,TEXT_PRELOADER_CONTINUE,"Arial","#000",50,g);b.addEventListener(ON_MOUSE_UP,this._onButStartRelease,this);b.setVisible(!1);m=new createjs.Shape;m.graphics.beginFill("black").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);g.addChild(m);createjs.Tween.get(m).to({alpha:0},500).call(function(){createjs.Tween.removeTweens(m);g.removeChild(m)})};this._onButStartRelease=function(){s_oMain._onRemovePreloader()};this.refreshLoader=function(k){d.text=k+"%";100===k&&(s_oMain._onRemovePreloader(),d.visible=
!1,c.visible=!1);f.graphics.clear();k=Math.floor(k*a/100);f.graphics.beginFill("rgba(0,0,0,0.01)").drawRect(c.x,c.y,k,e)};this._init()}
function CMain(a){var e,d=0,c=0,f=STATE_LOADING,m,h;this.initContainer=function(){s_oCanvas=document.getElementById("canvas");s_oStage=new createjs.Stage(s_oCanvas);s_oStage.preventSelection=!1;createjs.Touch.enable(s_oStage,!0);s_bMobile=isMobile();!1===s_bMobile&&s_oStage.enableMouseOver(20);s_iPrevTime=(new Date).getTime();createjs.Ticker.addEventListener("tick",this._update);createjs.Ticker.framerate=30;navigator.userAgent.match(/Windows Phone/i)&&(DISABLE_SOUND_MOBILE=!0);s_oSpriteLibrary=new CSpriteLibrary;
m=new CPreloader};this.preloaderReady=function(){s_oMain._loadImages();!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||s_oMain._initSounds()};this.soundLoaded=function(){d++;m.refreshLoader(Math.floor(d/c*100))};this._initSounds=function(){Howler.mute(!s_bAudioActive);s_aSoundsInfo=[];s_aSoundsInfo.push({path:"./sounds/",filename:"click",loop:!1,volume:1,ingamename:"click"});s_aSoundsInfo.push({path:"./sounds/",filename:"game_over",loop:!1,volume:1,ingamename:"game_over"});c+=s_aSoundsInfo.length;s_aSounds=
[];for(var b=0;b<s_aSoundsInfo.length;b++)this.tryToLoadSound(s_aSoundsInfo[b],!1)};this.tryToLoadSound=function(b,g){setTimeout(function(){s_aSounds[b.ingamename]=new Howl({src:[b.path+b.filename+".mp3"],autoplay:!1,preload:!0,loop:b.loop,volume:b.volume,onload:s_oMain.soundLoaded,onloaderror:function(k,y){for(var u=0;u<s_aSoundsInfo.length;u++)if(k===s_aSounds[s_aSoundsInfo[u].ingamename]._sounds[0]._id){s_oMain.tryToLoadSound(s_aSoundsInfo[u],!0);break}},onplayerror:function(k){for(var y=0;y<s_aSoundsInfo.length;y++)if(k===
s_aSounds[s_aSoundsInfo[y].ingamename]._sounds[0]._id){s_aSounds[s_aSoundsInfo[y].ingamename].once("unlock",function(){s_aSounds[s_aSoundsInfo[y].ingamename].play()});break}}})},g?200:0)};this._loadImages=function(){s_oSpriteLibrary.init(this._onImagesLoaded,this._onAllImagesLoaded,this);s_oSpriteLibrary.addSprite("but_play","./sprites/but_play.png");s_oSpriteLibrary.addSprite("msg_box","./sprites/msg_box.png");s_oSpriteLibrary.addSprite("but_credits","./sprites/but_credits.png");s_oSpriteLibrary.addSprite("ctl_logo",
"./sprites/ctl_logo.png");s_oSpriteLibrary.addSprite("bg_menu","./sprites/bg_menu.jpg");s_oSpriteLibrary.addSprite("bg_mode_menu","./sprites/bg_mode_menu.jpg");s_oSpriteLibrary.addSprite("mod_easy_icon","./sprites/mod_easy_icon.png");s_oSpriteLibrary.addSprite("mod_medium_icon","./sprites/mod_medium_icon.png");s_oSpriteLibrary.addSprite("mod_hard_icon","./sprites/mod_hard_icon.png");s_oSpriteLibrary.addSprite("bg_game","./sprites/bg_game.jpg");s_oSpriteLibrary.addSprite("bg_help","./sprites/bg_help.png");
s_oSpriteLibrary.addSprite("bg_help2","./sprites/bg_help2.png");s_oSpriteLibrary.addSprite("arrow","./sprites/arrow.png");s_oSpriteLibrary.addSprite("but_exit","./sprites/but_exit.png");s_oSpriteLibrary.addSprite("audio_icon","./sprites/audio_icon.png");s_oSpriteLibrary.addSprite("config_icon","./sprites/config_icon.png");s_oSpriteLibrary.addSprite("but_help_icon","./sprites/but_help_icon.png");s_oSpriteLibrary.addSprite("but_help_note","./sprites/but_help_note.png");s_oSpriteLibrary.addSprite("but_del_note",
"./sprites/but_del_note.png");s_oSpriteLibrary.addSprite("but_solve","./sprites/but_solve.png");s_oSpriteLibrary.addSprite("but_reset","./sprites/but_reset.png");s_oSpriteLibrary.addSprite("but_time","./sprites/but_time.png");s_oSpriteLibrary.addSprite("but_help_hint","./sprites/but_help_hint.png");s_oSpriteLibrary.addSprite("time_display","./sprites/time_display.png");s_oSpriteLibrary.addSprite("given_bg","./sprites/given_bg.png");s_oSpriteLibrary.addSprite("blank","./sprites/blank.png");s_oSpriteLibrary.addSprite("background",
"./sprites/background.png");s_oSpriteLibrary.addSprite("highlight","./sprites/highlight.png");s_oSpriteLibrary.addSprite("cell_selected","./sprites/cell_selected.png");s_oSpriteLibrary.addSprite("but_num","./sprites/but_num.png");s_oSpriteLibrary.addSprite("but_del_toggle","./sprites/but_del_toggle.png");s_oSpriteLibrary.addSprite("note_toggle","./sprites/note_toggle.png");s_oSpriteLibrary.addSprite("mode_toggle","./sprites/mode_toggle.png");s_oSpriteLibrary.addSprite("credit_bg","./sprites/credit_bg.png");
s_oSpriteLibrary.addSprite("but_fullscreen","./sprites/but_fullscreen.png");c+=s_oSpriteLibrary.getNumSprites();s_oSpriteLibrary.loadSprites()};this._onImagesLoaded=function(){d++;m.refreshLoader(Math.floor(d/c*100))};this._onRemovePreloader=function(){m.unload();s_oMain.gotoMenu()};this._onAllImagesLoaded=function(){};this.gotoMenu=function(){new CMenu;f=STATE_MENU};this.goToModeMenu=function(){new CModeMenu;f=STATE_MENU};this.gotoGame=function(b){s_iDifficultyMode=b;h=new CGame(l);f=STATE_GAME};
this.gotoHelp=function(){new CHelp;f=STATE_HELP};this.stopUpdate=function(){e=!1;createjs.Ticker.paused=!0;$("#block_game").css("display","block");!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||Howler.mute(!0)};this.startUpdate=function(){s_iPrevTime=(new Date).getTime();e=!0;createjs.Ticker.paused=!1;$("#block_game").css("display","none");(!1===DISABLE_SOUND_MOBILE||!1===s_bMobile)&&s_bAudioActive&&Howler.mute(!1)};this._update=function(b){if(!1!==e){var g=(new Date).getTime();s_iTimeElaps=g-s_iPrevTime;
s_iCntTime+=s_iTimeElaps;s_iCntFps++;s_iPrevTime=g;1E3<=s_iCntTime&&(s_iCurFps=s_iCntFps,s_iCntTime-=1E3,s_iCntFps=0);f===STATE_GAME&&h.update();s_oStage.update(b)}};s_oMain=this;var l=a;ENABLE_FULLSCREEN=a.fullscreen;ENABLE_CHECK_ORIENTATION=a.check_orientation;s_bAudioActive=a.audio_enable_on_startup;this.initContainer()}
var s_bMobile,s_iDifficultyMode,s_bAudioActive=!0,s_iCntTime=0,s_iTimeElaps=0,s_iPrevTime=0,s_iCntFps=0,s_iCurFps=0,s_oDrawLayer,s_oStage,s_oMain,s_oSpriteLibrary,s_oCanvas,s_bFullscreen=!1,s_aSounds,s_aSoundsInfo;
function CTextButton(a,e,d,c,f,m,h,l){var b,g,k,y,u,v,x,n,I,J;this._init=function(q,w,A,G,B,R,E){b=!1;g=1;k=[];y=[];J=createBitmap(A);n=new createjs.Container;n.x=q;n.y=w;n.regX=A.width/2;n.regY=A.height/2;s_bMobile||(n.cursor="pointer");n.addChild(J,I);l.addChild(n);I=new CTLText(n,10,5,A.width-20,A.height-10,E,"center",R,B,1,0,0,G,!0,!0,!1,!1);this._initListener()};this.unload=function(){n.off("mousedown",u);n.off("pressup",v);l.removeChild(n)};this.setVisible=function(q){n.visible=q};this.setAlign=
function(q){I.textAlign=q};this.setTextX=function(q){I.x=q};this.setScale=function(q){g=n.scaleX=n.scaleY=q};this.enable=function(){b=!1};this.disable=function(){b=!0};this._initListener=function(){u=n.on("mousedown",this.buttonDown);v=n.on("pressup",this.buttonRelease)};this.addEventListener=function(q,w,A){k[q]=w;y[q]=A};this.addEventListenerWithParams=function(q,w,A,G){k[q]=w;y[q]=A;x=G};this.buttonRelease=function(){b||(playSound("click",1,!1),n.scaleX=g,n.scaleY=g,k[ON_MOUSE_UP]&&k[ON_MOUSE_UP].call(y[ON_MOUSE_UP],
x))};this.buttonDown=function(){b||(n.scaleX=.9*g,n.scaleY=.9*g,k[ON_MOUSE_DOWN]&&k[ON_MOUSE_DOWN].call(y[ON_MOUSE_DOWN]))};this.setPosition=function(q,w){n.x=q;n.y=w};this.tweenPosition=function(q,w,A,G,B,R,E){createjs.Tween.get(n).wait(G).to({x:q,y:w},A,B).call(function(){void 0!==R&&R.call(E)})};this.changeText=function(q){I.refreshText(q)};this.setX=function(q){n.x=q};this.setY=function(q){n.y=q};this.getButtonImage=function(){return n};this.getX=function(){return n.x};this.getY=function(){return n.y};
this.getSprite=function(){return n};this.getScale=function(){return n.scaleX};this._init(a,e,d,c,f,m,h)}
function CToggle(a,e,d,c,f){var m,h,l,b;this._init=function(k,y,u,v){h=[];l=[];var x=new createjs.SpriteSheet({images:[u],frames:{width:u.width/2,height:u.height,regX:u.width/2/2,regY:u.height/2},animations:{state_true:[0],state_false:[1]}});m=v;b=createSprite(x,"state_"+m,u.width/2/2,u.height/2,u.width/2,u.height);b.x=k;b.y=y;b.stop();g.addChild(b);this._initListener()};this.unload=function(){b.off("mousedown",this.buttonDown);b.off("pressup",this.buttonRelease);s_bMobile||b.off("mouseover",this.buttonOver);
g.removeChild(b)};this._initListener=function(){b.on("mousedown",this.buttonDown);b.on("pressup",this.buttonRelease);if(!s_bMobile)b.on("mouseover",this.buttonOver)};this.addEventListener=function(k,y,u){h[k]=y;l[k]=u};this.setActive=function(k){m=k;b.gotoAndStop("state_"+m)};this.buttonRelease=function(){b.scaleX=1;b.scaleY=1;playSound("click",1,!1);m=!m;b.gotoAndStop("state_"+m);h[ON_MOUSE_UP]&&h[ON_MOUSE_UP].call(l[ON_MOUSE_UP],m)};this.buttonDown=function(){b.scaleX=.9;b.scaleY=.9;h[ON_MOUSE_DOWN]&&
h[ON_MOUSE_DOWN].call(l[ON_MOUSE_DOWN])};this.buttonOver=function(k){s_bMobile||(k.target.cursor="pointer")};this.setPosition=function(k,y){b.x=k;b.y=y};var g=f;this._init(a,e,d,c)}
function CDeleteButton(a,e,d,c){var f,m,h,l,b;this._init=function(g,k,y,u){m=!0;h=[];l=[];var v=new createjs.SpriteSheet({images:[y],frames:{width:y.width/2,height:y.height,regX:y.width/2/2,regY:y.height/2},animations:{state_true:[0],state_false:[1]}});f=u;b=createSprite(v,"state_"+f,y.width/2/2,y.height/2,y.width/2,y.height);b.x=g;b.y=k;b.stop();s_oStage.addChild(b);this._initListener()};this.unload=function(){b.off("mousedown",this.buttonDown);b.off("pressup",this.buttonRelease);s_bMobile||b.off("mouseover",
this.buttonOver);s_oStage.removeChild(b)};this.changeMode=function(){m=!m;f=!1;b.gotoAndStop("state_"+f)};this.reset=function(){f=!1;b.gotoAndStop("state_"+f)};this._initListener=function(){b.on("mousedown",this.buttonDown);b.on("pressup",this.buttonRelease);if(!s_bMobile)b.on("mouseover",this.buttonOver)};this.buttonOver=function(g){s_bMobile||(g.target.cursor="pointer")};this.addEventListener=function(g,k,y){h[g]=k;l[g]=y};this.setActive=function(g){f=g;b.gotoAndStop("state_"+f)};this.buttonRelease=
function(){b.scaleX=1;b.scaleY=1;m?(s_oInterface.setAllBlackColor(),f=!0,b.gotoAndStop("state_"+f),s_oGame.setDeleteState()):s_oGame.deleteCell();h[ON_MOUSE_UP]&&h[ON_MOUSE_UP].call(l[ON_MOUSE_UP],f)};this.buttonDown=function(){b.scaleX=.9;b.scaleY=.9;h[ON_MOUSE_DOWN]&&h[ON_MOUSE_DOWN].call(l[ON_MOUSE_DOWN])};this.setPosition=function(g,k){b.x=g;b.y=k};this._init(a,e,d,c)}
function CGfxButton(a,e,d,c){var f,m,h,l,b,g,k;this._init=function(u,v,x,n){f=!1;m=1;h=[];l=[];k=createBitmap(x);k.x=u;k.y=v;k.scaleX=k.scaleY=m;k.regX=x.width/2;k.regY=x.height/2;k.cursor="pointer";n.addChild(k);this._initListener()};this.unload=function(){k.off("mousedown",b);k.off("pressup",g);c.removeChild(k)};this.setVisible=function(u){k.visible=u};this.setClickable=function(u){f=!u};this._initListener=function(){b=k.on("mousedown",this.buttonDown);g=k.on("pressup",this.buttonRelease)};this.addEventListener=
function(u,v,x){h[u]=v;l[u]=x};this.buttonRelease=function(){f||(k.scaleX=m,k.scaleY=m,h[ON_MOUSE_UP]&&h[ON_MOUSE_UP].call(l[ON_MOUSE_UP]))};this.buttonDown=function(){f||(k.scaleX=.9*m,k.scaleY=.9*m,playSound("click",1,!1),h[ON_MOUSE_DOWN]&&h[ON_MOUSE_DOWN].call(l[ON_MOUSE_DOWN]))};this.inversePulse=function(){createjs.Tween.get(k).to({scaleX:1.1*m,scaleY:1.1*m},1050,createjs.Ease.quadOut).to({scaleX:m,scaleY:m},850,createjs.Ease.quadIn).call(function(){y.inversePulse()})};this.setPosition=function(u,
v){k.x=u;k.y=v};this.setX=function(u){k.x=u};this.setY=function(u){k.y=u};this.getButtonImage=function(){return k};this.getX=function(){return k.x};this.getY=function(){return k.y};var y=this;this._init(a,e,d,c);return this}
function CMenu(){var a,e,d,c,f,m,h,l,b,g,k,y,u=null,v=null;this._init=function(){h=createBitmap(s_oSpriteLibrary.getSprite("bg_menu"));s_oStage.addChild(h);var x=s_oSpriteLibrary.getSprite("but_play");l=new CGfxButton(CANVAS_WIDTH/2,CANVAS_HEIGHT/2+110,x,s_oStage);l.addEventListener(ON_MOUSE_UP,this._onButPlayRelease,this);l.inversePulse();if(!1===DISABLE_SOUND_MOBILE||!1===s_bMobile)x=s_oSpriteLibrary.getSprite("audio_icon"),f=CANVAS_WIDTH-x.height/2-10,m=x.height/2+10,g=new CToggle(f,m,x,s_bAudioActive,
s_oStage),g.addEventListener(ON_MOUSE_UP,this._onAudioToggle,this);x=s_oSpriteLibrary.getSprite("but_credits");d=x.height/2+10;c=x.height/2+10;k=new CGfxButton(d,c,x,s_oStage);k.addEventListener(ON_MOUSE_UP,this._onButCreditRelease,this);x=window.document;var n=x.documentElement;u=n.requestFullscreen||n.mozRequestFullScreen||n.webkitRequestFullScreen||n.msRequestFullscreen;v=x.exitFullscreen||x.mozCancelFullScreen||x.webkitExitFullscreen||x.msExitFullscreen;!1===ENABLE_FULLSCREEN&&(u=!1);u&&screenfull.isEnabled&&
(x=s_oSpriteLibrary.getSprite("but_fullscreen"),a=d+x.width/2+10,e=c,y=new CToggle(a,e,x,s_bFullscreen,s_oStage),y.addEventListener(ON_MOUSE_UP,this._onFullscreenRelease,this));b=new createjs.Shape;b.graphics.beginFill("black").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);s_oStage.addChild(b);createjs.Tween.get(b).to({alpha:0},1E3).call(function(){b.visible=!1});this.refreshButtonPos(s_iOffsetX,s_iOffsetY)};this.unload=function(){l.unload();l=null;if(!1===DISABLE_SOUND_MOBILE||!1===s_bMobile)g.unload(),
g=null;u&&screenfull.isEnabled&&y.unload();s_oStage.removeChild(h);s_oMenu=h=null};this.refreshButtonPos=function(x,n){k.setPosition(d+x,n+c);!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||g.setPosition(f-x,n+m);u&&screenfull.isEnabled&&y.setPosition(a+x,e+n)};this._onAudioToggle=function(){Howler.mute(s_bAudioActive);s_bAudioActive=!s_bAudioActive};this._onButPlayRelease=function(){this.unload();$(s_oMain).trigger("start_session");s_oMain.goToModeMenu()};this._onButCreditRelease=function(){new CCreditsPanel};
this.resetFullscreenBut=function(){u&&screenfull.isEnabled&&y.setActive(s_bFullscreen)};this._onFullscreenRelease=function(){s_bFullscreen?v.call(window.document):u.call(window.document.documentElement);sizeHandler()};s_oMenu=this;this._init()}var s_oMenu=null;
function CModeMenu(){var a,e,d,c,f,m,h,l;this._init=function(){a=createBitmap(s_oSpriteLibrary.getSprite("bg_mode_menu"));s_oStage.addChild(a);new CTLText(s_oStage,CANVAS_WIDTH/2-500,220,1E3,100,100,"center","#fff",SECONDARY_FONT,1,0,0,TEXT_TOP_MODE,!0,!0,!1,!1);var g=CANVAS_WIDTH/2;e=new createjs.Container;e.x=g;e.y=420;d=new createjs.Container;d.x=g;d.y=850;c=new createjs.Container;c.x=g;c.y=1280;new CTLText(e,-160,-40,320,50,50,"center","#fff",SECONDARY_FONT,1,0,0,TEXT_EASY,!0,!0,!1,!1);g=s_oSpriteLibrary.getSprite("mod_easy_icon");
f=new CGfxButton(0,160,g,e);f.addEventListener(ON_MOUSE_UP,this._selectEasy,this);new CTLText(d,-160,-40,320,50,50,"center","#fff",SECONDARY_FONT,1,0,0,TEXT_MEDIUM,!0,!0,!1,!1);g=s_oSpriteLibrary.getSprite("mod_medium_icon");m=new CGfxButton(0,160,g,d);m.addEventListener(ON_MOUSE_UP,this._selectMedium,this);new CTLText(c,-160,-40,320,50,50,"center","#fff",SECONDARY_FONT,1,0,0,TEXT_HARD,!0,!0,!1,!1);g=s_oSpriteLibrary.getSprite("mod_hard_icon");h=new CGfxButton(0,160,g,c);h.addEventListener(ON_MOUSE_UP,
this._selectHard,this);s_oStage.addChild(e,d,c);l=new createjs.Shape;l.graphics.beginFill("black").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);s_oStage.addChild(l);createjs.Tween.get(l).to({alpha:0},400).call(function(){l.visible=!1})};this._selectEasy=function(){b.unload();$(s_oMain).trigger("start_level",1);s_oMain.gotoGame(0)};this._selectMedium=function(){b.unload();$(s_oMain).trigger("start_level",1);s_oMain.gotoGame(1)};this._selectHard=function(){b.unload();$(s_oMain).trigger("start_level",1);
s_oMain.gotoGame(2)};this.unload=function(){s_oStage.removeAllChildren();a=null};this._onAudioToggle=function(){Howler.mute(s_bAudioActive);s_bAudioActive=!s_bAudioActive};var b=this;this._init()}
function CGame(a){function e(r){r||(r=window.event);r.preventDefault();r=r.keyCode-48;10>r&&0<r?A.pressNumButton(r):-2===r?A.pressDelButton():58>r&&48<r&&A.pressNumButton(r-48)}function d(r){r.preventDefault();r=r.keyCode-48;10>r&&0<r?A.releaseNumButton(r):-2===r?A.releaseDelButton():58>r&&48<r&&A.releaseNumButton(r-48)}var c,f,m,h,l,b,g,k,y,u,v,x,n,I,J,q,w,A,G=null,B,R,E,V;this._init=function(){k=g=b=l=h=m=!1;I=n=y=u=v=0;new CNumberConverter;var r=createBitmap(s_oSpriteLibrary.getSprite("bg_game"));
s_oStage.addChild(r);E=null;A=new CInterface;B=new CGrid;J=Array(81);this._generateValidGrid(J);J=this._convertToMatrix(J);q=[];for(r=0;9>r;r++){q[r]=[];for(var t=0;9>t;t++)q[r][t]=J[r][t]}R=new CSudokuLoader;f=!0;!1===s_bMobile&&(document.onkeydown=e,document.onkeyup=d)};this.getHint=function(){n++;for(var r=[],t=0;9>t;t++)for(var z=0;9>z;z++)0===J[t][z]&&r.push({row:t,col:z});if(1===r.length)this.gameOver();else if(0!==r.length){shuffle(r);t=r[0].row;z=r[0].col;var F=q[t][z];J[t][z]=F;B.setHintNumber(t,
z,F);B.setActiveCell(r[0]);B.updateNote(F);B.setActiveCell(r[0]);this._getEndCounterAndSetButCounter()}};this.setNoTime=function(){c=!1;A.setNoTime();k=!0};this.solveAndWrite=function(){for(var r=0;9>r;r++)for(var t=0;9>t;t++)B.isGiven(r,t)&&J[r][t]===q[r][t]||(B.setSolvedNumber(r,t,q[r][t]),J[r][t]=q[r][t]);this._setEndingStateWhenSolve();g=!0};this.resetGame=function(){for(var r=0;9>r;r++)for(var t=0;9>t;t++)B.isGiven(r,t)||(B.deleteResetNumber(r,t),J[r][t]=0);this._getEndCounterAndSetButCounter();
B.turnOffAllCells();B.highlightCells()};this.fillWithNote=function(){this.clearNoteFill();for(var r=B.getList(0),t=0;t<r.length;t++)for(var z=r[t],F=1;10>F;F++)!0!==B.checkCollision(F,z.row,z.col,!1)&&B.writeHelpNote(F,z.row,z.col);b=!0};this.deleteAllNote=function(){this.clearNoteFill()};this.clearNoteFill=function(){B.deleteAllNote()};this.setNoteState=function(){m=!m};this.setDigitState=function(){l=!l;h=!1;y=0};this.setDeleteState=function(){h=!0;y=0};this.setCurNum=function(r){h=!1;y=r};this.activeCell=
function(r){l&&!h?(B.setActiveCell(r),this.writeNum(y)):l&&h?(B.setActiveCell(r),B.deleteCell()):B.setActiveCell(r)};this.writeNum=function(r){if(m)B.writeNote(r);else{var t=B.getCurActiveCell().row,z=B.getCurActiveCell().col,F=B.getCurActiveCell().num;B.writeNum(r);A.updateCounterOnButton(r,B.getList(r).length);0!==F&&A.updateCounterOnButton(F,B.getList(F).length);J[t][z]=r}};this.deleteCell=function(){var r=B.getCurActiveCell().num,t=B.getCurActiveCell().row,z=B.getCurActiveCell().col;B.deleteCell();
0!==r&&(A.updateCounterOnButton(r,B.getList(r).length),J[t][z]=0)};this.showPausePanel=function(r){r?null===E&&(E=new CPausePanel):null!==E&&(E.unload(),E=null)};this.tryShowAd=function(){I++;I===AD_SHOW_COUNTER&&(I=0,$(s_oMain).trigger("show_interlevel_ad"))};this.restartGame=function(){this.unload();this._init()};this.unload=function(){A.unload();null!==G&&G.unload();createjs.Tween.removeAllTweens();s_oStage.removeAllChildren();s_oGame=null};this.onExit=function(){this.unload();s_oMain.gotoMenu()};
this._onExitHelp=function(){c=!0};this.checkEndGame=function(r){"add"===r?u++:u--;81===u&&this.gameOver()};this.gameOver=function(){var r=Math.floor((TIME_BONUS_LIMIT[s_iDifficultyMode]-v)/100);G=new CEndPanel(s_oSpriteLibrary.getSprite("msg_box"),b,g,k,n,r);G.show(v)};this.pauseTimer=function(r){c=!r};this.update=function(){if(f){R.update();for(var r=0;12>r;r++){for(var t=0;9>t;t++)for(var z=0;9>z;z++)J[t][z]=q[t][z];this._generateMask(s_iDifficultyMode);this._coverGrid(J);x=solve(J);if(1!==x){f=
!1;R.unload();this._coverGrid(J);this.setGrid(J);c=!0;s_oMain.startUpdate();break}}}c&&(v+=s_iTimeElaps,5999E3<v&&(v=5999E3),A.refreshTime(formatTime(v)))};this.setGrid=function(r){for(var t=0;9>t;t++)for(var z=0;9>z;z++)B.setGiven(t,z,r[t][z]);this._getEndCounterAndSetButCounter()};this._getEndCounterAndSetButCounter=function(){u=0;for(var r=1;10>r;r++){var t=B.getList(r).length;u+=t;A.updateCounterOnButton(r,t)}};this._setEndingStateWhenSolve=function(){u=81;for(var r=1;10>r;r++)A.updateCounterOnButton(r,
9);V=new createjs.Shape;V.graphics.beginFill("rgba(255,255,255,0.01)").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);s_oStage.addChild(V);V.on("mousedown",this.buttonDownWhenSolve);if(!s_bMobile)V.on("mouseover",this.buttonOverWhenSolve)};this.buttonDownWhenSolve=function(){V.off("mousedown",this.buttonDownWhenSolve);s_bMobile||V.off("mouseover",this.buttonOverWhenSolve);aa.gameOver()};this.buttonOverWhenSolve=function(r){s_bMobile||(r.target.cursor="pointer")};this._convertToMatrix=function(r){for(var t=
0,z=[],F=0;81>F;F+=9)z[t]=[r[F],r[F+1],r[F+2],r[F+3],r[F+4],r[F+5],r[F+6],r[F+7],r[F+8]],t++;return z};this._generateMask=function(r){w=[];for(var t=0;9>t;t++){w[t]=[];for(var z=0;9>z;z++)w[t][z]=0}t=MAX_GIVENS_EASY-RANGE_GIVENS;switch(r){case EASY_MODE:t=MAX_GIVENS_EASY-RANGE_GIVENS;var F=t+Math.ceil(Math.random()*RANGE_GIVENS);var O=LOWER_BOUND_EASY;break;case MEDIUM_MODE:t=MAX_GIVENS_MEDIUM-RANGE_GIVENS;F=t+Math.ceil(Math.random()*RANGE_GIVENS);O=LOWER_BOUND_MEDIUM;break;case HARD_MODE:t=MAX_GIVENS_HARD-
RANGE_GIVENS,F=t+Math.ceil(Math.random()*RANGE_GIVENS),O=LOWER_BOUND_HARD}var H=[];for(t=0;9>t;t++)t<O?H.push(1):H.push(0);r=[];for(t=0;9>t;t++)for(r[t]=0,shuffle(H),z=0;9>z;z++)1===H[z]&&(w[t][z]=1);var Q=[];for(t=0;9>t;t++)for(Q[t]=0,shuffle(H),z=0;9>z;z++)1===H[z]&&(w[z][t]=1);for(t=H=0;9>t;t++)for(z=0;9>z;z++)1===w[t][z]&&(r[t]++,Q[z]++,H++);F=H-F;if(0>F)this._generateMask(s_iDifficultyMode);else if(0===F)return;H=[];for(t=0;9>t;t++)for(z=0;9>z;z++)1===w[t][z]&&H.push({row:t,col:z,weightRow:r[t],
weightCol:Q[z],weightTotal:r[t]+Q[z]});H.sort(function(Y,Z){return Y.weightTotal<Z.weightTotal?-1:Y.weightTotal>Z.weightTotal?1:0});for(z=0;z<F;){t=H.length-1;if(0>t)break;if(H[t].weightRow>O&&H[t].weightCol>O){w[H[t].row][H[t].col]=0;var W=H[t].row,p=H[t].col;r[W]--;Q[p]--;for(t=0;t<H.length;t++)H[t].row===W&&(H[t].weightRow=r[W],H[t].weightTotal--),H[t].col===p&&(H[t].weightCol=Q[p],H[t].weightTotal--);z++}H.pop()}};this._coverGrid=function(r){for(var t=0;9>t;t++)for(var z=0;9>z;z++)0===w[t][z]&&
(r[t][z]=0)};this.printGrid=function(r){for(var t="",z=0;9>z;z++){for(var F=0;9>F;F++)if(t+=r[z][F]+" ",2===F||5===F)t+="| ";t+="\n";if(2===z||5===z)t+="---------------------\n"}trace(t)};this._generateValidGrid=function(r){for(var t=0;9>t;t++)for(var z=0;9>z;z++)r[9*t+z]=(3*t+Math.floor(t/3)+z)%9+1;for(t=0;42>t;t++){var F=Math.ceil(9*Math.random());do var O=Math.ceil(9*Math.random());while(F===O);for(z=0;9>z;z++)for(var H=0;9>H;H++)r[9*z+H]===F?r[9*z+H]=O:r[9*z+H]===O&&(r[9*z+H]=F)}for(H=0;42>H;H++)for(F=
Math.floor(3*Math.random()),O=Math.floor(3*Math.random()),z=0;9>z;z++)t=r[9*z+(3*F+H%3)],r[9*z+(3*F+H%3)]=r[9*z+(3*O+H%3)],r[9*z+(3*O+H%3)]=t;for(F=0;42>F;F++)for(H=Math.floor(3*Math.random()),O=Math.floor(3*Math.random()),z=0;9>z;z++)t=r[9*z+(F%3*3+H)],r[9*z+(F%3*3+H)]=r[9*z+(F%3*3+O)],r[9*z+(F%3*3+O)]=t;for(F=0;42>F;F++)for(z=Math.floor(3*Math.random()),O=Math.floor(3*Math.random()),H=0;9>H;H++)t=r[9*(F%3*3+z)+H],r[9*(F%3*3+z)+H]=r[9*(F%3*3+O)+H],r[9*(F%3*3+O)+H]=t};s_oGame=this;MAX_GIVENS_EASY=
a.max_givens_beginner;MAX_GIVENS_MEDIUM=a.max_givens_intermediate;MAX_GIVENS_HARD=a.max_givens_advanced;TIME_BONUS_LIMIT[0]=a.bonus_time_beginner;TIME_BONUS_LIMIT[1]=a.bonus_time_intermediate;TIME_BONUS_LIMIT[2]=a.bonus_time_advanced;AD_SHOW_COUNTER=a.ad_show_counter;var aa=this;this._init()}var s_oGame;
function CInterface(){var a,e,d,c,f,m,h,l,b,g,k,y,u,v,x,n,I,J,q;this._init=function(){b=[];for(var w=0;9>w;w++)b[w+1]=5<w?new CNumButton(97+177.5*(w-6),1650,w+1):new CNumButton(97+177.5*w,1500,w+1);w=s_oSpriteLibrary.getSprite("but_del_toggle");g=new CDeleteButton(629.5,1650,w,!1);g.changeMode();w=s_oSpriteLibrary.getSprite("note_toggle");k=new CToggle(807,1650,w,!0,s_oStage);k.addEventListener(ON_MOUSE_UP,this._onNoteToggle,this);w=s_oSpriteLibrary.getSprite("mode_toggle");y=new CToggle(984.5,1650,
w,!0,s_oStage);y.addEventListener(ON_MOUSE_UP,this._onModeToggle,this);var A;w=s_oSpriteLibrary.getSprite("but_exit");h=CANVAS_WIDTH-w.height/2-20;l=w.height/2+10;J=new CGfxButton(h,l,w,s_oStage);J.addEventListener(ON_MOUSE_UP,this._onExit,this);f=A=CANVAS_WIDTH-w.width/2-175;m=w.height/2+10;if(!1===DISABLE_SOUND_MOBILE||!1===s_bMobile)w=s_oSpriteLibrary.getSprite("audio_icon"),n=new CToggle(f,m,w,s_bAudioActive,s_oStage),n.addEventListener(ON_MOUSE_UP,this._onAudioToggle,this);A=CANVAS_WIDTH-w.width/
2-252;w=s_oSpriteLibrary.getSprite("config_icon");d=A;c=w.height/2+10;I=new CGfxButton(d,c,w,s_oStage);I.addEventListener(ON_MOUSE_UP,this._onConf,this);A=CANVAS_WIDTH-w.width/2-490;w=s_oSpriteLibrary.getSprite("but_help_icon");a=A;e=w.height/2+10;u=new CGfxButton(a,e,w,s_oStage);u.addEventListener(ON_MOUSE_UP,this._onHelpPress,this);w=s_oSpriteLibrary.getSprite("time_display");x=createBitmap(w);x.x=18;x.y=256;s_oStage.addChild(x);v=new CTLText(s_oStage,110,280,300,60,60,"center","#007eff",PRIMARY_FONT,
1.1,0,0,"00:00",!0,!0,!0,!1);this.refreshButtonPos(s_iOffsetX,s_iOffsetY)};this.unload=function(){if(!1===DISABLE_SOUND_MOBILE||!1===s_bMobile)n.unload(),n=null;J.unload();for(var w=0;9>w;w++)b[w+1].unload();g.unload();k.unload();y.unload();u.unload();s_oInterface=null};this.refreshButtonPos=function(w,A){J.setPosition(h-w,A+l);I.setPosition(d-w,A+c);u.setPosition(a-w,A+e);!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||n.setPosition(f-w,A+m)};this.refreshTime=function(w){v.refreshText(w)};this._onConf=
function(){q=new CConfigPanel};this.setNoTime=function(){s_oStage.removeChild(v.getText(),x)};this._onHelpPress=function(){new CHelpPanel;s_oGame.pauseTimer(!0)};this._onNoteToggle=function(){s_oGame.setNoteState()};this._onModeToggle=function(){for(var w=0;9>w;w++)b[w+1].changeMode();g.changeMode();this.setAllBlackColor();s_oGame.setDigitState()};this.updateCounterOnButton=function(w,A){b[w].clearCounter();b[w].setCounter(A)};this.pressNumButton=function(w){b[w].buttonDown()};this.releaseNumButton=
function(w){b[w].buttonRelease()};this.pressDelButton=function(){g.buttonDown()};this.releaseDelButton=function(w){g.buttonRelease()};this.resetFullscreenBut=function(){q&&q.resetFullscreenBut()};this.setAllBlackColor=function(){for(var w=0;9>w;w++)b[w+1].changeNumColor(!1);g.reset()};this._onAudioToggle=function(){Howler.mute(s_bAudioActive);s_bAudioActive=!s_bAudioActive};this._onExit=function(){$(s_oMain).trigger("end_level",1);$(s_oMain).trigger("end_session");$(s_oMain).trigger("show_interlevel_ad");
s_oGame.onExit()};s_oInterface=this;this._init();return this}var s_oInterface=null;
function CHelpPanel(){var a,e,d,c,f,m,h;this._init=function(){var b=this;c=new createjs.Container;s_oStage.addChild(c);e=createBitmap(s_oSpriteLibrary.getSprite("bg_help"));c.addChild(e);var g=CANVAS_WIDTH/2,k=CANVAS_HEIGHT/2-400;new CTLText(c,g-350,k-210,700,140,140,"center","#fff",SECONDARY_FONT,1,0,0,TEXT_HELP0,!0,!0,!1,!1);new CTLText(c,g-400,k,800,250,48,"center","#fff",PRIMARY_FONT,1,0,0,TEXT_HELP1,!0,!0,!0,!1);c.on("pressup",function(){b._onExitHelp()});f=new createjs.Container;f.visible=0;
s_oStage.addChild(f);f.on("pressup",function(){b._onExitHelp()});d=createBitmap(s_oSpriteLibrary.getSprite("bg_help2"));f.addChild(d);a=!1===s_bMobile?TEXT_HELP1_PAGE2:TEXT_HELP1_MOB_PAGE2;new CTLText(f,g-400,k-210,800,140,140,"center","#fff",SECONDARY_FONT,1,0,0,TEXT_HELP0_PAGE2,!0,!0,!1,!1);new CTLText(f,CANVAS_WIDTH/2-400,CANVAS_HEIGHT/2-470,800,80,35,"center","#fff",PRIMARY_FONT,1,0,0,a,!0,!0,!0,!1);new CTLText(f,CANVAS_WIDTH/2-200,CANVAS_HEIGHT/2-300,600,150,35,"left","#fff",PRIMARY_FONT,1,0,
0,TEXT_HELP2_PAGE2,!0,!0,!0,!1);new CTLText(f,CANVAS_WIDTH/2-380,CANVAS_HEIGHT/2+10,600,150,35,"right","#fff",PRIMARY_FONT,1,0,0,TEXT_HELP3_PAGE2,!0,!0,!0,!1);new CTLText(f,CANVAS_WIDTH/2-200,CANVAS_HEIGHT/2+300,600,150,35,"left","#fff",PRIMARY_FONT,1,0,0,TEXT_HELP4_PAGE2,!0,!0,!0,!1);createjs.Tween.get(f).to({alpha:1},700);m=createBitmap(s_oSpriteLibrary.getSprite("arrow"));m.x=740;m.y=1450;m.alpha=0;m.on("click",b._changePageTo2);if(!s_bMobile)m.on("mouseover",b.buttonOver);s_oStage.addChild(m);
h=createBitmap(s_oSpriteLibrary.getSprite("arrow"));h.scaleX=-1;h.x=340;h.y=1450;h.visible=!1;h.on("click",b._changePageTo1);if(!s_bMobile)h.on("mouseover",b.buttonOver);s_oStage.addChild(h);createjs.Tween.get(m).to({alpha:1},700)};this.unload=function(){s_oStage.removeChild(c,f,m,h);var b=this;c.off("pressup",function(){b._onExitHelp()});f.off("pressup",function(){b._onExitHelp()});s_bMobile||(m.off("mouseover",b.buttonOver),h.off("mouseover",b.buttonOver))};this._changePageTo1=function(){f.visible=
!1;h.visible=!1;c.visible=!0;m.visible=!0};this._changePageTo2=function(){c.visible=!1;m.visible=!1;f.visible=!0;h.visible=!0};this.buttonOver=function(b){s_bMobile||(b.target.cursor="pointer")};this._onExitHelp=function(){$(s_oMain).trigger("show_interlevel_ad");l.unload();s_oGame._onExitHelp()};var l=this;this._init()}
function CPausePanel(){var a,e,d;this._init=function(){a=createBitmap(s_oSpriteLibrary.getSprite("msg_box"));d=new createjs.Text(TEXT_PAUSE," 120px blackplotan","#ffffff");d.x=CANVAS_WIDTH/2;d.y=CANVAS_HEIGHT/2;d.textAlign="center";d.textBaseline="alphabetic";d.lineWidth=700;e=new createjs.Container;e.addChild(a,d);s_oStage.addChild(e);s_oStage.update()};this.unload=function(){s_oStage.removeChild(e)};this._init()}
function CSudokuLoader(){var a,e,d,c,f;this._init=function(){a=!0;e=0;d=new createjs.Container;s_oStage.addChild(d);var m=(new createjs.Graphics).beginFill("rgba(0,0,0,0.8)").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);f=new createjs.Shape(m);f.on("click",function(){});d.addChild(f);new CTLText(d,.5*CANVAS_WIDTH-400,.5*CANVAS_HEIGHT-100,800,120,60,"center","#fff",SECONDARY_FONT,1,0,0,TEXT_GENERATE_SUDOKU,!0,!0,!0,!1);c=new createjs.Text("","180px "+PRIMARY_FONT,"#ffffff");c.x=.5*CANVAS_WIDTH-60;c.y=
.5*CANVAS_HEIGHT+50;c.textAlign="left";c.textBaseline="alphabetic";c.lineWidth=800;d.addChild(c)};this.unload=function(){a=!1;s_oStage.removeChild(d)};this.update=function(){a&&(e+=s_iTimeElaps,0<=e&&e<TIME_LOOP_WAIT/4?c.text="":e>=TIME_LOOP_WAIT/4&&e<2*TIME_LOOP_WAIT/4?c.text=".":e>=2*TIME_LOOP_WAIT/4&&e<3*TIME_LOOP_WAIT/4?c.text="..":e>=3*TIME_LOOP_WAIT/4&&e<TIME_LOOP_WAIT?c.text="...":e=0)};s_oSudokuLoader=this;this._init()}var s_oSudokuLoader;
function CEndPanel(a,e,d,c,f,m){var h,l,b,g,k,y,u,v;this._init=function(x,n,I,J,q,w){h=w;if(0<q){var A=Math.floor(TIME_BONUS_LIMIT[s_iDifficultyMode]/4E3);h-=A*q;0>=h&&(h=0)}n&&(h/=2);if(I||J)h=0;l=[];n&&l.push(TEXT_HELP_NOTE+" "+TEXT_INFO_NOTE);I&&l.push(TEXT_HELP_SOLVE+" "+TEXT_INFO_SOLVE);J&&l.push(TEXT_HELP_TIME+" "+TEXT_INFO_SOLVE);0<q&&(1<q?l.push(q+TEXT_HELP_HINTS+" (-"+A+" "+TEXT_INFO_HINT):l.push(q+TEXT_HELP_HINT+" (-"+A+" "+TEXT_INFO_HINT));k=new createjs.Container;k.alpha=0;k.visible=!1;
s_oStage.addChild(k);g=createBitmap(x);k.addChild(g);y=new CTLText(k,CANVAS_WIDTH/2-350,CANVAS_HEIGHT/2-562,700,300,80,"center","#fff",SECONDARY_FONT,1,0,0," ",!0,!0,!0,!1);u=new CTLText(k,CANVAS_WIDTH/2-350,CANVAS_HEIGHT/2-220,700,80,50,"center","#fff",SECONDARY_FONT,1,0,0," ",!0,!0,!0,!1);b=[];x=CANVAS_WIDTH/2-350;b[0]=new CTLText(k,x,CANVAS_HEIGHT/2-90,700,80,40,"center","#fff",SECONDARY_FONT,1,0,0," ",!0,!0,!0,!1);b[1]=new CTLText(k,x,CANVAS_HEIGHT/2+10,700,80,40,"center","#fff",SECONDARY_FONT,
1,0,0," ",!0,!0,!0,!1);b[2]=new CTLText(k,x,CANVAS_HEIGHT/2+110,700,80,40,"center","#fff",SECONDARY_FONT,1,0,0," ",!0,!0,!0,!1);b[3]=new CTLText(k,x,CANVAS_HEIGHT/2+210,700,80,40,"center","#fff",SECONDARY_FONT,1,0,0," ",!0,!0,!0,!1);v=new CTLText(k,x,CANVAS_HEIGHT/2+380,700,70,70,"center","#fff",SECONDARY_FONT,1,0,0," ",!0,!0,!1,!1)};this.unload=function(){k.off("mousedown",this._onExit)};this._initListener=function(){k.on("mousedown",this._onExit)};this.show=function(x){playSound("game_over",1,!1);
x=formatTime(x);var n=[];n[0]=TEXT_EASY;n[1]=TEXT_MEDIUM;n[2]=TEXT_EASY;c?y.refreshText(TEXT_GAMEOVER+n[s_iDifficultyMode]+TEXT_SUDOKU):y.refreshText(TEXT_GAMEOVER+n[s_iDifficultyMode]+TEXT_SUDOKU+TEXT_IN+x);1===l.length?u.refreshText(TEXT_HELP_USED):1<l.length&&u.refreshText(TEXT_HELPS_USED);if(0<l.length)for(n=0;n<l.length;n++)b[n].refreshText("-"+l[n]);v.refreshText(TEXT_SCORE+" "+h);k.visible=!0;var I=this;createjs.Tween.get(k).to({alpha:1},500).call(function(){I._initListener()});$(s_oMain).trigger("save_score",
[h,s_iDifficultyMode,x,e,d,c,f]);$(s_oMain).trigger("share_event",[h]);$(s_oMain).trigger("end_level",1)};this._onExit=function(){k.off("mousedown",this._onExit);s_oStage.removeChild(k);$(s_oMain).trigger("end_session");s_oGame.onExit()};this._init(a,e,d,c,f,m);return this}
function CConfigPanel(){var a=null,e=null,d,c,f,m,h,l,b,g,k,y,u,v,x,n,I,J;this._init=function(){s_oGame.pauseTimer(!0);var w=this;d=createBitmap(s_oSpriteLibrary.getSprite("msg_box"));y=new createjs.Container;y.x=130;y.y=450;s_oStage.addChild(y);new CTLText(y,0,-50,600,50,50,"left","#fff",SECONDARY_FONT,1,0,0,TEXT_GETHINT,!0,!0,!1,!1);var A=s_oSpriteLibrary.getSprite("but_help_hint");g=new CGfxButton(750,-60,A,y);g.addEventListener(ON_MOUSE_UP,this._onHintPress,this);u=new createjs.Container;u.x=
130;u.y=620;s_oStage.addChild(u);new CTLText(u,0,-50,600,50,50,"left","#fff",SECONDARY_FONT,1,0,0,TEXT_FILL_WITH_NOTE,!0,!0,!1,!1);A=s_oSpriteLibrary.getSprite("but_help_note");f=new CGfxButton(750,-60,A,u);f.addEventListener(ON_MOUSE_UP,this._onHelpPress,this);v=new createjs.Container;v.x=130;v.y=790;s_oStage.addChild(v);new CTLText(v,0,-50,600,50,50,"left","#fff",SECONDARY_FONT,1,0,0,TEXT_SOLVE,!0,!0,!1,!1);A=s_oSpriteLibrary.getSprite("but_solve");h=new CGfxButton(750,-60,A,v);h.addEventListener(ON_MOUSE_UP,
this._onSolvePress,this);x=new createjs.Container;x.x=130;x.y=1210;s_oStage.addChild(x);new CTLText(x,0,-50,600,50,50,"left","#fff",SECONDARY_FONT,1,0,0,TEXT_RESET,!0,!0,!1,!1);A=s_oSpriteLibrary.getSprite("but_reset");l=new CGfxButton(750,-60,A,x);l.addEventListener(ON_MOUSE_UP,this._onResetPress,this);n=new createjs.Container;n.x=130;n.y=1390;s_oStage.addChild(n);new CTLText(n,0,-50,600,50,50,"left","#fff",SECONDARY_FONT,1,0,0,TEXT_DELETE_ALL_NOTE,!0,!0,!1,!1);A=s_oSpriteLibrary.getSprite("but_del_note");
m=new CGfxButton(750,-60,A,n);m.addEventListener(ON_MOUSE_UP,this._onDelPress,this);I=new createjs.Container;I.x=130;I.y=1570;s_oStage.addChild(I);new CTLText(I,0,-50,600,50,50,"left","#fff",SECONDARY_FONT,1,0,0,TEXT_SETNOTIME,!0,!0,!1,!1);A=s_oSpriteLibrary.getSprite("but_time");b=new CGfxButton(750,-60,A,I);b.addEventListener(ON_MOUSE_UP,this._onTimePress,this);A=window.document;var G=A.documentElement;a=G.requestFullscreen||G.mozRequestFullScreen||G.webkitRequestFullScreen||G.msRequestFullscreen;
e=A.exitFullscreen||A.mozCancelFullScreen||A.webkitExitFullscreen||A.msExitFullscreen;!1===ENABLE_FULLSCREEN&&(a=!1);J=new createjs.Container;J.x=130;J.y=1030;s_oStage.addChild(J);a&&screenfull.isEnabled&&(new CTLText(J,0,-50,600,50,50,"left","#fff",SECONDARY_FONT,1,0,0,TEXT_FULLSCREEN,!0,!0,!1,!1),A=s_oSpriteLibrary.getSprite("but_fullscreen"),k=new CToggle(750,-60,A,s_bFullscreen,J),k.addEventListener(ON_MOUSE_UP,this._onFullscreenRelease,this));c=new createjs.Container;c.addChild(d,y,u,v,x,n,I,
J);s_oStage.addChild(c);d.on("pressup",function(){w._onExitHelp()})};this.unload=function(){$(s_oMain).trigger("show_interlevel_ad");s_oStage.removeChild(c);var w=this;d.off("pressup",function(){w._onExitHelp()})};this._onHelpPress=function(){s_oGame.fillWithNote();q._onExitHelp()};this._onDelPress=function(){s_oGame.deleteAllNote();q._onExitHelp()};this._onSolvePress=function(){s_oGame.solveAndWrite();q.unload()};this._onResetPress=function(){$(s_oMain).trigger("restart_level",1);s_oGame.resetGame();
q._onExitHelp()};this._onTimePress=function(){s_oGame.setNoTime();q._onExitHelp()};this._onHintPress=function(){s_oGame.getHint();q._onExitHelp()};this.resetFullscreenBut=function(){a&&screenfull.isEnabled&&k.setActive(s_bFullscreen)};this._onFullscreenRelease=function(){s_bFullscreen?e.call(window.document):a.call(window.document.documentElement);sizeHandler()};this._onExitHelp=function(){q.unload();s_oGame.pauseTimer(!1)};var q=this;this._init()}
function CGrid(){var a,e,d,c,f,m,h,l;this._init=function(){e=a=0;m=new createjs.Container;m.x=CANVAS_WIDTH/2;m.y=880;s_oStage.addChild(m);var b=CELL_SIZE,g=9*CELL_SIZE+44,k=.5*g,y=b,u=[];u.push(.5*b);h=[];for(var v=0;8>v;v++){if(2===v%3){var x=(new createjs.Graphics).beginFill("rgba(0,0,0,1)").drawRect(-k,-k+y,g,10);y+=b+10}else x=(new createjs.Graphics).beginFill("rgba(0,0,0,1)").drawRect(-k,-k+y,g,4),y+=b+4;u.push(y-.5*b);h[v]=new createjs.Shape(x);m.addChild(h[v])}y=b;l=[];for(v=0;8>v;v++)2===
v%3?(x=(new createjs.Graphics).beginFill("rgba(0,0,0,1)").drawRect(-k+y,-k,10,g),y+=b+10):(x=(new createjs.Graphics).beginFill("rgba(0,0,0,1)").drawRect(-k+y,-k,4,g),y+=b+4),l[v]=new createjs.Shape(x),m.addChild(l[v]);x=(new createjs.Graphics).beginFill("rgba(0,0,0,1)").drawRect(-k-10,-k-10,10,g+20);v=new createjs.Shape(x);m.addChild(v);x=(new createjs.Graphics).beginFill("rgba(0,0,0,1)").drawRect(k,-k-10,10,g+20);v=new createjs.Shape(x);m.addChild(v);x=(new createjs.Graphics).beginFill("rgba(0,0,0,1)").drawRect(-k-
10,-k-10,g+20,10);v=new createjs.Shape(x);m.addChild(v);x=(new createjs.Graphics).beginFill("rgba(0,0,0,1)").drawRect(-k-10,+k,g+20,10);g=new createjs.Shape(x);m.addChild(g);d=[];for(v=0;9>v;v++)for(d[v]=[],g=0;9>g;g++)d[v][g]={x:u[v],y:u[g]};c=[];for(v=0;9>v;v++)for(c[v]=[],g=0;9>g;g++)c[v][g]=new CCell(d[v][g].x-k,d[v][g].y-k,{row:v,col:g},m);f=[];for(v=0;10>v;v++)f[v]=[]};this.setCurNum=function(b){};this.setActiveCell=function(b){this.turnOffAllCells();a=b.row;e=b.col;this.highlightCells();0!==
c[a][e].getNumber()&&this.showSameNumbers(c[a][e].getNumber())};this.showCorner=function(){c[a][e].setCorner(!0)};this.turnOffAllCells=function(){for(var b=0;9>b;b++)for(var g=0;9>g;g++)c[b][g].highlight("off");c[a][e].setCorner(!1)};this.showSameNumbers=function(b){if(0!==b){for(var g=0;g<f[b].length;g++)c[f[b][g].row][f[b][g].col].highlight("green");for(g=0;9>g;g++)for(var k=0;9>k;k++)0!==c[g][k].getNote(b)&&c[g][k].highlight("green")}};this.highlightCells=function(){this.showCorner();for(var b=
0;9>b;b++)c[a][b].highlight("yellow");for(b=0;9>b;b++)c[b][e].highlight("yellow");b=3*Math.floor(a/3);for(var g=3*Math.floor(e/3),k=0;3>k;k++)for(var y=0;3>y;y++)c[b+k][g+y].highlight("yellow")};this.deleteCell=function(){c[a][e].getGiven()||(0!==c[a][e].getNumber()&&s_oGame.checkEndGame("remove"),this.deleteSmartFromList(c[a][e].getNumber()),c[a][e].clearCell(),this.turnOffAllCells(),this.highlightCells())};this.writeNum=function(b){c[a][e].getGiven()||0===b||b===c[a][e].getNumber()||(this.turnOffAllCells(),
this.highlightCells(),this.checkCollision(b,a,e,!0)||(0!==c[a][e].getNumber()&&this.deleteCell(),c[a][e].setNumber(b),this.insertSmartInList(b),this.updateNote(b),this.showSameNumbers(b),s_oGame.checkEndGame("add")))};this.deleteAllNote=function(){for(var b=0;b<f[0].length;b++)c[f[0][b].row][f[0][b].col].clearAllNote();this.turnOffAllCells();this.highlightCells();this.showSameNumbers(c[a][e].getNumber())};this.writeNote=function(b){c[a][e].getGiven()||(this.turnOffAllCells(),this.highlightCells(),
c[a][e].setNote(b),this.showSameNumbers(c[a][e].getNumber()))};this.writeHelpNote=function(b,g,k){c[g][k].setHelpNote(b)};this.setGiven=function(b,g,k){c[b][g].setGiven(k);f[k].push({row:b,col:g})};this.isGiven=function(b,g){return c[b][g].getGiven()};this.setSolvedNumber=function(b,g,k){c[b][g].setHintNumber(k);f[k].push({row:b,col:g});for(k=0;k<f[0].length;k++)f[0][k].row===b&&f[0][k].col===g&&f[0].splice(k,1)};this.setHintNumber=function(b,g,k){c[b][g].setHintNumber(k);f[k].push({row:b,col:g});
for(k=0;k<f[0].length;k++)f[0][k].row===b&&f[0][k].col===g&&f[0].splice(k,1)};this.deleteResetNumber=function(b,g){var k=c[b][g].getNumber();if(0!==k){for(var y=0;y<f[k].length;y++)f[k][y].row===b&&f[k][y].col===g&&f[k].splice(y,1);c[b][g].clearCell()}f[0].push({row:b,col:g})};this.updateNote=function(b){for(var g=0;9>g;g++)0!==c[a][g].getNote(b)&&c[a][g].clearNote(b),0!==c[g][e].getNote(b)&&c[g][e].clearNote(b);var k=3*Math.floor(a/3),y=3*Math.floor(e/3);for(g=0;3>g;g++)for(var u=0;3>u;u++)0!==c[k+
g][y+u].getNote(b)&&c[k+g][y+u].clearNote(b)};this.checkCollision=function(b,g,k,y){for(var u=3*Math.floor(g/3),v=3*Math.floor(k/3),x=0;x<f[b].length;x++)if(f[b][x].row===g||f[b][x].col===k||u<=f[b][x].row&&f[b][x].row<u+3&&v<=f[b][x].col&&f[b][x].col<v+3)return y&&c[f[b][x].row][f[b][x].col].highlight("red"),!0};this.deleteSmartFromList=function(b){if(0!==b){for(var g=0;g<f[b].length;g++)f[b][g].row===a&&f[b][g].col===e&&f[b].splice(g,1);f[0].push({row:a,col:e})}};this.insertSmartInList=function(b){if(0!==
b)for(f[b].push({row:a,col:e}),b=0;b<f[0].length;b++)f[0][b].row===a&&f[0][b].col===e&&f[0].splice(b,1)};this.removeList=function(b){f[b]={}};this.getList=function(b){return f[b]};this.viewList=function(b){trace(f[b]);trace(f[b].length)};this.getCurActiveCell=function(){return{row:a,col:e,num:c[a][e].getNumber()}};this.getCurGrid=function(){for(var b=[],g=0;9>g;g++){b[g]=[];for(var k=0;9>k;k++)b[g][k]=c[g][k].getNumber()}return b};this._init()}
function CCell(a,e,d,c){var f,m,h,l,b,g,k,y,u,v;this._init=function(n,I,J,q){f=!1;var w=CELL_SIZE;m=0;l=[];v=new createjs.Container;v.x=n;v.y=I;q.addChild(v);b={row:J.row,col:J.col};n=s_oSpriteLibrary.getSprite("background");I={images:[n],frames:{width:n.width/2,height:n.height,regX:n.width/2/2,regY:n.height/2},animations:{white:[0],grey:[1]}};I=new createjs.SpriteSheet(I);k=createSprite(I,"white",n.width/2/2,n.height/2,n.width/2,n.height);v.addChild(k);n=s_oSpriteLibrary.getSprite("highlight");I=
{images:[n],frames:{width:n.width/3,height:n.height,regX:n.width/3/2,regY:n.height/2},animations:{yellow:[0],green:[1],red:[2]}};I=new createjs.SpriteSheet(I);g=createSprite(I,"yellow",n.width/3/2,n.height/2,n.width/2,n.height);g.alpha=.9;g.visible=!1;v.addChild(g);h=[];n=w/3;h[1]={x:-n,y:-n};h[2]={x:0,y:-n};h[3]={x:n,y:-n};h[4]={x:-n,y:0};h[5]={x:0,y:0};h[6]={x:n,y:0};h[7]={x:-n,y:n};h[8]={x:0,y:n};h[9]={x:+n,y:n};this.clearAllNote();n=s_oSpriteLibrary.getSprite("cell_selected");y=createBitmap(n);
y.regX=n.width/2;y.regY=n.height/2;y.visible=!1;v.addChild(y);(new createjs.Graphics).beginFill("rgba(158,158,158,0.01)").drawRect(-w/2,-w/2,w,w);v.on("click",this._setActive)};this.unload=function(){c.removeChild(v)};this.setGiven=function(n){0!==n&&(k.gotoAndStop("grey"),f=!0);this.setNumber(n)};this.getGiven=function(){return f};this.setHintNumber=function(n){if(0!==n){this.clearNumber();this.clearAllNote();var I=s_oNumberConverter.toText(n);u=new createjs.Text(I,"80px "+PRIMARY_FONT,"#add8fd");
u.textAlign="center";u.textBaseline="middle";u.y=GAME_Y_OFFSET;v.addChild(u);m=n}};this.setNumber=function(n){if(0!==n){this.clearNumber();this.clearAllNote();var I=s_oNumberConverter.toText(n);u=new createjs.Text(I,"80px "+PRIMARY_FONT,"#000000");u.textAlign="center";u.textBaseline="middle";u.y=GAME_Y_OFFSET;v.addChild(u);m=n}};this.getNumber=function(){return m};this.clearNumber=function(){m=0;v.removeChild(u)};this.setNote=function(n){if(0===m)if(0!==l[n])this.clearNote(n);else{var I=s_oNumberConverter.toText(n);
l[n]=new createjs.Text(I," 30px "+PRIMARY_FONT,"#000000");l[n].textAlign="center";l[n].textBaseline="middle";l[n].x=h[n].x;l[n].y=h[n].y;v.addChild(l[n])}};this.setHelpNote=function(n){this.clearNote(n);var I=s_oNumberConverter.toText(n);l[n]=new createjs.Text(I," 30px "+PRIMARY_FONT,"#000000");l[n].textAlign="center";l[n].textBaseline="middle";l[n].x=h[n].x;l[n].y=h[n].y;v.addChild(l[n])};this.getNote=function(n){return l[n]};this.clearNote=function(n){v.removeChild(l[n]);l[n]=0};this.clearAllNote=
function(){for(var n=1;10>n;n++)v.removeChild(l[n]),l[n]=0};this.clearCell=function(){this.clearNumber();this.clearAllNote()};this.highlight=function(n){g.visible=!0;"off"!==n?g.gotoAndStop(n):g.visible=!1};this.setCorner=function(n){y.visible=n?!0:!1};this._setActive=function(){x.highlight("yellow");s_oGame.activeCell(b)};var x=this;this._init(a,e,d,c)}
function CNumButton(a,e,d){var c,f,m,h,l,b,g,k;this._init=function(u,v,x){m=!1;h=x;g=new createjs.Container;g.x=u;g.y=v;s_oStage.addChild(g);v=s_oSpriteLibrary.getSprite("but_num");l=createBitmap(v);u=v.width;v=v.height;l.regX=u/2;l.regY=v/2;x=s_oNumberConverter.toText(x);b=new createjs.Text(x,"90px "+PRIMARY_FONT,"#007eff");b.textAlign="center";b.textBaseline="middle";b.y=GAME_Y_OFFSET;g.addChild(l,b);c=u/3-2;f=-v/3+5;this.setCounter(0);this._initListener()};this.unload=function(){g.off("mousedown");
g.off("pressup");s_bMobile||g.off("mouseover",this.buttonOver);s_oStage.removeChild(g)};this._initListener=function(){g.on("mousedown",this.buttonDown);g.on("pressup",this.buttonRelease);if(!s_bMobile)g.on("mouseover",this.buttonOver)};this.buttonRelease=function(){g.scaleX=1;g.scaleY=1;s_oGame.tryShowAd();m?(s_oGame.setCurNum(h),s_oInterface.setAllBlackColor(),y.changeNumColor(!0)):s_oGame.writeNum(h)};this.buttonDown=function(){g.scaleX=.9;g.scaleY=.9};this.buttonOver=function(u){s_bMobile||(u.target.cursor=
"pointer")};this.changeNumColor=function(u){b.color=u?"#ff8814":"#007eff"};this.changeMode=function(){m=!m};this.setCounter=function(u){k=new createjs.Text(u," 30px "+PRIMARY_FONT,"#000000");k.textAlign="center";k.textBaseline="middle";k.x=c;k.y=f;g.addChild(k)};this.clearCounter=function(){g.removeChild(k)};var y=this;this._init(a,e,d)}
function CCreditsPanel(){var a,e,d,c,f,m;this._init=function(){d=new createjs.Container;s_oStage.addChild(d);var h=s_oSpriteLibrary.getSprite("credit_bg");m=createBitmap(h);m.regX=h.width/2;m.regY=h.height/2;a=m.on("click",function(){});d.addChild(m);d.x=CANVAS_WIDTH/2;d.y=CANVAS_HEIGHT/2;h=new createjs.Text("www.codethislab.com","60px "+PRIMARY_FONT,"#ffffff");h.y=200;h.textAlign="center";h.textBaseline="middle";h.lineWidth=600;h.outline=5;var l=new createjs.Text("www.codethislab.com","60px "+PRIMARY_FONT,
"#ffffff");l.y=h.y;l.textAlign="center";l.textBaseline="middle";l.lineWidth=600;d.addChild(l);h=s_oSpriteLibrary.getSprite("ctl_logo");f=createBitmap(h);e=f.on("click",this._onLogoButRelease);f.regX=h.width/2;f.regY=h.height/2;d.addChild(f);h=s_oSpriteLibrary.getSprite("but_exit");c=new CGfxButton(371,-184,h,d);c.addEventListener(ON_MOUSE_UP,this.unload,this)};this.unload=function(){s_oStage.removeChild(void 0);s_oStage.removeChild(d);c.unload();f.off("click",e);m.off("click",a)};this._onLogoButRelease=
function(){window.open("http://www.codethislab.com/index.php?&l=en")};this._init()}function CNumberConverter(){var a;this._init=function(){a=WORD_LIST[Math.floor(Math.random()*WORD_LIST.length)]};this.toText=function(e){return a[e-1].toUpperCase()};s_oNumberConverter=this;this._init()}var s_oNumberConverter;WORD_LIST="symphonic nightmare flowering compliant replicant absolving logarithm abduction judgments lucrative adjusting education pseudonym birthdays biography copyright grandiose advection abruption baritones consulate costumier dragonfly duplicate emigrants frugality graphites growliest duplicate pachyderm marketing harmonize formative dismantle mishandle stumbling lacrimose vehicular formality".split(" ");
CTLText.prototype={constructor:CTLText,__autofit:function(){if(this._bFitText){for(var a=this._iFontSize;(this._oText.getBounds().height>this._iHeight-2*this._iPaddingV||this._oText.getBounds().width>this._iWidth-2*this._iPaddingH)&&!(a--,this._oText.font=a+"px "+this._szFont,this._oText.lineHeight=Math.round(a*this._fLineHeightFactor),this.__updateY(),this.__verticalAlign(),8>a););this._iFontSize=a}},__verticalAlign:function(){if(this._bVerticalAlign){var a=this._oText.getBounds().height;this._oText.y-=
(a-this._iHeight)/2+this._iPaddingV}},__updateY:function(){this._oText.y=this._y+this._iPaddingV;switch(this._oText.textBaseline){case "middle":this._oText.y+=this._oText.lineHeight/2+(this._iFontSize*this._fLineHeightFactor-this._iFontSize)}},__createText:function(a){this._bDebug&&(this._oDebugShape=new createjs.Shape,this._oDebugShape.graphics.beginFill("rgba(255,0,0,0.5)").drawRect(this._x,this._y,this._iWidth,this._iHeight),this._oContainer.addChild(this._oDebugShape));this._oText=new createjs.Text(a,
this._iFontSize+"px "+this._szFont,this._szColor);this._oText.textBaseline="middle";this._oText.lineHeight=Math.round(this._iFontSize*this._fLineHeightFactor);this._oText.textAlign=this._szAlign;this._oText.lineWidth=this._bMultiline?this._iWidth-2*this._iPaddingH:null;switch(this._szAlign){case "center":this._oText.x=this._x+this._iWidth/2;break;case "left":this._oText.x=this._x+this._iPaddingH;break;case "right":this._oText.x=this._x+this._iWidth-this._iPaddingH}this._oContainer.addChild(this._oText);
this.refreshText(a)},setVerticalAlign:function(a){this._bVerticalAlign=a},setOutline:function(a){null!==this._oText&&(this._oText.outline=a)},setShadow:function(a,e,d,c){null!==this._oText&&(this._oText.shadow=new createjs.Shadow(a,e,d,c))},setColor:function(a){this._oText.color=a},setAlpha:function(a){this._oText.alpha=a},removeTweens:function(){createjs.Tween.removeTweens(this._oText)},getText:function(){return this._oText},getY:function(){return this._y},getFontSize:function(){return this._iFontSize},
refreshText:function(a){""===a&&(a=" ");null===this._oText&&this.__createText(a);this._oText.text=a;this._oText.font=this._iFontSize+"px "+this._szFont;this._oText.lineHeight=Math.round(this._iFontSize*this._fLineHeightFactor);this.__autofit();this.__updateY();this.__verticalAlign()}};
function CTLText(a,e,d,c,f,m,h,l,b,g,k,y,u,v,x,n,I){this._oContainer=a;this._x=e;this._y=d;this._iWidth=c;this._iHeight=f;this._bMultiline=n;this._iFontSize=m;this._szAlign=h;this._szColor=l;this._szFont=b;this._iPaddingH=k;this._iPaddingV=y;this._bVerticalAlign=x;this._bFitText=v;this._bDebug=I;this._oDebugShape=null;this._fLineHeightFactor=g;this._oText=null;u&&this.__createText(u)};